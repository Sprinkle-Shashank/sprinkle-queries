
WITH table1 AS (
  
SELECT * FROM profile_81186 AS p1,
  p1.sdg as sdg_unwind,
)

table2 AS ( 
 SELECT table1.fy_timerange, listagg(DISTINCT CAST(sg.name AS varchar),',') AS sdg_unwind
  FROM table1
  
 LEFT JOIN ds_mysql_prod_tagelement AS sg
 ON sg.id = table1.sdg_unwind
  
  GROUP BY 
  table1.fy_timerange)

SELECT *  FROM table2 
