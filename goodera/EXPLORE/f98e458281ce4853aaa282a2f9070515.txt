with temp as(Select 'Emissions' as col
			union all
			select 'Consumption' as col),
x as (select t2.name as projectid, timerange.name as time_timerange, 
'Scope 1' as scope ,'Fuels' as type, 
	  sum(coalesce( datanumbase,0) ) as TotalCO2Quantity,
	sum( TotalCO2Quantity*0.001) as multiplicationfactor
--sum (datanumbase*0.001) as multiplicationfactor

from  sus_9539 

left join ds_mysql_prod_project t1
on t1.id=sus_9539.xprojectid
left join ds_mysql_prod_project t2
on t2.id=t1.parent/*projectid*/

left join ds_mysql_prod_tagelement quarter
on quarter.id=sus_9539.financialPeriod
left join ds_mysql_prod_tagelement half
on half.id=quarter.parent
left join ds_mysql_prod_tagelement fy
on fy.id=half.parent
left join ds_mysql_prod_tagelement timerange
on timerange.id=fy.parent/*time_timerange*/

where KEYWORD IN ('co2_refilled','dry_powder_refilled')
group by t2.name,timerange.name,scope,type)

Select x.projectid,x.time_timerange,x.scope,x.type
, sum(case when temp.col ='Emissions' then x.multiplicationfactor
								         when temp.col = 'Consumption' then x.TotalCO2Quantity
								  end ) as Total,
temp.col as Dim
 from x cross join temp
group by x.projectid,x.time_timerange,x.scope,x.type,
 temp.col
 
		   
		   
		   
