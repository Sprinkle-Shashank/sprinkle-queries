with table1 as
(
  select p.batch, softskills_feedback, cast(name as varchar) as fy, techskills_feedback, health_feedback, state
  
  from profile_30527 as p
  
  left join profile_30532 p1 on
  p.batch = p1._id
  
  ),
  
  table2 as
  (
	select avg(softskills_feedback) as Soft_Skills_Avg, avg(techskills_feedback) as Tech_Skills_Avg, 
	avg(health_feedback) as Health_Avg from table1
	
	
	
	group by fy, state
	)
	
	select state, fy, Soft_Skills_Avg, Tech_Skills_Avg, Health_Avg from table2