with base1 as(
  select p.name, t1.name as fy, p.budget, p.monitoring_plan, m1.name as monitoring_live, p._id, t2.name as fy2, q.budget as budget2, q.monitoring_plan as monitoring_plan2, m2.name as monitoring_live2, decode(p._id,q.project_code,1,0) as renewals
from profile_27396 p
left join profile_27420 q on
p._id=q.project_code
left join ds_mysql_prod_tagelement t1 on
p.fy=t1.id
left join ds_mysql_prod_tagelement t2 on
q.fy=t2.id
left join ds_mysql_prod_tagelement m1 on
p.monitoring_live=m1.id
left join ds_mysql_prod_tagelement m2 on
q.monitoring_live=m2.id
  order by fy2
 )
 
 select * from base1
