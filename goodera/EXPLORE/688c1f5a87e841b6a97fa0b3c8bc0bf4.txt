with t1 as (select xprojectid, finperiod , fy_timerange,keyword,datatablebase from sus_21557 as p  where keyword = 'recruitments')

, t2 as(
 select xprojectid, finperiod , fy_timerange,keyword,cast(co.name_employee_recruit as varchar),
 case when  is_Array(co.title_recruit) = false or get_array_length(co.title_recurit) = 0 then array(co.title_recurit)
 else co.title_recurit 
 end as title_new
 from t1  ,unpivot t.datatablebase as co  at row
 )
 select *,t from t2 ,t2.title_new as t