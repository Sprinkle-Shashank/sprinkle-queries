 select  p3.parent
 from sus_21557 p1
 left join project_6664 p3 on p3.id = p1.xprojectid
 left join project_6664 p4 on p4.id = p3.parent
 where p3.parent is(40856)
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 /*  select t4.name as projectId, 
t5.name as country, p1.fy_timerange,p1.keyword,p1.datatablebase ,t2.keyword
from sus_21557  as p1
left join sus_46830 t2
on p1.xprojectid = t2.xprojectid
left join project_6664 t4 on t4.id = p1.xprojectid
--left join tagElement_6664 t1 on t1.id = t2.dataselect 
left join project_6664 t5 on t5.id = t4.parent
where p1.keyword in ('recruitments', 'recruitments_during_month', 'resignations_during_month', 'staff_begining_month', 'staff_end_month', 'resignations')   and t2.keyword = 'company_category'



*/






















/*with t1 as (select xprojectid, finperiod , fy_timerange,keyword,name,	datatablebase from sus_21557 as p  where keyword = 'recruitments')

, t2 as(
 select xprojectid, finperiod , fy_timerange,keyword,cast(co.name_employee_recruit as varchar),
 case when  is_Array(co.title_recruit) = false or get_array_length(co.title_recurit) = 0 then array(co.title_recurit)
 else co.title_recurit 
 end as title_new
 from t1 as t  ,unpivot t.datatablebase as co  at row
 ), 

  u as (select p.*,t from t2 as p ,p.title_new as t)
 -- , h as(
  select t.xprojectid,t.fy_timerange,t.finperiod, t2.keyword as company_category, t6.name as gender,t5.name as country ,count(t.name_employee_recruit) as total
  from u  as t
  left join sus_46830 t2
  on t.xprojectid = t2.xprojectid
 left join project_6664 t4 on t4.id = t.xprojectid
--left join tagElement_6664 t1 on t1.id = t2.dataselect 
left join project_6664 t5 on t5.id = t4.parent
left join tagElement_6664 t6 on t6.id = t.t
where t2.keyword = 'company_category' 
group by 1,2,3,4,5,6 
  --)
*/


