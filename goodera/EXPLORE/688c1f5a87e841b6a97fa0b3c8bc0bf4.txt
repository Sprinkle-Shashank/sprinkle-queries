with table1 as
(select _id , projectId,country, vendor,unwind_cycle,  consultant_tag from profile_64362 as p ,p.cycle as unwind_cycle)
--,

 /*table2 as
(select _id, projectId,country,vendor,cycle,consultant_tag from profile_64362
  where _id not in (select _id from table1))
  ,
  
table3 as
 (
	select * from table1
  Union all
  select * from table2
 )

*/

,t1 as

(select p1._id, p3.name as projectId, tag3.name as resources, tag4.name as policies, tag5.name as risk, tag6.name as procedure, tag8.name as grievance, tag9.name as training, tag10.name as monitoring,  tag11.name as incident,  tag12.name as communication,  tag13.name as select_factory_msa,  tag14.name as act_adjust,  tag15.name as hs_act,  tag16.name as hs_training,  tag17.name as hs_risk,  tag2.name as country,  p2.vendor, tag1.name as cycle, tag18.name as consultant from profile_62477 as p1

left join table1 as p2
on p1.projectId = p2.projectId
left join ds_mysql_prod_project p3
on p1.projectId= p3.id


left join ds_mysql_prod_tagelement tag1
on p2.unwind_cycle = tag1.id   

left join ds_mysql_prod_tagelement tag2
on p2.country = tag2.id

 
left join ds_mysql_prod_tagelement tag18
on p2.consultant_tag = tag18.id

left join ds_mysql_prod_tagelement tag3
on  p1.resources = tag3.id

left join ds_mysql_prod_tagelement tag4
on  p1.policies = tag4.id

left join ds_mysql_prod_tagelement tag5
on  p1.risk = tag5.id

left join ds_mysql_prod_tagelement tag6
on  p1.procedure = tag6.id

left join ds_mysql_prod_tagelement tag7
on  p1.training = tag7.id


left join ds_mysql_prod_tagelement tag8
on  p1.grievance = tag8.id


left join ds_mysql_prod_tagelement tag9
on  p1.training = tag9.id


left join ds_mysql_prod_tagelement tag10
on  p1.monitoring = tag10.id

left join ds_mysql_prod_tagelement tag11
on  p1.incident = tag11.id   

left join ds_mysql_prod_tagelement tag12
on  p1.communication = tag12.id 

left join ds_mysql_prod_tagelement tag13
on  p1.select_factory_msa = tag13.id

left join ds_mysql_prod_tagelement tag14
on  p1.act_adjust = tag14.id

left join ds_mysql_prod_tagelement tag15
on  p1.hs_act= tag15.id

left join ds_mysql_prod_tagelement tag16
on  p1.hs_training= tag16.id

left join ds_mysql_prod_tagelement tag17
on  p1.hs_risk= tag17.id
 )
 select * from t1
where projectid ='Factory 10'