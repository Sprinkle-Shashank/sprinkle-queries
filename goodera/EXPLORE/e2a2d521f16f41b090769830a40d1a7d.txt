with temp as (
Select 'Male' as col
  union all
Select 'Female' as col),sub1 as(
select t.name as proj_location, t1.name as partner, t2.name as projectId, no_girls, no_boys, school_name, class, fy_timerange
from profile_67673 ss
left join ds_mysql_prod_project t
on ss.projectid=t.id
left join ds_mysql_prod_project t1
on t.parent=t1.id
left join ds_mysql_prod_project t2
on t1.parent=t2.id

),
select t3.name as location, s1.proj_location, s1.partner, s1.projectId, mr.impl_agency as imp_partner, sum(no_girls) as Female, sum(no_boys) as Male, school_name, class, fy_timerange,proj_start_date, proj_end_date, focus_area, project_pillar, project_type
from sub1 s1

left join profile_65603 pd
on s1.proj_location=pd.projectId
left join profile_65552 mr
on mr.projectId=s1.partner

left join ds_mysql_prod_tagelement t3
on t3.id=pd.location
group by proj_location, class, fy_timerange, partner, s1.projectId, location, impl_agency, t3.name,school_name,proj_start_date, proj_end_date, focus_area, project_pillar, project_type

/*with table1 as (select fy_timerange, school_name, t.name as proj_location, t1.name as partner, t2.name as projectId, st.name

from profile_67673


left join ds_mysql_prod_project t
on profile_67673.projectid=t.id
left join ds_mysql_prod_project t1
on t.parent=t1.id
left join ds_mysql_prod_project t2
on t1.parent=t2.id


left join profile_75455
on profile_75455.projectId=profile_67673.projectId

left join ds_mysql_prod_tagelement st
on  profile_75455.state = st.id
)
select table1.partner, proj_start_date, proj_end_date, focus_area, project_pillar, project_type from table1


left join profile_65552
on profile_65552.projectId = table1.partner*/