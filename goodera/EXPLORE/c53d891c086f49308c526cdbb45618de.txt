Select p.projectid, sum(total_workers), extract(year from p2.date_enrollment)as s_year, extract(month from p2.date_enrollment)as month,
case when month = 1 then s_year-1
ELSE s_year END AS year_new
 from profile_17526 p
  
LEFT JOIN profile_16619 p2 ON
p.projectid = p2.projectid
			   
Where year_new is not Null AND total_workers != 0
Group By p.projectid, year_new