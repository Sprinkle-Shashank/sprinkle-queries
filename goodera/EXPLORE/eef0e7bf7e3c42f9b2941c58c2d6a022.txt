--46184, 46299, 46318, 46228, 55677, 55825,prop_id, focus_area || 46187,46304, 46322, 46234, 55688, 55851 amount_released

with base11 as(
	select grantproposalid,grantflowtaskid,value.amount_released from profile_46187 p1, unpivot p1.disbursement_plan as value at disbursement_plan
),
base21 as(
	select grantproposalid,grantflowtaskid,value.amount_released from profile_46304 p1, unpivot p1.disbursement_plan as value at disbursement_plan
),
base31 as(
	select grantproposalid,grantflowtaskid,value.amount_released from profile_46322 p1, unpivot p1.disbursement_plan as value at disbursement_plan
),
base41 as(
	select grantproposalid,grantflowtaskid,value.amount_released from profile_46234 p1, unpivot p1.disbursement_plan as value at disbursement_plan
),
base51 as(
	select grantproposalid,grantflowtaskid,value.amount_released from profile_55688 p1, unpivot p1.disbursement_plan as value at disbursement_plan
),
base61 as(
	select grantproposalid,grantflowtaskid,value.amount_released from profile_55851 p1, unpivot p1.disbursement_plan as value at disbursement_plan
),
base as(
select t.prop_id,t.focus_area,p1.amount_released from profile_46184 as t
left join base11 as p1
on t.grantproposalid = p1.grantproposalid
union all
select t.prop_id,t.focus_area,p1.amount_released from profile_46299 as t
left join base21 as p1
on t.grantproposalid = p1.grantproposalid
union all
select t.prop_id,t.focus_area,p1.amount_released from profile_46318 as t
left join base31 as p1
on t.grantproposalid = p1.grantproposalid
union all
select t.prop_id,t.focus_area,p1.amount_released from profile_46228 as t
left join base41 as p1
on t.grantproposalid = p1.grantproposalid
union all
select t.prop_id,t.focus_area,p1.amount_released from profile_55677 as t
left join base51 as p1
on t.grantproposalid = p1.grantproposalid
union all
select t.prop_id,t.focus_area,p1.amount_released from profile_55825 as t
left join base61 as p1
on t.grantproposalid = p1.grantproposalid
)
select * from base
--select count(prop_id) as prop_id_count,cast(amount_released as FLOAT8) as amount_released from base1 group by 2;