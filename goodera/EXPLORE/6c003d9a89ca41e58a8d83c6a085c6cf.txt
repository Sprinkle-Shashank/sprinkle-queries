WITH SUB1 AS (
  SELECT DH.upload,
  DH.fy_timerange AS fy_timerange1,
P1.name AS projectname1,
DT.name AS doc_type,

CASE
	WHEN DH.upload IS NOT NULL
	THEN 'Download'
	ELSE '-'
	END AS due_diligence_label

FROM profile_55868 AS DH

LEFT JOIN ds_mysql_prod_tagelement AS DT
ON DH.doc_type = DT.id
	
LEFT JOIN ds_mysql_prod_project AS P1
ON DH.projectId = P1.id

WHERE DT.name = 'Due Diligence'
  ),
  
SUB2 AS (
	SELECT LC.trust_deed, LC.registration, LC.pan, LC.address_proof, LC.tweleve_a, LC.eighty_g, LC.thirty_five_a_c, LC.csr1, LC.renewed_tweleve_a, LC.renewed_eighty_g, LC.fcra, LC.annual_report, LC.itr, LC.audited_financials, LC.ten_b, LC.self_declaration, LC.bank_account, LC.ifsc,
  LC.fy_timerange AS fy_timerange2,

CASE 
	WHEN LC.trust_deed IS NOT NULL
	THEN 'Download'
	ELSE '-'
	END AS trust_deed_label,
	
CASE
	WHEN LC.registration IS NOT NULL
	THEN 'Download'
	ELSE '-'
	END AS registration_label,
	
CASE
	WHEN LC.pan IS NOT NULL
	THEN 'Download'
	ELSE '-'
	END AS pan_label,

CASE
	WHEN LC.address_proof IS NOT NULL
	THEN 'Download'
	ELSE '-'
	END AS address_proof_label,

CASE
	WHEN LC.tweleve_a IS NOT NULL
	THEN 'Download'
	ELSE '-'
	END AS tweleve_a_label,

CASE
	WHEN LC.eighty_g IS NOT NULL
	THEN 'Download'
	ELSE '-'
	END AS eighty_g_label,

CASE
	WHEN LC.thirty_five_a_c IS NOT NULL
	THEN 'Download'
	ELSE '-'
	END AS thirty_five_a_c_label,

CASE
	WHEN LC.csr1 IS NOT NULL
	THEN 'Download'
	ELSE '-'
	END AS csr1_label,

CASE
	WHEN LC.renewed_tweleve_a IS NOT NULL
	THEN 'Download'
	ELSE '-'
	END AS renewed_tweleve_a_label,

CASE
	WHEN LC.renewed_eighty_g IS NOT NULL
	THEN 'Download'
	ELSE '-'
	END AS renewed_eighty_g_label,
	
CASE
	WHEN LC.fcra IS NOT NULL
	THEN 'Download'
	ELSE '-'
	END AS fcra_label,
	
CASE
	WHEN LC.annual_report IS NOT NULL
	THEN 'Download'
	ELSE '-'
	END AS annual_report_label,

CASE
	WHEN LC.itr IS NOT NULL
	THEN 'Download'
	ELSE '-'
	END AS itr_label,

CASE
	WHEN LC.audited_financials IS NOT NULL
	THEN 'Download'
	ELSE '-'
	END AS audited_financials_label,

CASE
	WHEN LC.ten_b IS NOT NULL
	THEN 'Download'
	ELSE '-'
	END AS ten_b_label,

CASE
	WHEN LC.self_declaration IS NOT NULL
	THEN 'Download'
	ELSE '-'
	END AS self_declaration_label,

AT.name AS account_type,
P2.name AS projectname2

FROM profile_81441 AS LC

LEFT JOIN ds_mysql_prod_tagelement AS AT
ON LC.account_type = AT.id
	
LEFT JOIN ds_mysql_prod_project AS P2
ON LC.projectId = P2.id
)








/*
SELECT * FROM SUB1
UNION
SELECT * FROM SUB2
*/


















SELECT S1.*
FROM SUB1 AS S1
