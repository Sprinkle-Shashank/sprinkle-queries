with lookup as (select task.approvallog, task.data.subcat_output, task.status, split_part(split_part(prod.name,'|',1),'.',1) as ProjectCode,f.name as fy_timerange,m.name as Month,concat(ProjectCode,fy_timerange) as CODE,split_part(prod.name,'|',3) as census from profile_54963 p
left join ds_mongo_prod_taskresponse task on
task.profileinstanceid=p._id
left join ds_mysql_prod_project prod on
prod.id=p.projectid
left join ds_mysql_prod_tagelement f on
p.fy=f.id
left join ds_mysql_prod_tagelement m on
p.month=m.id)
select p.approvallog,p.subcat_output,p.status,p.ProjectCode,p.fy_timerange,p.Month,p.CODE from lookup p where (p.status='SUBMITTED' or p.status='PENDING_APPROVAL')