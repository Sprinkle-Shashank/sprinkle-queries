select p.pname, p_30171._id, p_30171.fy, p_30171.projectid, p_27396.recordId, p_27396.project_manager27396, p_27396.fy27396, p_27396.project_duration, p_27396.ngo_partner, p_27396.focus_area, p_27396.intervention_type, p_27420.project_manager27420, p_27420.fy27420
from profile_30171 p_30171
join (select cast(y.id as varchar) as id, cast(SPLIT_PART(y.name, '|', 1) as varchar) as pname from ds_mysql_project y) p on p_30171.projectid=p.id

join (select cast(y._id as varchar) as recordId, y.project_manager as project_manager27396, y.fy as fy27396, y.ngo_partner, y.focus_area, y.project_duration, y.intervention_type, y.name
from profile_27396 y) p_27396 on p.pname = p_27396.name

join (select cast(y.project_code as varchar) as project_code, y.project_manager as project_manager27420, y.fy as fy27420 from profile_27420 y) p_27420 on p_27396.recordid = p_27420.project_code

where p_27396.focus_area = '430784'