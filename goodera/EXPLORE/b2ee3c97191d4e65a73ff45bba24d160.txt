with sub1 as(
  select p1._id as id, p1.sacid, p2.cdms_id, p3.source_div, row_number() over(partition by p1._id, p1.sacid, p2.cdms_id order by cast(p3.timeperiod_timerange.start as date) desc) as line
from profile_74133 p1
left join profile_74334 p2 on p2.higg_id = p1.sacid
left join profile_60928 p3 on p3.factory_id = p2.cdms_id
where p2.cdms_id is not null)

select * from sub1 where line = 1