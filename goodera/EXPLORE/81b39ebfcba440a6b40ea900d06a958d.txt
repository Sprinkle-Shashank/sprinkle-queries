--GSK_Consumer_Number_sites
with table1 as
(
  select p.* , dis.name as district_update , sta.name as state_update , camp.name as camp_name  from profile_82796 as p
   
left join ds_mysql_prod_tagelement dis
on p.state_dist = dis.id

left join ds_mysql_prod_tagelement sta
on dis.parent = sta.id
  
  left join ds_mysql_prod_tagelement camp
  on p.type_camp = camp.id 
  ),
  
  table2 as
  ( select p.projectid , p._id , fy_timerange , district_update , state_update , camp_name from table1 as p
   ),
   
   table3 as 
   ( select distinct p._id from table2 as p)
  
  select * from table3