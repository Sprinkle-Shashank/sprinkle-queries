
with temp as (
  select 'sq.cash_grant' as col 
  union all
  select 'sq.product_cogs'as col
  union all
  select 'sq.product_fmv' as col
  union all
  select 'pd.cash_disbursed' as col
  union all
  select 'pd.products_disbursed_cogs' as col
  union all
  select 'pd.products_disbursedfmv' as col
	
) 
SELECT  sq.projectId, sq.time_period_timerange AS fy_timerange, sq.year, sq.month, sq.partner_name, sq.pillar, sq.initiative, sq.spend_category, sq.program_type, sq.description, sq.fy AS FY, pd.notes, (sq.year+2) AS fy_cal, cit.name AS fy_str,t.name as year, t2.name as month,
case
	when sq.month=1059437 then 'Q4'
	when sq.month=1059438 then 'Q4'
	when sq.month=1059439 then 'Q4'
	when sq.month=1059440 then 'Q1'
	when sq.month=1059441 then 'Q1'
	when sq.month=1059442 then 'Q1'
	when sq.month=1059443 then 'Q2'
	when sq.month=1059444 then 'Q2'
	when sq.month=1059445 then 'Q2'
	when sq.month=1059446 then 'Q3'
	when sq.month=1059447 then 'Q3'
	when sq.month=1059448 then 'Q3'
	end as Quarter,
case
	when sq.month=1059437 then 'Q4'
	when sq.month=1059438 then 'Q1'
	when sq.month=1059439 then 'Q1'
	when sq.month=1059440 then 'Q1'
	when sq.month=1059441 then 'Q2'
	when sq.month=1059442 then 'Q2'
	when sq.month=1059443 then 'Q3'
	when sq.month=1059444 then 'Q3'
	when sq.month=1059445 then 'Q3'
	when sq.month=1059446 then 'Q3'
	when sq.month=1059447 then 'Q4'
	when sq.month=1059448 then 'Q4'
	end as Quarter_Dell_Fiscal,
	temp.col as Dimensions,
sum(case col
  when 'sq.cash_grant' then sq.cash_grant
  when 'sq.product_cogs'then sq.product_cogs
  when 'sq.product_fmv' then sq.product_fmv
  when 'pd.cash_disbursed' then pd.cash_disbursed
   when 'pd.products_disbursed_cogs' then pd.products_disbursed_cogs
  when 'pd.products_disbursedfmv' then pd.products_disbursedfmv
	else Null 
	end
	) as Values
FROM Dell_Profile_63522 sq
cross join temp
LEFT JOIN Dell_profile_063523 pd
ON sq._id=pd.partner_reference
left join ds_mysql_prod_tagelement cit
on sq.year+2 = cit.id
eft join ds_mysql_prod_tagelement as t 
  on sq.month = t.id
   left join ds_mysql_prod_tagelement as t2 
  on sq.year = t2.id
group by  fy_timerange, t.name , t2.name, sq.partner_name, sq.pillar, sq.initiative, sq.spend_category, sq.program_type, sq.description, FY, pd.notes, fy_cal, fy_str, Quarter,sq.projectId,Dimensions,Quarter_Dell_Fiscal

  
