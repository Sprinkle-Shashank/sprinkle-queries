with table1 as(
 Select _id,projectid , fy_timerange , to_char(date_entry,'DD-MM-YYYY') as date_entry , location_machine , supervisor_name , job_done , meter_reading , reading_meter , operational_status ,
 non_operation_reason , running_wayu_machines , machine_not_working , count_not_working ,
  reason_not_working , running_hrs_machine,conculding_remarks from profile_82027 
  ),
  table2 as ( Select t1.* , CAST(job as varchar) as job , CAST(machine as varchar) as machine from table1 t1 , coalesce(t1.job_done,array(0)) as job ,  coalesce(t1.machine_not_working,array(0))as machine ),
  table3 as ( Select _id,projectid ,fy_timerange ,date_entry,location_machine , supervisor_name , meter_reading , reading_meter , operational_status , non_operation_reason, running_wayu_machines ,reason_not_working ,  conculding_remarks ,
	LISTAGG(job,',') as job_done , 	LISTAGG(machine,',') as machine_work	 
			 
			 
			 
			 from table2 
			 
			 GROUP BY _id,projectid ,fy_timerange ,date_entry,location_machine , supervisor_name , meter_reading , reading_meter , operational_status , non_operation_reason, running_wayu_machines ,reason_not_working ,  conculding_remarks )
			 
			 Select * from table3
	
  
  
 