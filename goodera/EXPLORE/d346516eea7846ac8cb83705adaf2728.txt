with Base1 as(select split_part(prod.name,'|',1) as ProjectCode,split_part(prod.name,'|',2) as Region,p.fy,p.select_quarter,case when p.file_upload is null then 'No' else 'Yes'end as Report_submission_status from profile_60787 p 
left join ds_mysql_prod_project prod on
prod.id=p.projectid)
select f.name as fy_timerange,q.name as Quarter,ProjectCode,Region,Report_submission_status from Base2
left join ds_mysql_prod_tagelement f on
fy=f.id
left join ds_mysql_prod_tagelement q on
select_quarter=q.id