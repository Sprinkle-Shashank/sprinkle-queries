with sub1 as(select p.*,unwind_schedule_vii,unwind_sdg, unwind_focus_area from profile_81311 p ,p.schedule_vii as unwind_schedule_vii,
  p.sdg as unwind_sdg, p.focus_area as unwind_focus_area)

select a.project_name,t1.name as district,t2.name as state,a.fy_timerange,to_char(a.start_date,'DD-MM-YYYY') as start_date,to_char(a.end_date,'DD-MM-YYYY') as end_date,a.duration,a.project_desc,t4.name as schedule_vii,t5.name as sdg,t3.name as focus_area,a.project_pic,
listagg(t4.name, ', ') as schedule_vii,
listagg(t5.name, ', ') as sdg,
listagg(t3.name, ', ') as focus_area
from sub1 a


left join ds_mysql_prod_tagelement t1 on t1.id=a.state
left join ds_mysql_prod_tagelement t2 on t2.id=t1.parent
left join ds_mysql_prod_tagelement t3 on t3.id=a.unwind_focus_area
left join ds_mysql_prod_tagelement t4 on t4.id=a.unwind_schedule_vii
left join profile_81318 t5 on t5._id=a.unwind_sdg

group by a.fy_timerange,a.project_name,a.project_pic,t1.name,t2.name,a.start_date,a.end_date,a.project_desc,a.duration,t3.name,t4.name,t5.name