select ProjectCode, m.name as Project_Manager,focusarea,fy_timerange,Total_Beneficiaries  from
(select split_part(ProjectCode,'.',1) as ProjectCode, focusarea,fy_timerange,Total_Beneficiaries  from 
(select  split_part(prod.name,'|',1) as ProjectCode,t.name as fy_timerange, p.focus_area as focusarea,p.bennum as Total_Beneficiaries 
 from profile_59426 p 
left join ds_mysql_prod_project prod on
prod.id=p.projectid
left join ds_mysql_prod_tagelement t on
p.fy=t.id) )
left join profile_27396 n on
ProjectCode=n.name
left join ds_mysql_prod_tagelement m on
n.project_manager=m.id
group by
 ProjectCode,m.name,focusarea,fy_timerange,Total_Beneficiaries
