with table1 as
(select m._id, projectId.name as projectId, m.head, SUM(m.amount) as Amount, m.fy_timerange, r.category
from profile_76975 as m

left join ds_mysql_prod_project as projectId
  on m.projectId = projectId.id 

/*left join ds_mysql_prod_project as head
  on m.head = head.id*/
  
left join profile_76973 AS r 
 on m.head = r._id
 
group by m._id, projectId.name, m.head, m.fy_timerange, category),

table2 as
(select projectId, head.name as head, Amount, fy_timerange, category from table1 as m
 left join ds_mysql_prod_tagelement as head
  on m.head = head.id )
  
select * from table2
 
 