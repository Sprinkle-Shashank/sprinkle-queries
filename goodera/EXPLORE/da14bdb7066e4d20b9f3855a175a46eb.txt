with table1 as(select projectid,fy_timerange,child_enrolled_irregular as "enrolled but irregular",
child_never_enrolled as "never enrolled",child_drop_out as dropout ,total_special_child,enrolled_diploma as diploma, enrolled_graduation as graduation ,
enrolled_personality_development as "perdonality development" ,enrolled_entrepreneurial_course as "entrepreneurial course",enrolled_computer_course as "computer course" ,enrolled_english_spoken as "english spoken", enrolled_motor_driving as "motor driving" ,total_driving_license,total_id_documents from profile_78767),

/*pivot*/
temp as (
  select 'enrolled but irregular' as C
  Union all
  select 'never enrolled' as C
  Union all 
  select 'dropout ' as C
  Union all 
  select 'total_special_child' as C
  Union all
  select 'diploma' as C
  Union all
  select 'graduation' as C
  Union all
  select 'perdonality development' as C
  Union all
  select 'entrepreneurial course' as C
  Union all
  select 'computer course' as C
  Union all
  select 'english spoken' as C
  Union all
  select 'motor driving' as C
  Union all
  select 'total_driving_license' as C
  Union all
  select 'total_id_documents' as C
	)


select pro.name as projectid ,fy_timerange, 

Sum(Case C
	When 'enrolled but irregular' then tab1."enrolled but irregular"
	when 'never enrolled' then tab1."never enrolled"
	When 'dropout' then tab1.dropout
	When 'total_special_child' then tab1.total_special_child
	When 'diploma' then tab1.diploma
	When 'graduation' then tab1.graduation
	When 'perdonality development' then tab1."perdonality development"
	When 'entrepreneurial course' then tab1."entrepreneurial course"
	When 'computer course' then tab1."computer course"
	When 'english spoken' then tab1."english spoken"
	When 'motor driving' then tab1."motor driving"
	When 'total_driving_license' then tab1.total_driving_license
	When 'total_id_documents' then tab1.total_id_documents
	Else Null
	
END) as values , temp.C as dimensions
from table1 as tab1

cross join temp

 left join ds_mysql_prod_project as pro
  on tab1.projectid = pro.id

  
  group by tab1.projectid, tab1.fy_timerange,temp.c,pro.name
