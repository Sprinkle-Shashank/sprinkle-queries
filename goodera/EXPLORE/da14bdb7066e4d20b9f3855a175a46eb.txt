with table1 as(select projectid,fy_timerange,child_enrolled_irregular as enrolled_but_irregular,
child_never_enrolled as never_enrolled,child_drop_out as dropout ,total_special_child,enrolled_diploma as diploma, enrolled_graduation as graduation ,
enrolled_personality_development as perdonality_development ,enrolled_entrepreneurial_course as entrepreneurial_course,enrolled_computer_course as computer_course ,enrolled_english_spoken as english_spoken, enrolled_motor_driving as motor_driving ,total_driving_license,total_id_documents from profile_78767)

/*pivot*/
temp as (
  select 'enrolled_but_irregular' as C
  Union all
  select 'never_enrolled' as C
  Union all 
  select 'dropout ' as C
  Union all 
  select 'total_special_child' as C
  Union all
  select 'diploma' as C
  Union all
  select 'graduation' as C
  Union all
  select 'perdonality_development' as C
  Union all
  select 'entrepreneurial_course' as C
  Union all
  select 'computer_course' as C
  Union all
  select 'english_spoken' as C
  Union all
  select 'motor_driving' as C
  Union all
  select 'total_driving_license' as C
  Union all
  select 'total_id_documents' as C
	)


select pro.name as projectid ,fy_timerange, 

Sum(Case C
	When 'enrolled_but_irregular' then tab1.enrolled_but_irregular
	when 'never_enrolled' then tab1.never_enrolled
	When 'dropout' then tab1.dropout
	When 'total_special_child' then tab1.total_special_child
	When 'diploma' then tab1.diploma
	When 'graduation' then tab1.graduation
	When 'perdonality_development' then tab1.perdonality_development
	When 'entrepreneurial_course' then tab1.entrepreneurial_course
	When 'computer_course' then tab1.computer_course
	When 'english_spoken' then tab1.english_spoken
	When 'motor_driving' then tab1.motor_driving
	When 'total_driving_license' then tab1.total_driving_license
	When 'total_id_documents' then tab1.total_id_documents
	Else Null
	
END) as values , temp.C as dimensions
from table1 as tab1

cross join temp

 left join ds_mysql_prod_project as pro
  on tab1.projectid = pro.id

  
  group by tab1.projectid, tab1.fy_timerange,temp.c,pro.name
