Select p.projectId,mat.name as material,mat_parent.name as material_description,
CAST(time_period_timerange.start as date) as time_period,
Substring(time_period,1,4) as year_axis,
ship.name as ship_city,ship_parent1.name as region,ship_parent2.name as region_global, ship_parent3.name as region_global2,therap.name as therap,therap_parent.name as therap_cat,
sold.name as sold_ship_to,sold_parent1.name as partner1,sold_parent2.name as partner_organization, 
org.name as sales,org_parent.name as sales_org,
p.shlf_life_buckt,p.shelf_life,p.doses_delivered,sum(total_cost) as donation_value from profile_56340 p


Left join ds_mysql_prod_tagelement mat
on p.material_descr = mat.id

left join ds_mysql_prod_tagelement mat_parent
on mat.parent = mat_parent.id

Left join ds_mysql_prod_tagelement ship
on p.ship_city = ship.id

Left join ds_mysql_prod_tagelement ship_parent1
on ship.parent = ship_parent1.id

Left join ds_mysql_prod_tagelement ship_parent2
on ship_parent1.parent = ship_parent2.id

Left join ds_mysql_prod_tagelement ship_parent3
on ship_parent2.parent = ship_parent3.id

Left join ds_mysql_prod_tagelement therap
on p.therap_cat = therap.id

left join ds_mysql_prod_tagelement therap_parent
on therap.parent = therap_parent.id

Left join ds_mysql_prod_tagelement sold
on p.sold_ship_to = sold.id

Left join ds_mysql_prod_tagelement sold_parent1
on sold.parent = sold_parent1.id

Left join ds_mysql_prod_tagelement sold_parent2
on sold_parent1.parent = sold_parent2.id

Left join ds_mysql_prod_tagelement org
on p.sales_org = org.id

left join ds_mysql_prod_tagelement org_parent
on org.parent = org_parent.id

group by p.projectId,mat.name,mat_parent.name,
time_period_timerange.start,ship.name,ship_parent1.name,ship_parent2.name, therap.name,therap_parent.name,sold.name,sold_parent1.name,sold_parent2.name,
org.name,org_parent.name,p.shlf_life_buckt,p.shelf_life,p.doses_delivered,ship_parent3.name
