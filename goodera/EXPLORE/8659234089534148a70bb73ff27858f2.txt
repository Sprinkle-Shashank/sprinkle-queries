select p1._id, tag3.name as projectId, tag1.name as sub1, tag2.name as sub2, p1.fy_2_timerange, p1.sub1_marks, p1.sub2_marks, p1.sub1_total, p1.sub2_total, tag4.name as kali_class,

case p1.sub1
when sub1 = 481717 then sub1_marks
else 0
end as sub1_maths,

case p1.sub2
when sub2 = 481717 then sub2_marks
else 0
end as sub2_maths

from profile_31103 p1
left join profile_31099 p2
on p1.kali_id = p2._id 
left join ds_mysql_prod_tagelement tag1
on p1.sub1 = tag1.id
left join ds_mysql_prod_tagelement tag2
on p1.sub2 = tag2.id
left join ds_mysql_prod_project tag3
on p1.projectId = tag3.id
left join ds_mysql_prod_project tag4
on p2.kali_class = tag4.id





