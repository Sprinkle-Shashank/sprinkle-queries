with x as (
   SELECT grantproposalid,CAST(data.outc_indir_quan as super) as dir, data.outc_indir_quan
 from ds_mongo_profileinstance where profileId='55753' and active = 't' and securitycontextid is not null)

create or replace function json_keys (j varchar(max))
returns varchar(max)
stable as $$
    import json
    arr = json.loads(j)
    return '' if not arr else   ','.join(arr.keys())
$$ language plpythonu;

select json_keys(select json_extract_path_text(JSON_SERIALIZE(dir),'0') as temp, dir from x;)
/*--select grantproposalid,dir,dir."0".indicator as ind1,dir."1".indicator as ind2 from x
 
--select json_extract_path_text(JSON_SERIALIZE(dir),'0') as temp, dir from x;
select * from x where json_extract_path_text(JSON_SERIALIZE(dir),'0', 's_no') = 1;


-- select json_extract_path_text(dir,'0') from x;

--select dir->"$.0" from x*/
