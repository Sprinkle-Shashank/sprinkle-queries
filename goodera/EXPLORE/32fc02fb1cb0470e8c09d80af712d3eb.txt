Select sq.fy_timerange, sq.number_enrolled_batch, mr.region, sq.module_name
FROM profile_62486 sq
LEFT JOIN profile_62948 pd
ON pd.project_id=sq.project_id
LEFT JOIN profile_60928 mr
ON pd.pvh_id=mr.factory_id
WHERE pd.pvh_id IS NOT NULL AND sq.fy_timerange IS NOT NULL AND extract(year from(cast(fy_timerange.start as datetime)))>=2020
GROUP BY sq.module_name, sq.fy_timerange, sq.number_enrolled_batch, pd.pvh_id,mr.region,mr.timeperiod_timerange
ORDER BY mr.timeperiod_timerange DESC