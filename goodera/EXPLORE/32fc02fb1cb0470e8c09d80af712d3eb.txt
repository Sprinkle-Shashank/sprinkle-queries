Select sq.fy_timerange, sq.number_enrolled_batch, mr.region, sq.program_type, sq.module_name
LEFT JOIN profile_62948 pd
ON pd.project_id=sq.project_id
LEFT JOIN profile_60928 mr
ON mr.factory_id=pd.pvh_id
WHERE pd.pvh_id IS NOT NULL AND sq.fy_timerange IS NOT NULL AND extract(year from(cast(fy_timerange.start as datetime)))>=2020
FROM profile_62486 sq
GROUP BY sq.module_name, sq.fy_timerange, sq.number_enrolled_batch, pd.pvh_id,sq.product_type
ORDER BY mr.timeperiod_timerange DESC