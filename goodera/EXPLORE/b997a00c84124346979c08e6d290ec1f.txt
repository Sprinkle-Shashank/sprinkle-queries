with table1 as 
(
select p.projectid, p.facility_status , facility.name as facility_status_update , case when facility_status_update='Active' then 'Active' else 'Deactive' end as Active_Filter , goodera_facility_name_text , primary_category from profile_68161 as p
  
left join ds_mysql_prod_tagelement facility 
on p.facility_status = facility.id
), 

table2 as 
( select p.projectid , p._id , fac.name as factory , cou.name as country , ven.name as vendor ,  p2.fac_cl_vpid, p2.vendor_ngo_id, pri.name as primary_category , t1.active_filter , trai.name as training_type_update, date from profile_61572 as p
 
 
left join ds_mysql_prod_project fac
on  p.projectid = fac.id

left join ds_mysql_prod_project ven
on  fac.parent = ven.id

left join ds_mysql_prod_project cou
on  ven.parent = cou.id 
 
 left join profile_52810 p2 on
 p.projectid = p2.projectid
 
left join table1 t1 on 
fac.name = t1.goodera_facility_name_text
 
left join ds_mysql_prod_tagelement pri
on  p2.primary_category = pri.id  
 
left join ds_mysql_prod_tagelement trai
on  p.training_type = trai.id 
 )
 
 select * from table2