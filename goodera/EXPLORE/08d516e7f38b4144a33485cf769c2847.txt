with phase1 AS (
	select proj.name as projectId, SUBSTRING(cast(p.joindate as varchar),1,10)||'T00:00:00.000Z' as joindate,p.dropdate, p.member,current_date||'T00:00:00.000Z' as end from profile_58858 p
  	left join ds_mysql_prod_project proj
  	on p.projectid = proj.id
),
phase2 as (
	select DECODE(cast(x1.dropdate as varchar),'',cast(x1.end as varchar),cast(x1.dropdate as varchar)) as end_date from phase1 x1
)
select * from phase2