with x as (select name as projectid, fy_timerange, financialperiod from sus_56551 where keyword='cdp_cc_8_consumed'),
temp as (

select * , temp1.cdp_cc_8_1_heat, temp1.cdp_cc_8_1_steam, temp1.cdp_cc_8_1_cooling,temp1.cdp_cc_8_1_electricity from x as temp, unpivot temp.datatablebase as temp1 at row) /*,

/*temp3 as (select 'cc8_Steam' as col union all  select 'cc8_Heat' as col union all select 'cc8_Cooling' as col union all select  'cdp_cc_8_1_electricity' as col )*/

select name as projectid, fy_timerange, financialperiod ,

sum (case temp3.col
 when 'cc8_Heat' then  temp2.cdp_cc_8_1_heat 
when  'cc8_Steam' then temp2.cdp_cc_8_1_steam 
when 'cc8_Cooling' then  temp2.cdp_cc_8_1_cooling 
when 'cdp_cc_8_1_electricity' then  temp2.cdp_cc_8_1_electricity
	 else null
	 end) as values
from temp2 
left join ds_mysql_prod_tagelement t1 on t1.id = financialperiod
	 cross join temp3
group by projectid, fy_timerange, financialperiod
/*select * from sus_56551 where keyword ='cdp_cc_8_consumed'*/*/
