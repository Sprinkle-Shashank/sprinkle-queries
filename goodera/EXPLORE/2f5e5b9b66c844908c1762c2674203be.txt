
with temp as (
select 'solution_app' as col
  union all
  Select 'solution_platform' as col
  union all
  select 'sector' as col
  union all
  select 'sdg' as col
  union all
  select 'business_unit' as col
)
,
q2 as(
Select
  projectId,
  members,
 fy_timerange ,
  t4.name as sector,
  t3.name as sdg ,
  t.name as solution_app ,
  t2.name as solution_platform ,
 tar_bene ,
 ach_bene ,t5.name as business_unit,
 sum(case col
  
  when 'solution_app' then t.name
  when 'solution_platform' then t2.name
  when 'sdg' then t3.name
  when 'sector' then t4.name
when 'business_unit' then t5.name
  else null
  end) as Values,temp.col as dimensions

 from profile_76974 
 cross join temp
  left join ds_mysql_prod_tagelement t
 on q2.solution_app=t.id
 left join ds_mysql_prod_tagelement t2
 on q2.solution_platform=t2.id
 left join ds_mysql_prod_tagelement t3
 on q2.sdg=t3.id
 left join ds_mysql_prod_tagelement t4
 on q2.sectorr=t4.id
  left join ds_mysql_prod_tagelement t5
 on q2.business_unit=t5.id
  GROUP BY 
  projectId
  members,
 fy_timerange ,
  sector,
  sdg ,
  solution_app ,
  solution_platform ,
 tar_bene ,
 ach_bene ,business_unit,dimensions,t.name,t2.name,t3.name,t4.name
  ),
q4 as (
  SELECT members,fy_timerange ,sector,sdg ,solution_app ,solution_platform ,picture,tar_bene ,ach_bene ,business_unit,dimensions,Values FROM q2
  ),
  q3 as (
	select qq.* ,sectorr from q4 qq,
	qq.sector sectorr
  )
	
select  q3.projectID,q3.sectorr ,q3.members,
 q3.sdg ,
 q3.solution_app ,
 q3.solution_platform ,q3.tar_bene,q3.ach_bene,
 q3.dimensions,q3.fy_timerange,sum(values) from q3
	
 
 group by  
  q3.fy_timerange,
 q3.dimensions,q3.projectID,q3.sectorr ,q3.members,
 q3.sdg ,
 q3.solution_app ,
 q3.solution_platform ,q3.tar_bene,q3.ach_bene
 