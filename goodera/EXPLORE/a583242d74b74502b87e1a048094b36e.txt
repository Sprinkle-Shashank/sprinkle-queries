with t1 as
( 
  select gender, acad_qual, batch, p.state, sta.name as state_update, training_completed_yn, placement_yn, annual_hh_income, ind_income_post_tr, company_rating, employer_name, cast(p.name as VARCHAR) as name_update,
  
  CASE when placement_yn = 476506
  then 1 else 0
  end as placed
  
  from profile_30527 as p
  
  left join ds_mysql_prod_tagelement sta
  on p.state = sta.id
  ),
  
  t2 as
  (
	select  name_update, employer_name, state_update, count(*) as count_up from t1
	
	where employer_name<>''
	group by name_update, employer_name, state_update
	)
	select name_update, employer_name, state_update from t2