with table1 as
( select p.projectid , p._id , p.name , p.fy_timerange , num_ben ,  INITCAP(ent.name) as entity , p.location  from profile_80981 as p

left join ds_mysql_prod_tagelement ent 
on p.entity = ent.id),


table2 as
( select p.projectid , p._id  , p.fy_timerange , num_ben ,  entity , d1 from table1 as p, p.location as d1),


table3 as
(
select p.projectid , p._id  , p.fy_timerange , num_ben , entity from table2 as p
  
left join ds_mysql_prod_tagelement location_unwind 
on p.location = location_unwind.id
 )
  
select * from table3


/*


table2 as
( select p.projectid , p._id , p.name , p.fy_timerange , num_ben , entity , d1 from table1 as p
 )

 CAST(data.name as VARCHAR),
 CAST(data.fy_timerange as SUPER),
 CAST(data.location as SUPER),
 CAST(data.num_ben as INT),
 CAST(data.entity as INT)
 
 */