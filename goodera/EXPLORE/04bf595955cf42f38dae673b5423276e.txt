with table1 as 
(
   select p.projectid , p._id , p.name , name_country , name_vendor , name_vendor_filter , name_rp , name_vendor_filter as Partner_name , substring(Partner_name ,0,2) as First_Value, case when First_Value='V' then 'Vendor Partner' else 'Community Partner' end as Partner_type from profile_54646 p ), 
   
 table2 as 
 (
   select p.projectid , p._id , sourcing_yn , vpid_1 , vpid_2 , child_vpid_autocal ,name_country , name_vendor , name_vendor_filter , name_rp , name_vendor_filter as Partner_name ,  Partner_type from profile_52162 p
   
   left join table1 t1 on
   p.projectid = t1.name_vendor
   )
   
   
select * from table2