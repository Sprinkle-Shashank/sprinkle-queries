with table1 as 
(
   select p.projectid , p._id , p.name , name_country , name_vendor , name_vendor_filter , name_rp , name_vendor_filter as Partner_name , substring(Partner_name ,0,2) as First_Value, case when First_Value='V' then 'Vendor Partner' else 'Community Partner' end as Partner_type , p2.sourcing_yn from profile_54646 p
  
left join profile_52162 p2 on
   p.name_vendor = p2.projectid
), 
   
 table2 as 
 (
   select p.projectid , p._id , sourcing_yn , vpid_1 , vpid_2 , child_vpid_autocal , p2.name from profile_52162 p
   
   left join profile_54646 p2 on
   p.vendor = p2.name_vendor
   )
   
   
select * from table2

/*


t1.name_country , t1.name_vendor , t1.name_vendor_filter , t1.name_rp , t1.Partner_name ,  t1.Partner_type 

*/