with t1 as
(select p1.fy_timerange, sum(no_teachers_trained)as no_teachers_trained,count(p1._id) as session_count,p1.duration_training as start_date,
case 
when p1.duration_training < 4 then 'Q4'
when p1.duration_training < 7 then 'Q1'
when p1.duration_training < 10 then 'Q2'
else 'Q3'
end as quater 
from profile_76013 p1
group by p1.fy_timerange,p1._id,p1.date_training, p1.no_teachers_trained,p1.duration_training
),

t2 as 
(select duration_training, start_date :: date 
 from t1)

select duration_training, start_date, to_char(start_date, 'MM'), to_char(start_date, 'Month')

/*
with t1 as 
(select fy_timerange, fy_timerange.start as start_date
from profile_71780),

t2 as 
(select fy_timerange, start_date :: date
from t1)

select fy_timerange, start_date, to_char(start_date, 'MM'), to_char(start_date, 'Month')
from t2
*/
--if else condition is not clear 
