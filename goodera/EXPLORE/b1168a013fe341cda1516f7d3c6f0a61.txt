with b as(
  select 'Male' as col
  union all
  select 'Female' as col
  union all
  select 'Other' as col)

Select a.fy_timerange, p.name as projectid,p1.name as donor,b.col as gender,
sum(case col
	when gender = 'Male' then a.male_student
	when gender = 'Female' then a.female_student	
	when gender = 'Other' then a.other_gender_student	
	else NULL
	end as) students
	
from profile_80587 a
left join ds_mysql_prod_project p on p.id = a.projectid
left join ds_mysql_prod_project p1 on p1.id = p.parent