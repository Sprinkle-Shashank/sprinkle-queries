with s as(
Select * from imp_one
union all
Select * from imp_two
union all
Select * from imp_three
union all
Select * from imp_four
),
s2 as(
Select s.imp_agency as Implementation_Agency,s.status as Status,s.yearr as Empanneled_Since,s.contact_person as contact,s.email as email,s.mobile_number as mobile_number,s.date_of_last_approval,s.date_of_renewal,s.Empanelment_Type,s.fa1 as focus_area,s.approval_status,s.no_yrs_eng,
case 
	when s.status='SUBMITTED' then s.approval_status
	else s.status
end as final_Status,s.approval_log_timestamp
from s
),
s3 as (
Select *,
row_number() over(partition by s2.Implementation_Agency order by s2.approval_log_timestamp desc) as row

 from s2
)
Select * from s3
where row=1