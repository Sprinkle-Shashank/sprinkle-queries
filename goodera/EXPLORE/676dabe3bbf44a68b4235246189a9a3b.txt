with sub1 as (select a.*, unwind_cycle from profile_64362 as a, a.cycle as unwind_cycle),


t1 as (select p1._id as id2, p1.projectId, p1.select_factory_msa,p2.country, p2.vendor, tag2.name as cycle, p2.consultant,
	   case 
	   when p1.grievance = 1105585 then 1
	   when p1.grievance = 1105584 then 2 
	   when p1.grievance = 1105583 then 3 
	   when p1.grievance = 1105582 then 4
	   when p1.grievance = 1105581 then 5
	   end as grievance1
from profile_62477 p1
left join sub1 p2
on p1.projectId=p2.projectId
	 left join ds_mysql_prod_tagelement tag2
on p2.unwind_cycle = tag2.id 
	  ),
	  
t2 as (select t.* 
from t1 t
group by projectId, select_factory_msa, country, vendor, consultant, cycle, id2)
	   select * from t2
	   