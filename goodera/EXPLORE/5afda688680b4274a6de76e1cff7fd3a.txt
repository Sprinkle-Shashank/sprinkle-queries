with s1 as (
  Select reg_number, brief as description, vision_and_mission as mission, t2.name org_type,  registration_date, pan, t3.name tax_exemption_2, t1.name spriritual_agenda, NULL participate_board, individual_donors, corporate_funders, government_funding, other_funding, budget, total_expenses, target_beneficiary, socioeconomic, org_objective, outreach_lastfy, cost_beneficiary, full_term, NULL perc

from profile_27395 p
left join ds_mysql_prod_tagelement t1
ON t1.id=p.spriritual_agenda
left join ds_mysql_prod_tagelement t2
ON t2.id=p.org_type
left join ds_mysql_prod_tagelement t3
ON t3.id=p.tax_exemption_2

/*union all

Select reg_number,NULL as description,NULL as mission,NULL as org_type,NULL as registration_date, pan, t3.name tax_exemption_2, t1.name spriritual_agenda, NULL participate_board, individual_donors, corporate_funders, government_funding, other_funding, budget, total_expenses, NULL target_beneficiary, NULL socioeconomic_2, NULL org_objective, outreach_lastfy, cost_beneficiary, full_term, NULL perc

from profile_27405 p
left join ds_mysql_prod_tagelement t1
ON t1.id=p.spriritual_agenda
left join ds_mysql_prod_tagelement t3
ON t3.id=p.tax_exemption_2*/

union all

Select registration_number as reg_number, description, mission,t2.name org_type, registration_date, pan_card pan, NULL tax_exemption_2, 
t1.name spriritual_agenda
, participate_board
, percentage_donors individual_donors, total_donations corporate_funders, percentage_funding government_funding, percentage_agencies other_funding, organization_budget budget, NULL total_expenses, target_beneficiary, percentage_socio_economic socioeconomic, objective org_objective , direct_beneficiaries outreach_lastfy, cost_per_beneficiary cost_beneficiary, on_role_employees full_term, percentage_5_years perc

from profile_80183 p
left join ds_mysql_prod_tagelement t2
ON t2.id=p.org_type
left join ds_mysql_prod_tagelement t1
ON t1.id=p.spiritual_affliation_2

union all

Select registration_number as reg_number, description, mission,t2.name org_type, registration_date, pan_card pan, NULL tax_exemption_2, 
t1.name spriritual_agenda
, participate_board
, percentage_donors individual_donors, total_donations corporate_funders, percentage_funding government_funding, percentage_agencies other_funding, organization_budget budget, NULL total_expenses, target_beneficiary, percentage_socio_economic socioeconomic, objective org_objective , direct_beneficiaries outreach_lastfy, cost_per_beneficiary cost_beneficiary, on_role_employees full_term, percentage_5_years perc

from profile_80188 p
left join ds_mysql_prod_tagelement t2
ON t2.id=p.org_type
left join ds_mysql_prod_tagelement t1
ON t1.id=p.spiritual_affliation_2
  ),
  
s2 as(
  Select s1.*, tar_bene 
  from s1 s3,s3.tb_new tar_bene
  ),
 
 s3 as (
   Select sub4.*,
  listagg(distinct t.name,', ') as target_beneficiary 
  from s2 sub4
left join ds_mysql_prod_tagelement t on t.id=sub4.tar_bene
 )
 
 
 Select *
 from s3
 
 union all
 
 Select reg_number,NULL as description,NULL as mission,NULL as org_type,NULL as registration_date, pan, t3.name tax_exemption_2, t1.name spriritual_agenda, NULL participate_board, individual_donors, corporate_funders, government_funding, other_funding, budget, total_expenses, NULL target_beneficiary, NULL socioeconomic_2, NULL org_objective, outreach_lastfy, cost_beneficiary, full_term, NULL perc

from profile_27405 p
left join ds_mysql_prod_tagelement t1
ON t1.id=p.spriritual_agenda
left join ds_mysql_prod_tagelement t3
ON t3.id=p.tax_exemption_2