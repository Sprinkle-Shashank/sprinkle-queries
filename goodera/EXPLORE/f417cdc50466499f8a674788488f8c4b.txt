With tab1 as (Select p1.month_timerange, p1.project_code_new, sum(p1.amount),
p2.project_name, p2.focus, p2.entity,
case
  when is_array(p2.vertical) = false or get_array_length(p2.vertical) = 0 then 
  	   array(p2.vertical)
  else p2.vertical
end as vertical
From profile_55194 p1
left join profile_62881 p2
on p1.project_code_new=p2._id
group by 1,2,4,5,6,7)

Select *
From tab1