with base1 as (select p.projectId, p.reg_no, p.trainee_name, p.batch_id as batch_id_1, p.dob, p.gender, p.addr, p.district, p.state, p.edu_qual, p.marriage, p.fam_head, p.fam_occ, p.state_and_city, p.placed, p.date_of_placement, p.emp_name, p.role_after_placement, p.job_loc, p.type, p.city_of_job, p.dropout, p.type_of_dis, p.mobile_no, p.mobile_number_2, p.fam_size, p.fam_income, p.salary, p.lvl_of_dis from profile_36901 p
union all
select m.projectId,m.reg_no, m.trainee_name,m.batch_id,m.dob,m.gender,  m.addr,district,m.state, m.edu_qual, m.marriage, m.fam_head,m.fam_occ,m.state_and_city,m.placed, m.date_of_placement, m.emp_name, m.role_after_placement, m.job_loc, m.type, m.city_of_job,m.dropout, m.type_of_dis,m.mobile_no, m.mobile_number_2, m.fam_size,m.fam_income, m.salary,m.lvl_of_dis  from profile_145 m
),
base2 as (select *,h.start, h.end, h.donor, h.center_name, h.donor_commitment, h.name as batch_id
 from base1 k
left join profile_196 h on
k.batch_id_1=h._id
)
select * from base2
		  


   
