with table1 as (
   select projectId, project_name, fy_timerange, tot_disbursed, case when profile_65556.projectId is not null then 'CSR Spend' end as filter, case when Substring(json_serialize(fy_timerange),3,3) = 'end' then Substring(json_serialize(fy_timerange),9,4) else Substring(json_serialize(fy_timerange),11,4) end as FY
  from profile_65556
  
)
select table1.projectId, project_name, fy_timerange, sum(tot_disbursed) as tot_disbursed, filter, concat('FY',FY) as FY, focus_area, project_type, proj_name, impl_agency from table1

left join profile_65552 on
table1.project_name = profile_65552._id

group by table1.projectId, project_name, fy_timerange, focus_area, project_type, proj_name, impl_agency,filter,FY