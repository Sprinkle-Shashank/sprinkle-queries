with Base1 as(
  Select f.name as fy_timerange, split_part(split_part(prod.name,'|',1),'.',1) as ProjectCode , split_part(prod.name,'|',2) as Region,
   case 
  when file_upload like 'https://api.p3fy.com%'  then file_upload
  else 'No'
  end as file_upload1,
  
  case
   when select_quarter='434773' and file_upload1 != 'No' then file_upload1
  else 'N2'
  end as q1,
   case
   when select_quarter='434774' and file_upload1 != 'No' then file_upload1
  else 'N2'
  end as q2,
   case
   when select_quarter='434775' and file_upload1 != 'No' then file_upload1
  else 'N2'
  end as q3,
   case
   when select_quarter='434776' and file_upload1 != 'No' then file_upload1
  else 'N2'
  end as q4
  
from profile_60787
left join  ds_mysql_prod_project prod  on
prod.id=projectid
  
left join ds_mysql_prod_tagelement f 
on fy=f.id),

Base2 as(
  Selectb ProjectCode,f.name as Core_area,m.name as Project_Manager 
  from Base1 
  left join profile_27396 on
ProjectCode=name
left join ds_mysql_prod_tagelement f on 
focus_area=f.id
left join ds_mysql_prod_tagelement m on 
project_manager=m.id
  union all
  Select fy_timerange ,p.name as ProjectCode, k.focus_area as Core_area,m.name as Project_Manager
		 from profile_27420 k
left join profile_27396 p
on k.project_code=p._id
left join ds_mysql_prod_tagelement m on 
k.project_manager=m.id
),

Base3 as(
  Select k.focus_area as Core_area,m.name as Project_Manager,p.name as ProjectCode 
		 from profile_27420 k
left join profile_27396 p
on k.project_code=p._id
left join ds_mysql_prod_tagelement m on 
k.project_manager=m.id


),

Base4 as(select p.fy_timerange,p.ProjectCode, k.Core_area,k.Project_Manager, file_upload1 as click_Here,'Submitted'as click
from Base1 p
left join Base3 k 
on p.ProjectCode=k.ProjectCode) 

select * from Base1