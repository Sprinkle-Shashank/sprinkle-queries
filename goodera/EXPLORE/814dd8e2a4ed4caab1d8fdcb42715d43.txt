with t1 as 
(select p1.projectId, p1.notes_2, p1.end_date_2, p1.start_date_2, p1.training, p1.training_type, p1.supervisors, p1.employed, p1.saturation, p1.master_trainers, p1.year,p2.country, p2.factory, p2.vendor, p2.consultant, p2.product_category,tag1.name as country2, tag2.name as product_category2,
 cast('Cycle 1' as VARCHAR) as Cycle1,
 cast('Cycle 2' as VARCHAR) as Cycle2
from profile_64817 p1
left join profile_64362 p2 
on p1.projectId = p2.projectId
left join ds_mysql_prod_tagelement tag1
on p2.country = tag1.id
left join ds_mysql_prod_tagelement tag2
on p2.product_category = tag1.id )

select projectId,notes_2,end_date_2,start_date_2,training,training_type, supervisors, employed,saturation,master_trainers, year,country,factory,vendor,consultant, product_category,country2 , product_category2,
cast('50' as VARCHAR) as Target,
case 
when year = 1433762 then Cycle1
when year = 1433763 then Cycle1
when year = 1433764 then Cycle1
else Cycle2
end as cycle
from t1