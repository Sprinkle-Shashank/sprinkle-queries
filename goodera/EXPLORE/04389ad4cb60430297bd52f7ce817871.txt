WITH table1 AS (SELECT xprojectid,t1.name as financialperiod,keyword,p.name,datatablebase FROM sus_21557 AS p
left join tagElement_6664 t1 on p.financialperiod = t1.id				
				WHERE keyword = 'executives_trained'
		   ),
table2 AS (SELECT xprojectid,financialperiod,name, coun.male,coun.female FROM table1 AS p, UNPIVOT p.datatablebase AS coun ),

table3 as (SELECT xprojectid,t1.name as financialperiod,keyword,p.name,datatablebase FROM sus_21557 AS p
left join tagElement_6664 t1 on p.financialperiod = t1.id				
				WHERE keyword = 'managers_and_above'
		   ),
		   
table4 AS (SELECT xprojectid,financialperiod,name, coun.male,coun.female FROM table3 AS p, UNPIVOT p.datatablebase AS coun ),

table5 as (SELECT xprojectid,t1.name as financialperiod,keyword,p.name,datatablebase FROM sus_21557 AS p
left join tagElement_6664 t1 on p.financialperiod = t1.id				
				WHERE keyword = 'non_executives_trained'
		   ),
		   
table6 AS (SELECT xprojectid,financialperiod,name, coun.male,coun.female FROM table5 AS p, UNPIVOT p.datatablebase AS coun )

select * from table6



