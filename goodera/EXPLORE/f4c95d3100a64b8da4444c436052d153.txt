with t1 as
(select p1.fy_timerange ,p1.intervention_type,sum(p1.sales_amount)  as sales_amount,CAST(P1.fy_timerange as VARCHAR) as month,
case
when month=4 then 1
when month=5 then 2
when month=6 then 3
when month=7 then 4
when month=8 then 5
when month=9 then 6
when month=10 then 7
when month=11 then 8
when month=12 then 9
when month=1 then 10
when month=2 then 11
else 12
end as sort,fy_timerange :: date
from profile_76023 as p1
group by p1.fy_timerange,p1.intervention_type ,p1.sales_amount)

select fy_timerange,tag1.name as intervention_type,sales_amount,sort
from t1
left join ds_mysql_prod_tagelement as tag1 on 
t1.intervention_type = tag1.id
 
 
