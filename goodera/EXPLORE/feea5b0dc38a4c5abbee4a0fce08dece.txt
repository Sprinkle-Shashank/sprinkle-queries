with t1 as
(SELECT * 
FROM
(Select   p.month_timerange, p.kannada, p.evs, p.maths, p.science, p.social_science, p.hindi, p.computer, p.english,p1.schoolname as school from profile_60441 p
 left join profile_60437 p1
on p1._id= p.sats
 
)
UNPIVOT (
    val FOR dim IN ( kannada, evs, maths, science, social_science, hindi, computer, english))

)

select p1._id,p1.schoolname,p1.name, month_timerange as fy_timerange,   avg(val) as val  from t1 as p
 
    left join profile_60426 p1
on p1._id= p.school
  where val is not null 
Group By  p.month_timerange,fy_timerange,p1._id,p1.schoolname,p1.name