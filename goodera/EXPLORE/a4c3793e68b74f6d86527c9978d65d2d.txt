with sub1 as(select p1.name as projectid,t1.name as financial_period,fy_timerange, p1.datanumbase as gri_quantity_nonhazardous_waste,measureunitbase as unit,('FY' || ' ' || split_part(financial_period, ' ', 2)) as FY,questiontext

from sus_56551 p1
left join ds_mysql_prod_tagelement t1 on t1.id=p1.financialPeriod
where keyword='gri_quantity_nonhazardous_waste' and datanumbase is not null)

select projectid,financial_period,fy_timerange, sum(gri_quantity_nonhazardous_waste) as Solid_Waste_Recycled,unit,FY,questiontext from sub1
group by projectid,financial_period,fy_timerange,unit,FY,questiontext

