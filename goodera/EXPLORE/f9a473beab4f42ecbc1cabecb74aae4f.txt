select t.*,loc.name as location,sta.name as state_1,reftag.code,
decode(sta.name,null,loc.name,sta.name) as state_2
from profile_55622 t
left join ds_mysql_prod_tagelement loc
on t.location=loc.id
left join ds_mysql_prod_tagelement sta
on loc.parent=sta.id
left join ds_mongo_reftagelementmetadata reftag
on state_1 = reftag.name
--where code is not null


