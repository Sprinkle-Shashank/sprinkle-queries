
select g1.code,gpr1.grantproposalid,gpr1.modified,gpr1.action
from ds_mysql_prod_grantflowtaskgrantproposalrecord gpr1
inner join (
  select gpr.grantproposalid, gpr.grantflowtaskid,max(gpr.modified)
  from ds_mysql_prod_grantflowtaskgrantproposalrecord gpr
  group by gpr.grantproposalid, gpr.grantflowtaskid) tab
  on gpr1.grantproposalid = tab.grantproposalid and gpr1.grantflowtaskid = tab.grantproposalid 
  and gpr1.modified = tab.modified
left join ds_mysql_prod_grantproposal g1
on g1.id = gpr.grantproposalid
where gpr.grantflowtaskid = '821' and gpr.action = 'COMPLETED'

  