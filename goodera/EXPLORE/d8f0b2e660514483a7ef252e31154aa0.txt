with x as (select datatablebase,fy_timerange,name From sus_83132 as p where keyword='keyword_1'),
table1 as (select fy_timerange,name,cast(coun.supplier_name as varchar),coun.material_type ,coun.category,coun.volume,coun.spend From x as p, unpivot p.datatablebase as coun )

select fy_timerange,name,supplier_name, mat.name as material_type,cat.name as category ,volume,spend from table1 t1

left join tagElement_9427 mat on 
t1.material_type = mat.id

left join tagElement_9427 cat on 
t1.category = cat.id