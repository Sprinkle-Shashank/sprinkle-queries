with sub1 as(
  select p2.name as projectid, t2.name as country, p1.vendor, p4.name as consultant, p3.cycle

from profile_62477 p1
left join ds_mysql_prod_project p2 on p2.id = p1.projectid
left join profile_64362 p3 on p3.projectid = p1.projectid
left join profile_61583 p4 on p4._id = p3.consultant

left join ds_mysql_prod_tagelement t1 on t1.id = p3.country),

sub2 as(
  select s1.*, cycle_new from sub1 s1, s1.cycle cycle_new)
  
select s2.projectid, s2.country, s2.vendor, s2.consultant, t2.name as cycle
from sub2 s2
left join ds_mysql_prod_tagelement t2 on t2.id = s2.cycle_new
group by s2.projectid, s2.country, s2.vendor, s2.consultant, t2.name