with sub1 as (
select p.name as projectId, sched7, fy_timerange, sum(budget_approved) as budget_approved from profile_41363
left join ds_mysql_prod_project p
on p.id=projectid
group by p.name, sched7, fy_timerange),
sub2 as (
select projectId, sched7_1, fy_timerange, budget_approved from sub1 a, a.sched7 sched7_1),
sub3 as (
select projectId, t.name as sched7, fy_timerange, budget_approved from sub2
left join ds_mysql_prod_tagelement t
on t.id=sched7_1)
select * from sub1