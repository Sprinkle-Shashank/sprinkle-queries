with base1 as(
select split_part(proj1.name,'|',1) as project_code, split_part(proj1.name,'|',4) as project_name, p.fy as fy1, split_part(proj2.name,'|',1) as parent_code, p2.project_manager as project_manager_p2,  p2.fy as fy_p2, p3.project_manager as project_manager_p3, p3.fy as fy_p3 from profile_54963 p
  left join ds_mysql_prod_project proj1 on p.projectid=proj1.id
  left join ds_mysql_prod_project proj2 on proj1.parent=proj2.id
  left join profile_27396 p2 on split_part(proj2.name,'|',1) = p2.name
  left join profile_27420 p3 on p3.project_code = p2._id
  
)

select * from base1