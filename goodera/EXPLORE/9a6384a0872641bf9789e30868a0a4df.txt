SELECT SC.fy_timerange, SC.beneficiary,
P.name AS projectid,
C.name AS cohort,
L.name AS location,
COUNT(*) AS households,

CASE
	WHEN 
	SC.cookstove_sessions = true
	THEN 'Yes'
	ELSE 'No'
	END AS cookstove_sessions,
	
CASE
	WHEN 
	SC.coaching_sessions = true
	THEN 'Yes'
	ELSE 'No'
	END AS coaching_sessions,
	
CASE
	WHEN 
	SC.cookstove_usage = true
	THEN 'Yes'
	ELSE 'No'
	END AS cookstove_usage

FROM profile_82723 AS SC

LEFT JOIN ds_mysql_prod_tagelement AS C
ON SC.cohort = C.id

LEFT JOIN ds_mysql_prod_project AS P
ON SC.projectid = P.id

LEFT JOIN ds_mysql_prod_tagelement AS L
ON SC.location = L.id

GROUP BY SC.fy_timerange, SC.beneficiary, P.name, C.name, L.name, SC.cookstove_sessions, SC.coaching_sessions, SC.cookstove_usage