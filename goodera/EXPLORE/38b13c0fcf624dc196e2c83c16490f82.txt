
			
			
with test2a as(
select concat(p.f_reg_date,concat('|',p.f_reg_date)) as fy_timerange, p.projectid, p.p_id, p.f_category, p.oral, p.diabetes, p.sti, tb1, p.hiv, p.vision, p.hypertension from profile_59462 p cross join p.tb tb1
  )

select p.fy_timerange, p.projectid, p.p_id, p.f_category, p.hiv as hiv1, decode(p.hiv,1012483,1,1012478,1,0) as hiv2 from test2a p where hiv2 is null

	