with base1 as(select p.fy_timerange, 
donor, 
projectid, p.donor_commitment_db from profile_196 p 
union all
select p.fy_timerange, 
donor, 
projectid, p.donor_commitment_db from profile_36904 p
)
select p.fy_timerange,  k.name as donor, t2.name as project, p.donor_commitment_db as donor_commitment from base1 p
left join ds_mysql_prod_tagelement k on
p.donor= k.id
LEFT JOIN ds_mysql_prod_project t on p.projectId=t.id
LEFT JOIN ds_mysql_prod_project t1 on t.parent=t1.id      
LEFT JOIN ds_mysql_prod_project t2 on t1.parent=t2.id 
where  p.donor_commitment_db != '' 