select p1.fy_timerange, p1.activity, t1.name as country, t2.name as focus_area, t3.name as prod_brand, 
sum(p1.direct_cash_donations*p2.conversion_factor) as investment
from profile_78057 p1
left join ds_mysql_prod_tagelement t1 on t1.id = p1.country
left join ds_mysql_prod_tagelement t2 on t2.id = p1.focus_area
left join ds_mysql_prod_tagelement t3 on t3.id = p1.product_brand
left join ds_mysql_prod_tagelement t4 on t4.id = p1.currency
left join profile_78083 p2 on p2.name = (t4.name||'_'||extract(year from cast(p1.fy_timerange.start as date)))
group by p1.fy_timerange, t1.name, t2.name, t3.name, t5.name