with t1 as(
  Select id, t.name as ts, p.name as bs
from profile_3864 sq
left join profile_3863 p 
ON p._id=sq.batch_details
left join ds_mysql_prod_tagelement t
On t.id=sq.training_status
  )
  
Select 
case
when bs like 'KAR%' then 'Enrolled'
when ts='Completed' then 'Completed'
when ts='Dropout' then 'Certified'
end as s,
count(*)
from t1
group by t1.ts, bs