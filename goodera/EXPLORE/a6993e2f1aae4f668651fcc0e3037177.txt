select a.projectid, a.school_name, count(a.school_name) as no_of_schools, a.fy_timerange, a.no_of_students, profile_78738.name, s.name as state from profile_78738 a

left join ds_mysql_prod_tagelement s
on profile_78738.state = s.id

group by a.projectid, a._id, a.school_name, a.fy_timerange, a.state, a.no_of_students, profile_78738.name, s.name