
with table4 as
(
  select work.name as working, gen.name as gender, ag.name as age, mart_stat.name as marital_status from profile_65617 as p 
  
left join ds_mysql_prod_tagelement gen 
on p.gender = gen.id
  
 left join ds_mysql_prod_tagelement work 
on p.working = work.id
  
 left join ds_mysql_prod_tagelement ag 
on p.age = ag.id
  
 left join ds_mysql_prod_tagelement mart_stat 
on p.marital_status = mart_stat.id
 )
 , table5 as
 (
   select  work.name as working, gen.name as gender, ag.name as age, mart_stat.name as marital_status from profile_65902 as p1
 
left join ds_mysql_prod_tagelement gen 
on p1.gender = gen.id
  
 left join ds_mysql_prod_tagelement work 
on p1.working = work.id
  
 left join ds_mysql_prod_tagelement ag 
on p1.age = ag.id
  
 left join ds_mysql_prod_tagelement mart_stat 
on p1.marital_status = mart_stat.id
 )
 , table6 as 
 (
   select gender,gender as gender_base from table4
  )
  , table7 as 
  (
 select * from table4 union all select * from table5
   )
 select gender_base, table7.working from table6
 
left join table7 on 
table6.gender = table7.gender
