with sub1 s1(
  select p1.*,
  
  case
  	when is_array(p1.fund_details) or GET_ARRYAY_LENGTH(p1.fund_details) = 0 then 						array(p1.fund_details)
  	else p1.fund_details
  end as fund_details_new
  
from profile_32441 p1)

sub2 as(
  select s1.*, fund_details from sub1 s1, s1.fund_details_new fund_details)
  
select * from sub2