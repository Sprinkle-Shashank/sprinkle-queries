select substring(p.reg_date,1,10)||'T00:00:00.000Z' ||'|'|| substring(p.reg_date,1,10)||'T00:00:00.000Z' as fy_timerange, substring(p.reg_date,9,2)||'-'||substring(p.reg_date,6,2)||'-'||substring(p.reg_date,1,4) as date1, project.name as projectid, p.patient_name, p.gender, p.p_id, p.search_status, p.f_contact, p.f_marital_status, p.f_education, p.f_p_address, p.f_l_address, p.f_category, p.f_age, p.f_route, p.f_vehicle, p.oral, p.diabetes, p.sti, p.tb, p.hiv, p.vision, p.hypertension, p.general, q.name as past_diag1, p.details_check, p.govt, p.fees from profile_59462 p
left join profile_59462 q on p.past_diag = q._id
left join ds_mysql_prod_project project on p.projectid = project.id where p.reg_date is not null