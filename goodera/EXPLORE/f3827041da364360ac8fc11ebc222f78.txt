With Main as(SELECT  timerange_timerange, date_of_assessment_test,count(*) as No,
CASE
	WHEN t.name='No' then 'Completed'
	WHEN t.name='Yes' THEN 'Dropped out'
	ELSE 'Undergoing training'
END AS training_status
FROM profile_4264
left join ds_mysql_prod_tagelement t
on t.id=dropout
GROUP BY t.name,timerange_timerange,date_of_assessment_test)

SELECT timerange_timerange,No,training_status
FROM main
group by timerange_timerange,No,training_status