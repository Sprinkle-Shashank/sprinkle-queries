With Main as(SELECT dropout,t.name as r, timerange_timerange, date_of_assessment_test,count(*) as No,
CASE
	WHEN r='No' then 'Completed'
	WHEN r='Yes' THEN 'Dropped out'
	ELSE 'Undergoing training'
END AS training_status
FROM profile_4264
left join ds_mysql_prod_tagelement t
on t.id=dropout
GROUP BY dropout, r,timerange_timerange,date_of_assessment_test)
SELECT timerange_timerange,No,training_status
FROM main
group by timerange_timerange