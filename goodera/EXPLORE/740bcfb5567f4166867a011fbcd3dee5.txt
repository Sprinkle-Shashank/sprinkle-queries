Select p.projectid,coalesce(total_workers,0), extract(year from p2.date_enrollment)as s_year, extract(month from p2.date_enrollment)as month,
case when month = 1 then s_year-1
ELSE s_year END AS year_new,
s.name as status , coalesce(status,0) as status_new from profile_17526 p
			   
LEFT JOIN profile_16619 p2 ON
p.projectid = p2.projectid
			   
 LEFT JOIN ds_mysql_prod_tagelement AS S ON
p2.status = s.id
			   
 --Where status is not Null OR total_workers != ''
WHERE total_workers != 0