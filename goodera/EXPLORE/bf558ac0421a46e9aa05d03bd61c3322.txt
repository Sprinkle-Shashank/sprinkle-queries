Select case (p4.int_type_calc2)
when 'Indirect' then sum (p2.hdfc_cost_monthly+p6.monthly_cost)
 else  sum(p2.hdfc_cost_monthly+p6.monthly_cost+p4.curr_yr_budget)
 end as AllocatedAmount,p4.int_type_calc2 as intervention_type, f.name as financial_year from profile_29974 p2

left join profile_27420 p4 on
p4.project_code=p2.prj_code and p4.fy=p2.fy

left join profile_30171 p6 on
p6.prj_code=p2.prj_code and p6.fy=p2.fy

left join ds_mysql_prod_tagelement f on
p2.fy=f.id 
group by f.name,p4.int_type_calc2
/*with x as (Select case (p8.name)
when 'Indirect' then sum (p2.hdfc_cost_monthly+p6.monthly_cost)
 else  sum(p2.hdfc_cost_monthly+p6.monthly_cost+p4.curr_yr_budget)
 end as AllocatedAmount,p8.name as intervention_type, f.name as financial_year from profile_27396 p1
 left join profile_28235 p8
on p8._id=p1.intervention_type
left join profile_29974 p2 on
p1._id=p2.prj_code and p1.fy=p2.fy


left join profile_27420 p4 on
p1._id=p4.project_code and p1.fy=p4.fy
left join profile_30171 p6 on
p1._id=p6.prj_code and p1.fy=p6.fy

left join ds_mysql_prod_tagelement f on
p2.fy=f.id 
group by f.name,p8.name)
select sum(x.AllocatedAmount) as AllocatedAmount, x.financial_year from x group by x.financial_year*/

/*Select case (p4.int_type_calc2)
when 'Indirect' then sum (p2.hdfc_cost_monthly+p6.monthly_cost)
 else  sum(p2.hdfc_cost_monthly+p6.monthly_cost+p4.curr_yr_budget)
 end as AllocatedAmount,p4.int_type_calc2 as intervention_type, f.name as financial_year from profile_29974 p2

left join profile_27420 p4 on
p4.project_code=p2.prj_code

left join profile_30171 p6 on
p4.project_code=p6.prj_code

left join ds_mysql_prod_tagelement f on
p2.fy=f.id 
group by f.name,p4.int_type_calc2*/

/*with x as (Select case (p8.name)
when 'Indirect' then sum (p2.hdfc_cost_monthly+p6.monthly_cost)
 else  sum(p2.hdfc_cost_monthly+p6.monthly_cost+p4.curr_yr_budget)
 end as AllocatedAmount,p8.name as intervention_type, f.name as financial_year from profile_27396 p1
 left join profile_28235 p8
on p8._id=p1.intervention_type
left join profile_29974 p2 on
p1._id=p2.prj_code


left join profile_27420 p4 on
p1._id=p4.project_code 
left join profile_30171 p6 on
p1._id=p6.prj_code

left join ds_mysql_prod_tagelement f on
p2.fy=f.id 
group by f.name,p8.name)
select sum(x.AllocatedAmount) as AllocatedAmount, x.financial_year from x group by x.financial_year*/

/*select sum(p2.hdfc_cost_monthly+p6.monthly_cost) as allocatedamount, f.name  as financial_year from profile_27396 p1
left join profile_30171 p6 on
p1._id=p6.prj_code 
left join profile_29974 p2 on
p1._id=p2.prj_code
left join ds_mysql_prod_tagelement f on
p6.fy=f.id 
group by f.name*/






/*select p1.name as projectcode ,p4.curr_yr_budget from profile_27396 p1
left join profile_27420 p4 on
p1._id=p4.project_code*/

/*select sum(p2.hdfc_cost_monthly+p6.monthly_cost) as allocatedamount, f.name  as financial_year from profile_27396 p1
left join profile_30171 p6 on
p1._id=p6.prj_code 
left join profile_29974 p2 on
p1._id=p2.prj_code
left join ds_mysql_prod_tagelement f on
p1.fy=f.id 
group by f.name*/

/*select p1.name as projectcode ,p2.hdfc_cost_monthly from profile_27396 p1
left join profile_29974 p2 on
p1._id=p2.prj_code */

/*left join profile_27420 p4 on
p1._id=p4.project_code */
/*left join profile_30171 p6 on
p1._id=p6.prj_code*/




/*select p1.name as projectcode ,sum(d.payment_amount) as DisbursedAmount, f.name  as financial_year from profile_27396 p1
left join profile_27398 d on
p1._id=d.project_name 
left join ds_mysql_prod_tagelement f on
p1.fy=f.id 
group by f.name,p1.name*/

/*Select case (p8.name)
when 'Indirect' then sum (p2.hdfc_cost_monthly+p6.monthly_cost)
 else  sum(p2.hdfc_cost_monthly+p6.monthly_cost+p4.curr_yr_budget)
 end as AllocatedAmount,p8.name as intervention_type, f.name as financial_year, sum(d.payment_amount) as DisbursedAmount,sum(cast (t.two_percent as bigint)) as TwoPercentAmount from profile_27396 p1
 left join profile_28235 p8
on p8._id=p1.intervention_type
/*left join profile_29974 p2 on
p1._id=p2.prj_code*/

left join profile_29974 p2 on
p1._id=split_part(split_part(p2.name,'|',1),'.',1) 

left join profile_27420 p4 on
p1._id=p4.project_code 
/*left join profile_30171 p6 on
p1._id=p6.prj_code*/

left join profile_30171 p6 on
p1._id=split_part(split_part(p6.name,'|',1),'.',1) 
left join profile_27398 d on
p1._id=d.project_name 
left join profile_36762 t on
p1._id=t.name
left join ds_mysql_prod_tagelement f on
p1.fy=f.id 
group by f.name,p8.name*/

/*select sum(x.DisbursedAmount) as disbursedAmount, x.financial_year from x group by x.financial_year*/


/*cast((split_part(split_part(prod.name,'|',1),'.',1)) as varchar) as ProjectCode*/
 
/*select sum(p2.payment_amount) as DisbursedAmount, f.name  as financial_year from profile_27398 p2
left join ds_mysql_prod_tagelement f on
p2.fy=f.id
group by f.name*/

/*Select sum(p1.two_percent) as TwoPercentAmount,f.name  as financial_year from profile_36762 p1
left join ds_mysql_prod_tagelement f on
p1.fy=f.id
group by f.name*/



