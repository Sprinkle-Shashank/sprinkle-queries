with temp as (
  select 'Training_1' as col
  union all
   select 'Training_2' as col
  union all
   select 'Training_3' as col
  union all
  select 'total' as col
  ),
  tab1 as(
select p.projectId, p.q1_timerange, sum(p.ba2+p.ba3+p.ba4) as total,p.ba2,p.ba3,p.ba4
from profile_60829 p
cross join temp
where q1_timerange is not null
group by projectId, q1_timerange,ba2,ba3,ba4)

select s.projectId, s.q1_timerange,
case col
when 'Training_1' then s.ba2
when 'Training_2' then s.ba3
when 'Training_3' then s.ba4
when 'total' then s.total
else 0
end as number, temp.col as training from tab1 as s
cross join temp
group by s.projectId, s.q1_timerange,temp.col,s.ba2, s.ba3, s.ba4
