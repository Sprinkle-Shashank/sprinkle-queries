with table12 as
 ( 
  select p.projectid , p._id , status from profile_16619 as p
 ),
 
 table14 as
 (
 select p.projectid , p._id , ROW_NUMBER() over (partition by p.projectid order by p._id desc) as row, 1 as count , sta.name as status_update from table12 as p
   
   
left join ds_mysql_prod_tagelement sta
on p.status = sta.id
   
),

table15 as
( select p.projectid , p._id , status_update from table14 as p where row=1 ),

table18 as
(
  select p.projectid , last_day_workers , workers_exited , day_1_workers , fac.name as factory , ven.name as vendor , cou.name as country  from profile_16862 as p

left join ds_mysql_prod_project fac
on  p.projectid = fac.id

left join ds_mysql_prod_project ven
on fac.parent = ven.id

left join ds_mysql_prod_project cou
on ven.parent = cou.id)

select * from table15
