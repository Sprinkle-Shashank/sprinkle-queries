with t1 as 
(select tag1.name as projectId, fam_incom , fy1_timerange, count(*),
case fam_incom 
when fam_incom is null then '0'
else fam_incom 
end as a  
from profile_29014 p1
left join ds_mysql_prod_project tag1
on p1.projectId = tag1.id
group by tag1.name, fam_incom, fy1_timerange)

select projectId, fam_incom, fy1_timerange, count, a
from t1 
