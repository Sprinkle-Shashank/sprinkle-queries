

Select t.name as site,t1.name as financialperiod,t2.name as fin_q,t3.name as fin_h,t4.name as fin_y ,tt.name as xquestionid,tt1.name as sub_region,tt2.name as Region,
--EXTRACT(YEAR FROM(CAST(fy_timerange.start AS datetime))) as year,
sum(
  case
 when keyword='total_water_usage' then datanum
  else 0
  end )as total_water_usage,sum(
  case
 when keyword='water_usage_new_water_reclaimed' then datanum
  else 0
  end )as water_usage_new_water_reclaimed,
  sum(
  case
 when keyword='water_usage_reclaimed_storm' then datanum
  else 0
  end )as water_usage_reclaimed_storm,
  sum(
  case
 when keyword='water_usage_utility_provider' then datanum
  else 0
  end )as water_usage_utility_provider,
  sum(
  case
 when keyword='water_usage_well_water' then datanum
  else 0
  end )as water_usage_well_water,
  sum(
  case
 when keyword='water_cost' then datanum
  else 0
  end )as water_cost
/*sum(case col
 when 'Cubic Metres' then h
 when 'Litres' then h*100
 else null
 end )as total_water_usagee*/
from sus_56999
--cross join temp
left join ds_mysql_prod_project t
on xprojectid=t.id
left join ds_mysql_prod_tagelement tt
on xquestionid=tt.id
left join ds_mysql_prod_tagelement t1
on financialPeriod=t1.id
left join ds_mysql_prod_tagelement t2
on t1.parent=t2.id
left join ds_mysql_prod_tagelement t3
on t2.parent=t3.id
left join ds_mysql_prod_tagelement t4
on t3.parent=t4.id
left join ds_mysql_prod_project tt1
on xprojectid=tt1.id
left join ds_mysql_prod_project tt2
on tt1.parent=tt2.id


where keyword in ('water_usage_new_water_reclaimed' , 'total_water_usage' , 'water_usage_reclaimed_storm' , 'water_usage_utility_provider' , 'water_usage_well_water' , 'water_cost') and xprojectid is not 47608
group by t.name,t1.name,t2.name,t3.name,t4.name,tt.name,tt1.name,tt2.name 


	
	/*with temp as(
Select 'Cubic Metres' as col
  union all
Select 'Litres' as col
)*/



