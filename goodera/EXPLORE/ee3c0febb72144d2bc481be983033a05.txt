
with sub1 as (select a.*, unwind_product_category from profile_64362 as a, a.product_category as unwind_product_category),
t1   as	
(select _id, tag1.name as unwind_product_category  ,tag2.name as country ,p1.cycle from sub1 p1
left join ds_mysql_prod_tagelement tag1
on p1.unwind_product_category = tag1.id 
left join ds_mysql_prod_tagelement tag2
on p1.country = tag2.id

),
sub2  as(select b.*, unwind_cycle from t1 b,b.cycle as unwind_cycle)

select  tag3.name  as unwind_cycle from 
sub2
left join ds_mysql_prod_tagelement tag3
on unwind_cycle = tag3.id 
where unwind_product_category is not null
order by unwind_product_category ASC
