with x as (
SELECT projectid, _id,
 CAST(data.name as VARCHAR) as city,
 CAST(data.fy as VARCHAR),
 CAST(data.sum as INT) as count
from ds_mongo_profileinstance
where profileId='79211' and active = 't' and securitycontextid is not null )
select projectid,city,fy, sum(count)
from x
group by projectid,city,fy


 