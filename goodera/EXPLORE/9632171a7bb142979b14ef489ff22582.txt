SELECT BE.name, BE.goodera_id, BE.beneficiary_name,
--AC2.name AS 
--BE.course_advance2,
--AC3.name AS 
--course_advance3,
P.name AS projectname,
C1.name AS course_advance2,
C2.name AS course_advance3,
AA.name AS advance_availbility,
CONCAT(CONCAT(CONCAT(SPLIT_PART(BE.date_registration, ' ', 1),'T'),SPLIT_PART(BE.date_registration, ' ', 2)),'.000Z') AS fy_timerange
--COUNT(*) AS beneficiaries

FROM profile_56533 AS BE

LEFT JOIN ds_mysql_prod_project AS P
ON BE.projectid = P.id



--LEFT JOIN ds_mysql_prod_tagelement AS AC2
--ON BE.course_advance2 = AC2.id

--LEFT JOIN ds_mysql_prod_tagelement AS AC3
--ON BE.course_advance3 = AC3.id

LEFT JOIN profile_56539 AS C1
ON BE.course_advance2 = C1._id

LEFT JOIN profile_56539 AS C2
ON BE.course_advance3 = C2._id

LEFT JOIN ds_mysql_prod_tagelement AS AA
ON C1.advance_availbility = AA.id

--LEFT JOIN ds_mysql_prod_tagelement AS PE3
--ON BE.previously_enrolled_advance3 = PE3.id

WHERE AA.name = 'Yes'

--GROUP BY BE.name, BE.goodera_id, BE.beneficiary_name, P.name, fy_timerange, G.name, PE1.name, PE2.name, PE3.name

-- Incomplete because of two joins in same table