select fac.name as factory , case when sourcing_yn=57472 then cast(factory_vpid_1 as varchar)
when sourcing_yn=57473 then cast(factory_vpid_2 as varchar) end as factory_id from profile_52713 as p

 left join ds_mysql_prod_project fac 
on p.projectId = fac.id

 left join ds_mysql_prod_project ven 
on fac.parent = ven.id

 left join ds_mysql_prod_project cou 
on ven.parent = cou.id