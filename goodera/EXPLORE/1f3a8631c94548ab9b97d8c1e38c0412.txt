with table1 as(Select  distinct(p.projectid), fac_vpid , month , fy ,fac_rat.name as facility_rating_t , facility_rating,pace_status ,primary_category,parent_vendor_name as vendor , country_name as country , p2.factory_vpid_1,p2.sourcing_yn from profile_54267 p

left join profile_52713 p2 on 
p.projectId= p2.projectId

left join ds_mysql_prod_tagelement fac_rat
on facility_rating = fac_rat.id

where pace_status = 845114 and
p2.sourcing_yn = 57472),
table2 as (select tab1.*,cast(c as int) from table1 as tab1, tab1.primary_category c)
,
table3 as (select *,pr_c.name as prim_cat from table2
		  left join ds_mysql_prod_tagelement pr_c
          on table2.c = pr_c.id
		  
		  )

select * from table3

