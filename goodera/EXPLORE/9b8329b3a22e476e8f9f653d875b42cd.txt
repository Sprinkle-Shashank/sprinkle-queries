with row_number as (select completedon,action,
ROW_NUMBER() over(partition by grantproposalid, grantflowtaskid order by openedon DESC) AS row_number 
from gfgpr_499), 

temp as (select * from row_number where row_number = 1 order by grantproposalid) 
select * from temp where grantflowtaskid in (817, 4749, 5568, 4750, 5590, 7564, 7565, 7762, 7914, 818, 34752,4496, 4501, 4512, 4498, 4506, 4499, 4493, 4491, 15677, 15680, 4488, 4492) and action = 'REJECTED'