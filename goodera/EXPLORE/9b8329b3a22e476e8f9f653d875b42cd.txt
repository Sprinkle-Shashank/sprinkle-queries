with row_number as (select 
cast(concat(concat(substring(cast(timestamp 'epoch' + CAST(completedon AS BIGINT)/1000 * interval '1 second' as varchar), 1, 10),'T'), concat(split_part(cast(timestamp 'epoch' + CAST(completedon AS BIGINT)/1000 * interval '1 second' as varchar), ' ',2),'.000Z')) as datetime) as completedon,action,grantproposalid,grantflowtaskid,
ROW_NUMBER() over(partition by grantproposalid, grantflowtaskid order by openedon DESC) AS row_number 
from gfgpr_499), 

temp as (select * from row_number where row_number = 1 order by grantproposalid) 
select * from temp where grantflowtaskid in (822,817,4750,5568,5589,5590,814,7564,7565,7762,36154,36155,36156,36157,818,34752,8669,9872,9873,9874,9875,13556,22316) and action = 'REJECTED'