with temp as(select name, fy_timerange, datanumbase as amt_ton,amt_ton*1000 as amt_kg,
case keyword
	when keyword ='paper_purchased' then 'Paper/Cardboard'
	when keyword ='cafe_grease' then 'Cafeteria Grease'
	when keyword ='plastic' then 'Plastic'
	when keyword ='metals' then 'Metals'
	when keyword ='electronics_medical' then 'Electronics (Medical Devices)'
	when keyword ='electronics_it' then 'Electronics (IT Disposals)'
	when keyword ='batteries' then 'Batteries (Out of Office Usage)'
	when keyword ='batteries__on_market' then 'Batteries (On Market)'
	when keyword ='organic_waste' then 'Organic Waste'	
	when keyword ='residual_waste' then 'Residual Waste'
	else null
end as types_of_waste
	

from sus_62370 p1
where p1.keyword in ('paper_purchased','cafe_grease', 'plastic', 'metals', 'electronics_medical', 'electronics_it', 'batteries', 'organic_waste', 'batteries__on_market', 'residual_waste') and datanumbase is not null)

select temp.name,temp.fy_timerange,temp.types_of_waste, sum(temp.amt_kg) from temp
group by 1,2,3

--nvl