with Base1 as(select f.name as fy_timerange,count(*) as Number from profile_27395 p 
left join ds_mysql_prod_tagelement f on
p.fy=f.id group by f.name),Base2 as
(select f.name as fy_timerange,count(*) as Number from profile_27405 p
left join profile_27395 l on
p.ia=l._id
left join ds_mysql_prod_tagelement f
on p.fy=f.id group by f.name)
--select * from Base1 groupby name
select fy_timerange,Number,count(*) as Type from Base1 group by fy_timerange,Number
select * from Base1 set type=2 where fy_timerange<>NULL