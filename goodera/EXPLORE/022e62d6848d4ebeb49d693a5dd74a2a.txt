

--select  p1._id, p1.fy_timerange, p1.line_item, tag2.name as category, p1.budgeted_amount, tag1.name as projectId , p2.amount_utilized ,p2.date,
--p2.amount_utilized  as amount_utilized
--from profile_74913 p1
--left join profile_74914 as p2 on
--p2.line_item = p1._id
--left join ds_mysql_prod_project tag1
--on p1.projectId = tag1.id
--left join ds_mysql_prod_tagelement tag2
--on p1.category = tag2.id

select distinct p1._id, p1.fy_timerange, p1.line_item, p1.category, p1.budgeted_amount, p1.projectId,
first_value(p2.date) over (partition by p2.date)
from profile_74913 p1
left join profile_74914 p2
on p1._id = p2.line_item
group by 
p1._id, p1.fy_timerange, p1.line_item, p1.category, p1.budgeted_amount, p1.projectId, p2.date
order by p2.date desc







