
with t1 as 
(select fy_timerange, trainee_id, trainee_name, edu_qual, gender, occupation, fed_role, job_status, fam_income, pre_income,
case 
when income_12months > 0 then income_12months
when income_6months > 0 then income_6months
when income_3months > 0 then income_3months
end as final_income
from profile_76022)

select fy_timerange, trainee_id, trainee_name, edu_qual, gender, occupation, fed_role, job_status, fam_income, pre_income, final_income, (final_income - pre_income) as increase_income
from t1