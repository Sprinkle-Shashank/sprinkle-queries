with t1 as 
(select tag1.name as projectId, p1.name, tag2.name as gender, tag3.name as social_class, p1.fy_timerange, tag4.name as state_district, p1.village, tag5.name as stakeholders, tag6.name as case_registered, p1.remarks, count (*) as count
from profile_82924 p1
left join ds_mysql_prod_project tag1 
on p1.projectId = tag1.id
left join ds_mysql_prod_tagelement tag2
on p1.gender = tag2.id
left join ds_mysql_prod_tagelement tag3
on p1.social_class = tag3.id
left join ds_mysql_prod_tagelement tag4
on p1.state_district = tag4.id
left join ds_mysql_prod_tagelement tag5
on p1.stakeholders = tag5.id
left join ds_mysql_prod_tagelement tag6
on p1.case_registered = tag6.id
group by 
tag1.name, p1.name, tag2.name, p1.age, tag3.name, p1.fy_timerange, tag4.name, p1.village, tag5.name, tag6.name, p1.remarks),

temp as ( select 'gender' as c
		  union all 
		  select 'social_class' as c
		  union all
		  select 'state_district' as c
		  union all
		  select 'village' as c
		  union all
		  select 'stakeholders' as c
		  union all
		  select 'case_registered' as c
)

select projectId, fy_timerange, remarks, count,
case c 
when 'gender' then t1.gender
when 'social_class' then t1.social_class
when 'state_district' then t1.state_district
when 'village' then t1.village
when 'stakeholders' then t1.stakeholders
when 'case_registered' then t1.case_registered
end as val, temp.c as dim
from t1
cross join temp
group by projectId, fy_timerange, remarks, temp.c, t1.gender, t1.social_class, t1.state_district, t1.village, t1.stakeholders, t1.case_registered, count

		  





 

 
 
 




































