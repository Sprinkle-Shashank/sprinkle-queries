with table1 as 
( select p.projectid , p._id , sta.name as state_update , city , dis.name as district_update , num_ben , mat.name as material_dis_update , title_doc ,  the.name as theme_update , mon.name as month_update  ,   doc_hub ,  remark , ty.name as type_update ,  case when is_array(doc_hub) = false or get_array_length(doc_hub) = 0 then array(doc_hub)
else (doc_hub) end as doc_hub_update  from profile_83064 as p 

left join ds_mysql_prod_tagelement sta 
on p.state = sta.id
 
left join ds_mysql_prod_tagelement dis 
on p.dist = dis.id
 
left join ds_mysql_prod_tagelement mat 
on p.material_dis = mat.id

left join ds_mysql_prod_tagelement the 
on p.theme = the.id

left join ds_mysql_prod_tagelement mon 
on p.month = mon.id

left join ds_mysql_prod_tagelement ty 
on p.type = ty.id),

table2 as
( select * from table1 as p,p.doc_hub_update as d1 )

select * from table2


/*
CAST(data.fy_timerange as SUPER),
 CAST(data.state as INT),
 CAST(data.dist as INT),
 CAST(data.city as VARCHAR),
 CAST(data.num_ben as INT),
 CAST(data.material_dis as INT),
 CAST(data.type as INT),
 CAST(data.title_doc as VARCHAR),
 CAST(data.doc_hub as SUPER),
 CAST(data.theme as INT),
 CAST(data.month as INT),
 CAST(data.remark as VARCHAR),
 CAST(data.name as VARCHAR)
 
 */