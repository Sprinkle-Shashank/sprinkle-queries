select projectId as parent1, fy_timerange, twopc, overhead_expenses, setoff_amount, setoff_amount_preceeding, surplus_previousfy, actual_csr, unspent_account, impact_assessment, netprofit ,twopc+surplus_previousfy+setoff_amount as total_csr_obligation,actual_csr+overhead_expenses+impact_assessment as  total_amount_current , total_amount_current+twopc as excess_current ,excess_current+surplus_previousfy as setoff_succeed ,

case when excess_current<0 or excess_current=0 then 0
       
	   else excess_current
	   
	  end as new_excess_current,
case when setoff_succeed<0 or setoff_succeed=0 then 0
       
	   else setoff_succeed
	   
	  end as new_setoff_succeed	  
	  

from profile_78824

group by parent1, fy_timerange, netprofit, twopc, overhead_expenses, setoff_amount, setoff_amount_preceeding, surplus_previousfy, actual_csr, unspent_account, impact_assessment, total_csr_obligation, total_amount_current, new_excess_current, new_setoff_succeed

