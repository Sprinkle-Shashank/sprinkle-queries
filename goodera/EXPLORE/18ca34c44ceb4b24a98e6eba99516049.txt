with s as(
Select  start_date, end_date, cycle_name, 
(start_date || '|' ||end_date) as fy_timerange,
case
  when (extract(month from end_date) <=2) then ('FY' || (extract(year from end_date)-2000))
  when (extract(month from end_date) >2) then ('FY'|| (extract(year from end_date)+1-2000))
  end as FY,
  case 
   when cycle_name like '%Financial%' then 'FY'
   else 'Region'
   end as Type
from profile_75412

)

Select *, 
''
as "Financial tooltip",
 case
	when type='FY' then start_date 
	else null
	end as Financial_start_date,
	
case
	when type='FY' then end_date 
	else null
	end as Financial_end_date,
	case
	when type='Region' then start_date 
	else start_date
	end as Region_start_date,
	case
	when type='FY' then end_date 
	else start_date
	end as Region_end_date
	

from s

