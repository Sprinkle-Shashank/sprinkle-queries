 with temp as (
   select 'cash_disbursed' as col
   union all
   select 'products_disbursedfmv' as col
   union all
   select 'Total_Funds_Disbursed' as col
   union all
   select 'products_disbursed_cogs' as col
  )

SELECT sq.time_period_timerange as fy_timerange, pd.projectId as Region, pd.partner_name as Partner_name, pd.fy as FY,nvl(sq.cash_disbursed,0)+nvl(sq.products_disbursed_cogs,0) as total_f,
case
	when sq.month=1059437 then 'Q1'
	when sq.month=1059438 then 'Q1'
	when sq.month=1059439 then 'Q1'
	when sq.month=1059440 then 'Q2'
	when sq.month=1059441 then 'Q2'
	when sq.month=1059442 then 'Q2'
	when sq.month=1059443 then 'Q3'
	when sq.month=1059444 then 'Q3'
	when sq.month=1059445 then 'Q3'
	when sq.month=1059446 then 'Q4'
	when sq.month=1059447 then 'Q4'
	when sq.month=1059448 then 'Q4'
	end as Quarter,  temp.col as Dimensions,
	 sum(case col
  when 'cash_disbursed' then sq.cash_disbursed
  when 'products_disbursedfmv' then sq.products_disbursedfmv
  when 'Total_Funds_Disbursed' then total_f
  when 'products_disbursed_cogs' then sq.products_disbursed_cogs 
   else NULL
   end) as Values
FROM dell_profile_063523 sq
CROSS JOIN temp
LEFT JOIN dell_profile_63522 pd
ON pd._id=sq.partner_reference
GROUP BY sq.time_period_timerange, pd.projectId, pd.partner_name, pd.FY, Quarter, Dimensions,sq.month,sq.year, sq.partner_reference, sq.cash_disbursed, sq.products_disbursed_cogs, sq.products_disbursedfmv, sq.services_provided_cogs

