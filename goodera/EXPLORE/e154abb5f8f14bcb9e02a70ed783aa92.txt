with table1 as 
(select p._id,p.projectId

,cast(concat('FY ' ,start_year) as varchar) as start_year ,case when start_quarter=1 then '1st (Feb-Apr)'
 when start_quarter=2 then '2nd (May-Jul)'
  when start_quarter=3 then '3rd (Aug-Oct)'
   when start_quarter=4 then '4th (Nov-Jan)'
   else null end as start_quarter,  num_females,num_females_graduated,
   p2.name_vendor , p2.name_country , lg_status , select_modules
   from profile_4227 p 
   
   LEFT JOIN
   profile_54646 p2 ON
   p.projectid = p2.projectid
   WHERE p2.name_vendor is not NULL and
   p2.name_country is not NULL
   AND coalesce(lg_status, 0) <> 848008
   
  ) ,
  table2 as (select tab1.*,cast(c as int) from table1 as tab1, tab1.select_modules c),
  
  table3 as ( select tab2.projectid,start_quarter start_year,  num_females, num_females_graduated, name_vendor,name_country,tab2.c as select_modules from table2 as tab2
   )
   select * from table3
  
   
   
   
--  AND lg_status <> 848008  --or lg_status is not null
   