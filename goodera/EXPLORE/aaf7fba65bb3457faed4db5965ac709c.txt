with table1 as(select p.projectId as project,p.photo as photo from profile_16619 p
			  group by p.projectId,p.photo),
table2 as(select p.projectId as project,p.photo_2 as photo from profile_16619 p
		 group by p.projectId,p.photo_2),
table3 as(select p.projectId as project,p.pic as photo from profile_16619 p
		 group by p.projectId,p.pic),
table4 as(select p.projectId as project,p.pic_2 as photo from profile_16619 p
		 group by p.projectId,p.pic_2),
table5 as(select p.projectId as project,p.pic_3 as photo from profile_16619 p
		 group by p.projectId,p.pic_3),
table6 as(select p.projectId as project,p.pic_4 as photo from profile_16619 p
		 group by p.projectId,p.pic_4),
table7 as(select p.projectId as project,p.pic_5 as photo from profile_16619 p
		 group by p.projectId,p.pic_5),
table8 as(select p.projectId as project,p.pic_6 as photo from profile_16619 p
		 group by p.projectId,p.pic_6),
table9 as(select p.projectId as project,p.pic_7 as photo from profile_16619 p
		 group by p.projectId,p.pic_7),

table10 as(select p.projectId as project,p.pic_8 as photo from profile_16619 p
		  group by p.projectId,p.pic_8),

table11 as(select p.projectId as project,p.pic_9 as photo from profile_16619 p
		  group by p.projectId,p.pic_9),

table12 as(select p.projectId as project,p.pic_10 as photo from profile_16619 p
		  group by p.projectId,p.pic_10),

table13 as(select p.projectId as project,p.pic_11 as photo from profile_16619 p
		  group by p.projectId,p.pic_11),

table14 as(select p.projectId as project,p.pic_12 as photo from profile_16619 p
		  group by p.projectId,p.pic_12),

table15 as(select p.projectId as project,p.pic_13 as photo from profile_16619 p
		  group by p.projectId,p.pic_13),

table16 as(select p.projectId as project,p.pic_14 as photo from profile_16619 p
		  group by p.projectId,p.pic_14),

table17 as(select p.projectId as project,p.pic_15 as photo from profile_16619 p
		  group by p.projectId,p.pic_15),

table18 as(select p.projectId as project,p.pic_16 as photo from profile_16619 p
		  group by p.projectId,p.pic_16),
table19 as(select * from table1 
		   union all
		   select * from table2
		   union all
		   select * from table3
		   union all
		   select * from table4
		   union all
		   select * from table5
		   union all
		   select * from table6
		   union all
		   select * from table7
		   union all
		   select * from table8
		   union all
		   select * from table9
		   union all
		   select * from table10
		   union all
		   select * from table11
		   union all
		   select * from table12
		   union all
		   select * from table13
		   union all
		   select * from table14
		   union all
		   select * from table15
		   union all
		   select * from table16
		   union all
		   select * from table17
		   union all
		   select * from table18

		   ),table20 as(
select p.projectId as project,fac.name as factory,ven.name as vendor1,nvl2(SUBSTRING(vendor1, 1, POSITION(' (' in vendor1)), SUBSTRING(vendor1, 1, POSITION(' (' in vendor1)), vendor1) as vendor_name, case when vendor_name='' then vendor1 else vendor_name end as vendor,case when vendor_name='' then vendor1 else vendor_name end as vendor,cou.name as country,case when country in ('India', 'Bangladesh', 'Sri Lanka')
then 'South Asia'
when country in ('China')
then 'North Asia'
when country in ('Guatemala', 'El Salvador', 'Dominican Republic')
then 'Americas'
when country in ('Philippines', 'Cambodia',  'Vietnam',  'Indonesia', 'Myanmar')
then 'South East Asia'
end as region,p.name_subunit as unit,DATEPART(YEAR,p.date_enrollment) as year_new,p.status,t19.photo from profile_16619 p


		  
left join ds_mysql_prod_project fac
on p.projectid = fac.id
left join ds_mysql_prod_project ven
on fac.parent = ven.id
left join ds_mysql_prod_project cou
on ven.parent = cou.id


left join table19 t19 on
p.projectId = t19.project

			
where (cou.name <> 'Test Country' and cou.name <> 'GAP Inc.') and (p.status = 1400365 or p.status is null) and (project ilike '%%')
			
group by project,fac.name,cou.name,ven.name,vendor,region,year_new,p.name_subunit,p.status,t19.photo
)
select * from table20
