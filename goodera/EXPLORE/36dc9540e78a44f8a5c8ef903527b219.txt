with sub1 as(
select t.name as CR_Rating_Text, sq.name, sq.factory_name, sq.source_div, sq.brands, sq.cr_tier, sq.facility_type, sq.pre_cr_rating, sq.curr_cr_rating, sq.timeperiod_timerange, sq.region_parent as region, sq.factory_id from profile_60928 sq
left join ds_mysql_prod_tagelement t
on t.id=sq.curr_cr_rating
where (COALESCE(sq.cr_tier, 0) not in (957760,957759) and t.name is NOT NULL),
sub2 as
(
  SELECT source, s1.* from sub1 s1, s1.source_div source)
  
  select * from sub1