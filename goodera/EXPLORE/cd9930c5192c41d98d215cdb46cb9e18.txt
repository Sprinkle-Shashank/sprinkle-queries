with table1 as 
( select  p._id, proj.name as projectid , fy_timerange, date, registration_certificate, memo_association, bod, sec_12aa, registration_80g, pan, annual_report, csr1_form, remarks, ngo, mou, uc, quarterly_report, certificate_197, goodera_due_diligence__report, goodera_dd , pan  
 
 
, case when is_array(registration_certificate) = false or get_array_length(registration_certificate) = 0 then array(registration_certificate)
else (registration_certificate) end as registration_certificate_doc  
 
, case when is_array(memo_association) = false or get_array_length(memo_association) = 0 then array(memo_association)
else (memo_association) end as memo_association_doc 
 
, case when is_array(memo_association) = false or get_array_length(memo_association) = 0 then array(memo_association)
else (memo_association) end as memo_association_doc 
 
, case when is_array(sec_12aa) = false or get_array_length(sec_12aa) = 0 then array(sec_12aa)
else (sec_12aa) end as sec_12aa_doc
 
, case when is_array(bod) = false or get_array_length(bod) = 0 then array(bod)
else (bod) end as bod_doc
 
, case when is_array(registration_80g) = false or get_array_length(registration_80g) = 0 then array(registration_80g)
else (registration_80g) end as registration_80g_doc
 
, case when is_array(annual_report) = false or get_array_length(annual_report) = 0 then array(annual_report)
else (annual_report) end as annual_report_doc
 
 , case when is_array(certificate_197) = false or get_array_length(certificate_197) = 0 then array(certificate_197)
else (certificate_197) end as certificate_197_doc

 , case when is_array(csr1_form) = false or get_array_length(csr1_form) = 0 then array(csr1_form)
else (csr1_form) end as csr1_form_doc
 
 , case when is_array(goodera_due_diligence__report) = false or get_array_length(goodera_due_diligence__report) = 0 then array(goodera_due_diligence__report)
else (goodera_due_diligence__report) end as goodera_due_diligence__report_doc 

/* , case when is_array(mou) = false or get_array_length(mou) = 0 then array(mou)
else (mou) end as mou_doc 

 , case when is_array(uc) = false or get_array_length(uc) = 0 then array(uc)
else (uc) end as uc_doc
 
 , case when is_array(quarterly_report) = false or get_array_length(quarterly_report) = 0 then array(quarterly_report)
else (quarterly_report) end as quarterly_report_doc 
 
 , case when is_array(goodera_dd) = false or get_array_length(goodera_dd) = 0 then array(goodera_dd)
else (goodera_dd) end as goodera_dd_doc 
 
 
 from profile_77463 as p
  
left join ds_mysql_prod_project proj
on p.projectid = proj.id
 )
 
 select * from table1 