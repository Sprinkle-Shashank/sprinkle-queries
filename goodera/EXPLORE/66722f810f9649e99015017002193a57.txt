with table1 as 
( select p.projectid , p._id , fy_timerange , dis.name as district_update , sta.name as state_update , date_camp from profile_83195 as p
 
left join ds_mysql_prod_tagelement dis
on p.state_name = dis.id

left join ds_mysql_prod_tagelement sta
on dis.parent = sta.id
 
 where date_camp is not null
 )
 
 select * from table1