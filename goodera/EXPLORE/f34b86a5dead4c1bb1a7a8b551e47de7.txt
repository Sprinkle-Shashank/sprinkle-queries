with table1 as
(
  select createddate, projectId, cast(name as VARCHAR) as bene_name, mobilization_activity, state,
  
  case when month=1 or month=2 or month=3 
       then concat('FY ',concat(year-1,concat(' - ',substring(year,3,2))))
       else concat('FY ',concat(year,concat(' - ',substring(year+1,3,2))))  
  end as name_updated,
  
  extract(month FROM(createddate)) as month_up,
  extract(year FROM(createddate)) as year_up
  
  from Profile_30527 as p
  
  ),
  
  table2 as 
  (
	select projectId, mobilization_activity, state, name_updated, count(*) as count_up from table1
	
	group by projectId, mobilization_activity, state, name_updated
	)
	
	select projectId, mobilization_activity, state, name_updated, count_up from table2
  
  
  