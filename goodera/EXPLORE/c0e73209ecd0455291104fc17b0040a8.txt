with sub1 as(
select projectId, name, background, date_of_admission as fy_timerange, fg_learner, age, class,count(*) from profile_52387 group by projectId, name, background, fg_learner, age, class, date_of_admission)
select a.projectId, a.name, a.background, a.fg_learner, a.age, t.name as class, fy_timerange, count,
case when class=836952 then 1 else
( case when class=836953 then 2 else
 ( case when class=836954 then 3 else
  ( case when class=836955 then 4 else
   ( case when class=836956 then 5 else
	( case when class=836957 then 6 else
	 ( case when class=836958 then 7 else
	  ( case when class=836959 then 8 else
	   ( case when class=836960 then 9 else
		( case when class=836961 then 10 else
		 ( case when class=836962 then 11 else
		  ( case when class=836963 then 12 else 13 end) end) end) end) end) end) end) end) end) end) end) end as class_rank from sub1 a
		  left join ds_mysql_prod_tagelement t on t.id=a.class
		  order by class_rank asc
