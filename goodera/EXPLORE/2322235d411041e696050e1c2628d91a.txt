with table1 as (
select projectid, csr_spend_type, fy_timerange, amount_allocated  from profile_79520
  
  where csr_spend_type = 1682417
), table2 as ( select table1.projectid, table1.csr_spend_type, table1.fy_timerange, amount_allocated, fa.name as focus_area from table1

left join profile_79500 on
table1.projectid =profile_79500.projectid


left join ds_mysql_prod_tagelement fa 
on json_extract_array_element_text(json_serialize(profile_79500.focus_area),0) = fa.id),

table3 as (
select projectid, csr_spend_type, fy_timerange, amount_allocated  from profile_79520
  
  where csr_spend_type <> 1682417
), table4 as ( select table3.projectid, table3.csr_spend_type, table3.fy_timerange, amount_allocated, fa.name as focus_area from table3

left join profile_80249 on
table3.projectid =profile_80249.projectid


left join ds_mysql_prod_tagelement fa 
on json_extract_array_element_text(json_serialize(profile_80249.focus_area),0, true) = fa.id)

select projectid, csr_spend_type,fy_timerange, amount_allocated, focus_area from table2
union 
select projectid, csr_spend_type,fy_timerange, amount_allocated, focus_area from table4
order by projectid, csr_spend_type,fy_timerange, amount_allocated, focus_area


