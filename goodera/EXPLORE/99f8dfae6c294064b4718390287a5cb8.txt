with table1 as (select
					case when lg_status != 848008 then 1 else 0 end as status,
				substring(table_54646.projcode_factory,1,1) as code,
				reverse(SPLIT_PART(reverse(table_54646.projcode_factory), '-',1)) as code_brand,
				case when code = 'F' then 1 else 0 end as codeStatus
	

				from profile_4227 p
inner join profile_54646 table_54646 on
table_54646.projectId = p.projectId
)
Select * from table1 p where status = 1 and codeStatus = 1