with sub1 as(select p2.name as projectid,p1.year_timerange,count(p1.car_type) as cars,
case
	when car_type=1428696 then 'Diesel'
	when car_type=1428697 then 'Electric'
	when car_type=1428698 then 'Hybrid'
	else 'Fuel'
end as nm

from profile_73046 p1
left join profile_74147 p2 on p2._id=p1.name_location
group by 1,2,4)

select projectid,Timerange,sum(cars) as num_cars,nm as fuel_type