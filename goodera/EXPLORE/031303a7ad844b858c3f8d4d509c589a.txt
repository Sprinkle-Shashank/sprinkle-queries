
with sub1  as (Select name_rp,name_vendor,projcode_rp,name_factory,projcode_factory from profile_54646 p

),
sub2 as(
  select name_rp as regional_partner from sub1 s1
  where projcode_rp LIKE 'N%'
),
sub3 as(
  Select name_factory as locations from sub1 s1
  where projcode_factory LIKE 'CP%'
)
Select name_vendor as vendor,s1.name_rp,s1.name_factory from profile_54646 p)

