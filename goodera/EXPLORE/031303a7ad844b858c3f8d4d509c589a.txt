
with table1 as(Select * from profile_54646),
table2 as(Select name_rp as regional_partner 

from table1 t1
where projcode_rp LIKE 'N%'
),
table3 as(Select name_factory as locations 
from table1 t1
where projcode_factory LIKE 'CP%'
)
Select t1.name_vendor,table2.name_rp,table3.name_factory from table1 t1

