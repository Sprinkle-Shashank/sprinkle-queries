with t1 as 
(select  p1.fy_timerange, tag2.name as plac_status , p2.batch_id, tag1.name as gender, batch_end,GETDATE() as today ,tag2.name  as placed,batch_end as end,
case
when placed is null then 'Empty'
else tag2.name 
end as placed
from profile_76123 p1
left join profile_76122 p2 on
p1.batchid = p2._id
left join ds_mysql_prod_tagelement as tag1 on
p1.gender = tag1.id
left join ds_mysql_prod_tagelement as tag2 on
p1.plac_status = tag2.id)

select t1.fy_timerange,batch_id end,gender,today,placed,
case
when today < end then  'Undergoing training'
--when placed = empty  and today > end then Trained 
else placed
end as  trainee_status
from t1
