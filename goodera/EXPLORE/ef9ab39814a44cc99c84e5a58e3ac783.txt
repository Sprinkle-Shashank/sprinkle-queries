select p1.fy_timerange, p1.country, p1.cdms_id as pvh_id, p1.num_females, p2.region, p2.source_div, 

case
  when extract(month from cast(p1.fy_timerange.start as date)) = 1
  		then extract(year from cast(p1.fy_timerange.start as date)) - 1
  else extract(year from cast(p1.fy_timerange.start as date))
end as year,
case
  	when is_array(p2.brands) = false or get_array_length(p3.brands) = 0 then array(p2.brands)
  	else p2.brands
end as brands_new

from profile_62972 p1
left join profile_60928 p2 on p2.factory_id = p1.cdms_id