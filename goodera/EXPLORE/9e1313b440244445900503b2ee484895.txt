with table1 as (
select p1.name as projectid, financial_year, last_yr_spend, last_yr_status, vision, current_csr_spend, csr_spend, projects, company_logo, ba_ppt, address, locations, fy_timerange, csr_manager, date, csr_mgr_email, wesbite, description, cast (sdgs as varchar),
case when is_array(sdgs)= false or get_array_length(sdgs)=0 then array(sdgs)
  else sdgs
end as photo
from profile_44750
left join ds_mysql_prod_project p1 on p1.id = projectid
),

table2 as ( 
select * from table1 t1, t1.photo sdg_logo)

select LISTAGG( DISTINCT s2.sdg_logo, ', ' ) as sdg_logos from table2 s2
  
/*select * from profile_44750*/