select proj.name as projectId,age,
case when age<18 then '<18'
     when age >= 18 and age<=25 then '18-25'
	 else '>25'
reg_no,trainee_name,date_of_reg,gend.name as gender,occupation.name as occupation,fam_income,date_of_placement,emp_name, 
placement.name as placement_status,
case when placement_status is null then 'Under Trainig'
     else placement_status
	 end as new_placement_status,
qualific.name as edu_qual, disab.name as type_of_dis, fy_timerange, salary,

/*case when placement_status = 'Placed' then 1
     else 0
     end as Placed,
case when placement_status = 'Dropout (during training)' then 1
     else 0
     end as "Dropout(during training)",
case when placement_status = 'Dropout (post-training)' then 1
     else 0
     end as "Dropout(post-training)",
case when placement_status = 'Under Age' then 1
     else 0
     end as "Under Age",	 
case when placement_status = 'Self Employed' then 1
     else 0
     end as "Self Employed" */

sum(case when placement_status = 'Placed' then 1
    
     when placement_status = 'Dropout (during training)' then 1
     
     when placement_status = 'Dropout (post-training)' then 1
     
     when placement_status = 'Under Age' then 1
     	 
	 when placement_status = 'Self Employed' then 1
     else 0
	 end )as fin_value,
	 
case when reg_no is not null then 1
     else 0
	 end as count


from profile_78667 p

left join ds_mysql_prod_project proj
	on p.projectid= proj.id
left join ds_mysql_prod_tagelement gend
	on p.gender= gend.id	
left join ds_mysql_prod_tagelement occupation
	on p.occu= occupation.id	
left join ds_mysql_prod_tagelement placement
	on p.placed= placement.id	
left join ds_mysql_prod_tagelement qualific
	on p.edu_qual= qualific.id
left join ds_mysql_prod_tagelement disab
	on p.type_of_dis= disab.id
	
group by proj.name,age,reg_no,trainee_name,date_of_reg,gend.name,occupation.name ,fam_income,date_of_placement,emp_name, placement.name, qualific.name, disab.name , fy_timerange, salary,p.placed 	
		