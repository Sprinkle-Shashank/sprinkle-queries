select english_score_mid, english_score_end, maths_score_mid, maths_score_end, kannada_score_mid, kannada_score_end, fy1_timerange, fy2_timerange, t.name as batch1, t1.name as batch2, coalesce(fy1_timerange, fy2_timerange) as fy_timerange
,case when LENGTH(SUBSTRING(cast(fy2_timerange as date),1,10))>1 then 'Mid-Term Score'
else 'End_term Score' end as term

from profile_80165
left join ds_mysql_prod_tagelement t 
on t.id=batch1
left join ds_mysql_prod_tagelement t1
on t1.id=batch2