--select p.*, s from profile_78057 p, p.other_brand s left join profile_78062 t on t._id = s

--with table1 as (
  select  p.projectid as project, p._id as parent_id, p.fy_timerange, p.country,               p.activity, p.activity_description, p.partner, p.business_units, p.focus_area, p.currency,   p.brand_of_prods_donated as prod_brand, p.product_description as prod_desc,                 p.no_of_reckitt_prods_donated, p.sequence, multi_brands, extract(month from p.fy_timerange.start)
  from profile_78057 p, p.other_brand multi_brands
  
/*table2 as (
  select t3.name as project_name, t2.name as brand, prod_desc, no_of_reckitt_prods_donated,   multi_brands, sequence, t4.name as prod_brand, t.product_description, t.reckitt_kits, 	   concat('brand',row_number() over (partition by sequence order by t4.name asc)) as           brand_sequence
  from table1 
	left join profile_78062 t on multi_brands = t._id
	left join ds_mysql_prod_tagelement t2 on prod_brand = t2.id
	left join ds_mysql_prod_project t3 on project = t3.id
	left join ds_mysql_prod_tagelement t4 on t.product_brand = t4.id)
	
select brand, sequence,
	max(case
			when brand_sequence = 'brand1' then prod_brand
			else NULL
		end) as brand1_prod_brand,
	max(case
			when brand_sequence = 'brand1' then product_description
			else NULL
		end) as brand1_prod_desc,
	max(case
			when brand_sequence = 'brand1' then reckitt_kits
			else NULL
		end) as brand1_reckitt_kits,
	max(case
			when brand_sequence = 'brand2' then prod_brand
			else NULL
		end) as brand1_prod_brand,
	max(case
			when brand_sequence = 'brand2' then product_description
			else NULL
		end) as brand2_prod_desc,
	max(case
		 	when brand_sequence = 'brand2' then reckitt_kits
			else NULL
		end) as brand2_reckitt_kits
from table2 group by brand, sequence*/
	





  
  