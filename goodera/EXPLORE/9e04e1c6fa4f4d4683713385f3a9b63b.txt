with sub1 as (select p1.name as projectid,p1.fy_timerange as Timerange


from sus_62370 p1
where keyword in ('elec_cars','hybrid_cars','diesel_cars','petrol_cars') and datanumbase is not null
 
group by 1,2),

sub2 as (select projectid, Timerange,
case
	when p1.elec_cars then 'Electric'
	when p1.hybrid_cars then 'Hybrid'
	when p1.diesel_cars then 'Diesel'
	when p1.petrol_cars then 'Petrol'
	else null
end as engine_type

from sub1
group by 1,2)

select projectid,Timerange,sum(engine_type) as num_cars from sub2
group by 1,2  
  
  