with sub1 as (select p1.name as projectid,p1.fy_timerange as Timerange,
sum(
  case
  when keyword='elec_cars' then datanumbase
  else 0
  end) as elec_cars,
 sum(
  case
  when keyword ='hybrid_cars' then datanumbase 
  else 0
  end) as hybrid_cars,
  sum(
  case
  when keyword ='diesel_cars' then datanumbase 
  else 0
  end) as diesel_cars,
  sum(
  case
  when keyword ='petrol_cars' then datanumbase 
  else 0
  end) as petrol_cars
			  
			  

  
from sus_62370 p1
where p1.keyword in ('elec_cars','hybrid_cars','diesel_cars','petrol_cars') and p1.datanumbase is not null
 
group by 1,2)

select projectid, Timerange,Electric+Hybrid+Diesel+Petrol as num_cars from sub1
group by 1,2
  
  
  
  
  