Select * from sus_56551 where keyword='cdp_cc_c6_5_scope_3_emissions_data'


/* With x as(select name as projectid, financialperiod,fy_timerange,datatablebase from sus_56551 where keyword='cdp_cc_c6_5_scope_3_emissions_data'),
		  temp2 as
		  (select *, temp1.gri_scope_3_inbound_logistics, temp1.gri_scope_3_outbound_logistics, temp1.gri_scope_3_business_travel
		    from x as temp, unpivot temp.datatablebase as temp1 at row),
  
  
  temp3 as (
  select 'Inbound Logistics' as col
  Union all select 'Outbound Logistics' as col
  Union all select 'Business Travel' as col) 

  
select projectid ,t1.name as financialperiod,fy_timerange,


sum(case temp3.col
   when 'Inbound Logistics' then temp2.gri_scope_3_inbound_logistics
   when 'Outbound Logistics' then temp2.gri_scope_3_outbound_logistics
   when 'Business Travel' then temp2.gri_scope_3_business_travel 
   
   else null
   end) as emission,
   
  
   temp3.col as dimension,



CASE split_part(fy_timerange,'-',2)
	  
WHEN '01' THEN 'Jan'
WHEN '02' THEN 'Feb'
WHEN '03' THEN 'Mar'
WHEN '04' THEN 'Apr'
WHEN '05' THEN 'May'
WHEN '06' THEN 'Jun'
WHEN '07' THEN 'Jul'
WHEN '08' THEN 'Aug'
WHEN '09' THEN 'Sep'
WHEN '10' THEN 'Oct'
WHEN '11' THEN 'Nov'

 Else 'Dec'
end as Month,
split_part(fy_timerange,'-',2) as year,
		   


 Case Concat('FY ',split_part(t1.name,' ',2)) 
 when 'FY 2019-20' then 'FY (2019-20)'
 when 'FY 2020-21' then 'FY (2020-21)'
 when 'FY 2021-22' then 'FY (2021-22)'
 else Concat('FY ',split_part(t1.name,' ',2))
 end 
 
 as financial_year

from temp2  


left join ds_mysql_prod_tagelement t1 on t1.id = financialperiod
cross join temp3


where datatablebase is not null

		   
group by t1.name,projectid,fy_timerange, year, financial_year,month,dimension*/