select projectid.name as projectid, fy_timerange, sum(schools_reached) as sum_schools_reached 
from profile_83513 as p

left join ds_mysql_prod_project projectid
on p.projectid = projectid.id

group by projectid, fy_timerange


/*
select projectid.name as projectid, fy_timerange, num_students_pre_primary, num_students_primary, num_students_secondary, num_students_senior_secondary, num_students_pre_primary + num_students_primary + num_students_secondary + num_students_senior_secondary as total_num_students
from profile_83513 as p
left join ds_mysql_prod_project projectid
on p.projectid = projectid.id

with t1 as
(
  select * from
  (
  select projectid, num_students_pre_primary, students_enrolled_pre_intervention, fy_timerange, num_students_primary, students_enrolled_post_intervention, schools_reached, num_students_secondary, cities_reached, num_students_senior_secondary, num_smart_classes, hours_invested_class1, teachers_num, hours_invested_class2, students_enrolled, hours_invested_students, hours_invested_teachers, hours_invested_class3, hours_invested_class4, hours_invested_class5, hours_invested_class6, hours_invested_class7, hours_invested_class8, hours_invested_class9, hours_invested_class10, hours_invested_class11, hours_invested_class12, num_boys, num_girls
  from profile_83513 as p
  
  left join ds_mysql_prod_project as projectid
 on p.projectid = projectid.id
  )
  UNPIVOT (
   Val FOR Dim IN(num_students_pre_primary, students_enrolled_pre_intervention, num_students_primary, students_enrolled_post_intervention, schools_reached, num_students_secondary,
  cities_reached, num_students_senior_secondary, num_smart_classes, hours_invested_class1, teachers_num,
  hours_invested_class2, students_enrolled, hours_invested_students, hours_invested_teachers, hours_invested_class3, hours_invested_class4, hours_invested_class5, hours_invested_class6, hours_invested_class7, hours_invested_class8, hours_invested_class9, hours_invested_class10, hours_invested_class11, hours_invested_class12, num_boys, num_girls))),
   
   t2 as 
   (
	 select projectid, fy_timerange, sum(Val) as val_sum, Dim from t1
	 group by projectid, fy_timerange, Dim
	 )
  select * from t2*/