
with table1 as
(
  select p.projectid , pace.name as pace_status , row_number() over 
(partition by  p.projectid
 order by p._id desc) as row from profile_54267 as p
  
left join ds_mysql_prod_tagelement pace
on p.pace_status = pace.id
    
  where row=1
  )

, table2 as
(
 select * from table1 
)

select * from table2

/*
select p.projectid ,      

case when sourcing_yn=57472 then cast(factory_vpid_1 as varchar)
when sourcing_yn=57473 then cast(factory_vpid_2 as varchar) end as factory_id

from profile_52713 as p
*/
