with s1 as(
Select projectId, course_name, fy_timerange
from profile_66535
union
Select projectId, t1.name as nptel_courses, timerange_timerange
from profile_63517 q
  left join ds_mysql_prod_tagelement t1
  ON t1.id=q.discipline
union
Select projectId, t1.name as stp_courses, fy_timerange
from profile_65049 q
  left join ds_mysql_prod_tagelement t1
  ON t1.id=q.course
  )
Select * ,

case when (case when course_name is NULL then nptel_courses else course_name end) is NULL then stp_courses else (case when course_name is NULL then nptel_courses else course_name end) 
end as courses

from s1
WHERE Courses != 'None'
GROUP BY 1,2,3