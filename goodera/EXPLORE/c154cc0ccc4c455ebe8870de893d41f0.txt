with s1 as(
Select projectId, course_name, fy_timerange
from profile_66535
union all
Select projectId, discipline, timerange_timerange
from profile_63517
union all
Select projectId, course, fy_timerange
from profile_65049
  )
Select * ,

case when (case when course_name is NULL then nptel_courses else course_name end) is NULL then stp_courses else (case when course_name is NULL then nptel_courses else course_name end) 
end as courses

from s1
WHERE Courses != 'None'
GROUP BY 1,2,3