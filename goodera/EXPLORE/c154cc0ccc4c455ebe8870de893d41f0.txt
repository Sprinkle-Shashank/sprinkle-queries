

with s1 as(
Select sdg_logo, fy_timerange
from profile_79656 a,a.sdg sdg_logo
)

Select t4.name sdg_name, DISTINCT(sdg_icon) as sdg_icon, p1.name as projectid, s1.fy_timerange
from s1
left join profile_79655 p
ON p._id=s1.sdg_logo
left join ds_mysql_prod_project p1
ON p1.id=p.projectid
left join ds_mysql_prod_tagelement t4
ON t4.id=p.sdg_name
GROUP BY 1,2,3, p.sdg_name, 4
Order by p.sdg_name