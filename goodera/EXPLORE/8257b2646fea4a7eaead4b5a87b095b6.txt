with table1 as(Select p.projectId,cast(concat('FY ' ,start_year) as varchar) as start_year ,case when start_quarter=1 then '1st (Feb-Apr)'
 when start_quarter=2 then '2nd (May-Jul)'
  when start_quarter=3 then '3rd (Aug-Oct)'
   when start_quarter=4 then '4th (Nov-Jan)'
   else null end as start_quarter,mdl_parent.name as module,md_nme.name as module1,profile_54646.name_vendor_filter as vendor,profile_54646.name_country as country,fac.name as factory,select_modules,cls_time from profile_4227 p



left join profile_54646  on 
p.projectId= profile_54646.projectId

left join ds_mysql_prod_tagelement md_nme
on p.module_name = md_nme.id

left join ds_mysql_prod_tagelement mdl_parent
on md_nme.parent = mdl_parent.id



left join ds_mysql_prod_project fac
on p.projectId = fac.id


where  vendor is not null and country is not null and end_date_2 is  null and pr_27.projectId like '%%'


 and module in ('Workplace Program')
),
			   
table2 as (select t1.*,CAST(time as int) from table1 t1,t1.cls_time time	

),
table3 as(SELECT tm.name as time,t1.projectId,cls_time,start_year,start_quarter,country,vendor,module,module1,factory from table2 t2
LEFT JOIN ds_mysql_prod_tagelement tm on
t2.time = tm.id
)

Select start_year,start_quarter,cls_time,country,vendor,module,module1,factory,time from table3
group by start_year,start_quarter,cls_time,country,vendor,module,module1,factory,time
