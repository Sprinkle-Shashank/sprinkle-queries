with temp1 as
(select m.month, m.month_timerange as fy_timerange, m.project_code_new, m.amount, r.vertical, focus.name as focus, r._id, q.budget
 
 from profile_55194 as m 
 
 left join profile_62881 as r 
 on m.project_code_new = r._id
 
 left join ds_mysql_prod_tagelement as focus
 on r.focus = focus.id
 
 left join profile_63895 as q 
 on r.vertical = q.vertical

where m.month_timerange IS NOT NULL),
 
 
 temp2 as
 (select month, fy_timerange, project_code_new, amount, vertical, _id, budget, CAST(fy_timerange.start as date) as month_1, vertical_new
  
 case when m.focus IS NULL THEN 'Admin'
 else m.focus
 end as focus
 from temp1 as m, m.vertical vertical_new),
 
 temp3 as
 (select month, fy_timerange, project_code_new, amount, vertical, _id, budget, month_1, CAST(EXTRACT(month from month_1) AS INT) as month_2, 
  
  case when month_1 = 1 then 'Q1'
when month_1 = 2 then 'Q1'
when month_1 = 3 then 'Q1'
when month_1 = 4 then 'Q2'
when month_1 = 5 then 'Q2'
when month_1 = 6 then 'Q2'
when month_1 = 7 then 'Q3'
when month_1 = 8 then 'Q3'
when month_1 = 9 then 'Q3'
when month_1 = 10 then 'Q4'
when month_1 = 11 then 'Q4'
when month_1 = 12 then 'Q4'
else NULL
END AS quarter