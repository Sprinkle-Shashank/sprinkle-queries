with table1 as (Select t.name as projectid, fy_timerange, extract(year from cast(startdate as DATETIME)) as year,  Sum(CASE 
             WHEN keyword = 'non_renewable_fuel_consumed_petrol' THEN datanumBase
             ELSE 0 
           END) AS fuel_petrol,
 Sum(CASE 
             WHEN keyword = 'non_renewable_fuel_consumed_diesel' THEN datanumBase
             ELSE 0 
           END) AS fuel_diesel,
 Sum(CASE 
             WHEN keyword = 'non_renewable_fuel_consumed_cng' THEN datanumBase
             ELSE 0 
           END) AS fuel_cng,
 Sum(CASE 
             WHEN keyword = 'non_renewable_fuel_consumed_png' THEN datanumBase
             ELSE 0 
           END) AS fuel_png,
 Sum(CASE 
             WHEN keyword = 'non_renewable_fuel_consumed_lpg' THEN datanumBase
             ELSE 0 
           END) AS fuel_lpg
 
 
from sus_79029

left join ds_mysql_prod_project t
on xprojectid=t.id

where keyword in ('non_renewable_fuel_consumed_petrol','non_renewable_fuel_consumed_cng','non_renewable_fuel_consumed_lpg','non_renewable_fuel_consumed_png','non_renewable_fuel_consumed_diesel')

group by t.name, fy_timerange, year ),
energy_conversion as (
	select fy_timerange, es.name as energy_source, conversion_factor from profile_80408
  
  left join ds_mysql_prod_tagelement es
on profile_80408.energy_source = es.id
  

),
petrol0 as (
	select projectid, fuel_petrol, case when projectid is not null then 'Petrol' end as energy_source from table1
  
),petrol as (
	select projectid, fuel_petrol, energy_source, conversion_factor, energy_conversion.energy_source, conversion_factor from petrol0
  
  left join energy_conversion on
  energy_source = energy_conversion.energy_source

)
select * from petrol