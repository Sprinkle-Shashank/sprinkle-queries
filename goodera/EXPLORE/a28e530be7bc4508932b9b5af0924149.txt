with sub1 as(
SELECT source_div, timeperiod_timerange, region_parent, factory_id, higg_requirement, extract(month from cast(timeperiod_timerange.start as date)) as month,extract(year from cast(timeperiod_timerange.start as date)) as year, case when month=1 then year-1000 else year end as fy
from profile_60928 sq
),
sub2 as(
  select  source_div, timeperiod_timerange, region_parent, factory_id, higg_requirement, sub1.fy, year_num, fy_timerange
  from sub1
left join profile_64189 pd
on sub1.fy=pd.year_text
left join profile_74269 mr
on pd.year_num=mr.fy
  )
  select * from sub2