with test1 as(
  select p.projectId, p.oral, p.diabetes, p.sti, tb1, p.hiv, p.vision, p.hypertension, p.general, p.patient_name, p.govt, p.p_id, p.s_clinic_type, p.f_category, p.f_reg_date from profile_59462 p cross join p.tb tb1
  ),
  	test2 as(
	select p.projectId, p.p_id, p.f_category, p.patient_name, p.f_reg_date, o.name as Oral_Hygiene, d.name as Diabetes, se.name as Sexually_Transmitted_Diseases, t.name as Tuberculosis, hi.name as HIV, decode(vision,1012444,0,1), v.name as Vision_Screening, hy.name as Hypertension, ge.name as General_Check_Up, go.name as govt, s.name as s_clinic_type from test1 p
	  left join ds_mysql_prod_tagelement o
	  on p.oral = o.id and p.oral != 1012465 
	  left join ds_mysql_prod_tagelement d
	  on p.diabetes = d.id and p.diabetes != 1012463 
	  left join ds_mysql_prod_tagelement se
	  on p.sti = se.id and p.sti != 1012470 
	  left join ds_mysql_prod_tagelement t
	  on p.tb1 = t.id and p.tb1 != 1012460 
	  left join ds_mysql_prod_tagelement hi
	  on p.hiv = hi.id and p.hiv != 1012480 
	  left join ds_mysql_prod_tagelement v
	  on p.vision = v.id and p.vision != 1012444 
	  left join ds_mysql_prod_tagelement hy
	  on p.hypertension = hy.id and p.hypertension != 1012468
	  left join ds_mysql_prod_tagelement ge
	  on p.general = ge.id and p.general != 1012465 
	  left join ds_mysql_prod_tagelement go
	  on p.govt = go.id
	  left join ds_mysql_prod_tagelement s
	  on p.s_clinic_type = s.id
	  
	)
  select * from test2