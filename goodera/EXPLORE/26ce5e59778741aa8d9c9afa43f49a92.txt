with table1 as
( select p.projectid , p.name , p._id ,sum(num_females) as num_females, sum(num_females_graduated) as num_females_graduated, type_program , concat('FY ',to_char(start_date,'YYYY')) as start_date from profile_4227 p group by p.projectid , p.name , p._id , type_program , start_date ),

batch_completed as (  select p._id,p.projectid, count(*)as completed from profile_4227 p
					 where end_date is not null
					 group by class),
batch_ongoing as ( select p._id,p.projectid,  class, count(*)as ongoing from profile_4227 p
					 where end_date is null
					 group by class),

select * from batch_completed