
with table1 as
(
   select p.projectid , p._id , p.name , name_country , name_vendor , name_vendor_filter , name_rp , name_vendor_filter as Partner_name , substring(Partner_name ,0,2) as First_Value, case when First_Value='V' then 'Vendor Partner' else 'Community Partner' end as Partner_type , p2.sourcing_yn , p2.vpid_1 , p2.vpid_2 , p2.child_vpid_autocal , case when First_Value='V' and p2.sourcing_yn=57472 then cast(p2.vpid_1 as varchar) when First_Value='V' and p2.sourcing_yn=57473 then cast(p2.vpid_2 as varchar) when First_Value='V' then cast(p2.child_vpid_autocal as varchar) end as Vendor_partner_ID, ltrim(name_vendor,' : ') as name_54646 from profile_54646 p
 
   left join profile_52162 p2 on
   p.name_vendor = p2.vendor
  

  )
  
  select * from table1
  
  /*
   
   left join profile_52162 p2 on
   p.name_vendor = p2.vendor
   
   case when partner_type='Vendor Partner' and p2.sourcing_yn=57472 then cast(p2.vpid_1 as varchar) when partner_type='Vendor Partner' and p2.sourcing_yn=57473 then cast(p2.vpid_2 as varchar) when partner_type='Vendor Partner' then cast(p2.child_vpid_autocal as varchar) end as Vendor_partner_ID
   */
   