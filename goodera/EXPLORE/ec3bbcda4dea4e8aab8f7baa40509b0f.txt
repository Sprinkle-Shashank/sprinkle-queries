with temp as(
Select 'Cubic Metres' as col
  union all
Select 'Litres' as col
)
, s1 as (
Select t.name as site,t1.name as sub_region,t2.name as region,fy_timerange,sum(datanum) as cubic_metres ,keyword as Water_Type,(cubic_metres*1000) as Litres
from sus_56999
left join ds_mysql_prod_project t
on xprojectid=t.id
left join ds_mysql_prod_project t1
on t.parent=t1.id
left join ds_mysql_prod_project t2
on t2.parent=t2.id
where keyword in ('water_usage_new_water_reclaimed', 'total_water_usage', 'water_usage_reclaimed_storm', 'water_usage_utility_provider', 'water_usage_well_water')  and xprojectid != '47608'
  group by t.name,t1.name,t2.name,fy_timerange,keyword,datanum,startdate
order by year desc
)
Select s1.* ,
sum(case col
 when 'Cubic Metres' then s1.cubic_metres
 when 'Litres' then s1.Litres
 else null
 end )as total_water_usage,temp.col as unit
 from s1
 cross join temp
group by s1.site,s1.sub_region,s1.region,s1.fy_timerange,s1.keyword,temp.col,s1.cubic_metres,s1.Litres



