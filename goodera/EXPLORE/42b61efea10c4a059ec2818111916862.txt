with sub1 as(
  select p2.name as projectid,p1.fy_timerange, p1.electricity_std, p1.elec_green, p1.elec_solar,
sum(
 case col
  when 'electricity_std' then p1.electricity_std
  when 'elec_green' then p1.elec_green
  when 'elec_solar' then p1.elec_solar
  else null
  end
) as electricity
from sus_62370 s1
cross join temp
left join ds_mysql_prod_project p2 on p2.id = p1.projectid 
group by p2.name,p1.name, p1.name, p1.name, p1.name,temp.col
)
  
select projectid,financialPeriod, electricity_std, elec_green, elec_solar,electricity_type,electricity from sub1
where electricity is not null
