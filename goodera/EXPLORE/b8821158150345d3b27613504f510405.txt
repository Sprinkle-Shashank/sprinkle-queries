select case when d1.date_yn = 28005 then cast(date(d1.date_n) as varchar) else d1.req_date end as date from profile_58474 p

left join profile_58511 d1
on p.sel_camp = d1._id
 
 group by DATE