Select projectId,dir.name as dir_indir, source.name as data_source,CAST(time_period_timerange.start as date) as timerange,Substring(timerange,1,4) as year_axis, Sum(p.total_suppliers) as total, p.suppliers_with_po, sc.name as scope from profile_61245 p

Left join ds_mysql_prod_tagelement dir
on p.dir_indir = dir.id

Left join ds_mysql_prod_tagelement source
on p.data_source = source.id

Left join ds_mysql_prod_tagelement sc
on p.scope = sc.id


group by projectId,time_period_timerange.start,year_axis,dir.name,source.name,p.suppliers_with_po,sc.name