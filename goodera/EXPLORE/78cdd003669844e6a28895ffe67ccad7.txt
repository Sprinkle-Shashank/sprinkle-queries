with table1 as (select add_factory.projectid,pace_mapping.name_factory as factory,pace_mapping.name_vendor_filter as vendor,pace_mapping.name_country as country,factory_vpid_1 as community_id, child_vendor_vpid as vp_id from profile_52713 add_factory

left join profile_54646 pace_mapping 
on add_factory.projectid = pace_mapping.projectid ),

table2 as ( SELECT _id,mon.creatorid, u.email as cemail, mon.modifierid, m.email as memail
from ds_mongo_profileinstance mon
left join ds_mysql_prod_user u on
mon.creatorid = u.id
left join ds_mysql_prod_user m  on
mon.modifierid = m.id
where mon.profileId='4227' and mon.active = 't' and mon.securitycontextid is not null
),			 
table3 as(
select p._id,projectid,t2.cemail,t2.memail from profile_4227 p
left join table2 t2 on
p._id = t2._id )

select t1.projectid,factory,vendor,country,community_id,vp_id,t3.cemail from table1 t1

left join table3 t3 on
t1.projectid = t3.projectid
