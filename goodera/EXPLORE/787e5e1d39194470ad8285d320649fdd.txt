select split_part(split_part(prod.name,'|',1),'.',1) as ProjectCode,f.name as fy_timerange,concat(ProjectCode,fy_timerange) as CODE,split_part(prod.name,'|',3) as census,p.task,p.cost_monthly as cost_per_unit,sum(units_monthly) as number_of_units_cover,sum(hdfc_cost_monthly) as total_hdfc_bank_contribution,(p.cost_monthly*sum(units_monthly)) as cost from profile_29974 p
left join ds_mysql_prod_project prod on
prod.id=p.projectid
left join ds_mysql_prod_tagelement f on
p.fy=f.id
group by  split_part(split_part(prod.name,'|',1),'.',1),f.name,split_part(prod.name,'|',3),p.task,p.cost_monthly