select p. projectId ,
nvl2(SUBSTRING(ven.name, 1, POSITION(' (' in ven.name)), SUBSTRING(ven.name, 1, POSITION(' (' in ven.name)), ven.name) as vendor_name, case when vendor_name='' then ven.name else vendor_name end as vendor,
cou.name as country ,
p2.country, p2.fac_cl_vpid, p2.vendor_ngo_id,        --p2
primary_category1.name as primary_category ,         --p2
p3.year, num_supervisors, p3.total_employed, p3.saturation, p3.timerange_timerange,  --p3
p4.date, single_multi1.name as training_type , p4.responsible_person,            --p4
p.num_male, p.num_female, p.total_supervisors,                 --p5
to_char( p.date_1 ,'dd-mm-yyyy')as date ,   
p6.male_certified, p6.female_certified ,               --p6
p7.users_sst,p7.gap_sst                                --p7

from profile_64075 p

left join ds_mysql_prod_project fac
on  p.projectid = fac.id
left join ds_mysql_prod_project ven
on fac.parent = ven.id
left join ds_mysql_prod_project cou
on ven.parent = cou.id


left join profile_52810 p2
on p.projectId = p2.projectId
left join profile_65283 p3
on p.projectId = p3.projectId
left join profile_61498 p4
on p.training_id = p4._id
left join profile_61483 p6
on p.projectId = p6.factory_name
left join profile_75144 p7
on p.projectId = p7.projectId


left join ds_mysql_prod_tagelement primary_category1 on
	p2.primary_category = primary_category1.id
left join ds_mysql_prod_tagelement single_multi1  on
	p4.single_multi = single_multi1.id


where (p.projectId <> 31303 and p.projectId <> 46455 and p.projectId <>54832 and p.projectId <>31299) and p.projectId ilike'%%'

group by p. projectId , ven.name ,cou.name  ,
p2.country, p2.fac_cl_vpid, p2.vendor_ngo_id,     
primary_category1.name,p3.year, num_supervisors, p3.total_employed, p3.saturation, p3.timerange_timerange, 
p4.date, single_multi1.name , p4.responsible_person,p.num_male, p.num_female, p.total_supervisors,p.date_1  ,   
p6.male_certified, p6.female_certified ,p7.users_sst,p7.gap_sst 