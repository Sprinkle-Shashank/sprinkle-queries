select _id1.name as mid ,projectId.name as profileId, fy_timerange,city,count(*)  from profile_64881 as m

left join ds_mysql_prod_project as projectId
on m.projectId = projectId.id
left join ds_mysql_prod_id as _id1
on m._id = _id1.id

where city IS NOT NULL

group by _id1.name ,projectId.name , city, fy_timerange
