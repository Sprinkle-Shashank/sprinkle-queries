WITH TEMP AS (
SELECT 'Students Trained' AS col
  UNION ALL
  SELECT 'voucher' AS col
  UNION ALL
  SELECT 'placement_status' AS col
  UNION ALL
  SELECT 'employment_status' AS col
)


SELECT 
COUNT (S.registration),
S.date AS fy_timerange,
S.completion_status, S.voucher, I._id, placement_status, employment_status, S.institute,
t1.name AS course_opt,
TEMP.col AS dimensions,

COUNT (CASE col
	WHEN 'Students Trained'
	THEN S.completion_status
	
	WHEN 'voucher'
	THEN S.voucher
	
	WHEN 'placement_status'
	THEN S.placement_status
	
	WHEN 'employment_status'
	THEN S.employment_status
	
END) AS values

FROM profile_77915_x AS S

CROSS JOIN TEMP 

LEFT JOIN profile_77911 AS I
ON S.institute = I._id

LEFT JOIN ds_mysql_prod_tagelement AS t1
ON I.course_opt = t1.id

GROUP BY S.date, S.completion_status, S.voucher, S.placement_status, S.employment_status, I._id, t1.name, S.institute, dimensions

ORDER BY S.date DESC

