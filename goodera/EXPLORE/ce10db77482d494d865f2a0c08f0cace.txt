WITH TEMP AS (
SELECT 'Students Trained' AS col
  UNION ALL
  SELECT 'Students Certified' AS col
  UNION ALL
  SELECT 'Placement Rate' AS col
  UNION ALL
  SELECT 'Retention Rate After 6 Months' AS col
)

SELECT
S.completion_status, S.voucher, placement_status, employment_status, S.institute,
COUNT (S.registration),
S.date AS fy_timerange,
t1.name AS course_opt,
t2.name AS locations,
TEMP.col AS dimensions,

COUNT (CASE col
	WHEN 'Students Trained'
	THEN S.completion_status
	
	WHEN 'Students Certified'
	THEN S.voucher
	
	WHEN 'Placement Rate'
	THEN S.placement_status
	
	WHEN 'Retention Rate After 6 Months'
	THEN S.employment_status
	
END) AS values

FROM profile_77915 AS S

CROSS JOIN TEMP 

LEFT JOIN profile_77911 AS I
ON S.institute = I.name

LEFT JOIN ds_mysql_prod_tagelement AS t1
ON I.course_opt = t1.id

LEFT JOIN ds_mysql_prod_tagelement AS t2
ON S.location = t2.id

GROUP BY S.date, S.completion_status, S.voucher, S.placement_status, S.employment_status, t1.name, t2.name, S.institute, dimensions