with table2 as(Select p.* ,CAST(pace_goals as VARCHAR)from profile_76755 p
, p.pace_goals_arr pace_goals
),
 table1 as ( Select  t2.projectId, t2.facility_name, t2.pace, t2.strategic_yn, t2.year_timerange, t2.country as country, t2.director_region as director_region,t2.pace_goals, 

case 
	when 1=1
	then 1
	else 0
	end
	as count

from table2 t2





WHERE t2.strategic_yn ='Yes' 
),
temp as(select 'pace' as dim
        union all
        select 'pace_introduced' as dim
        union all
        select 'master_value' as dim
)
select temp.dim,t1.projectId, t1.facility_name, t1.pace, t1.strategic_yn, t1.year_timerange, country, director_region,t1.pace_goals,pr_46.name_vendor_filter as vendor, 
certified_mts*100 AS a1,
a1/certified_trainers AS master,pr_95.certified_trainers , pr_95.certified_mts , pr_95.pace_introduced 

case dim
when 'pace' then count(*)
where t1.pace = 'Yes'
when 'pace_introduced' then count(*)
where pr_95.pace_introduced = 57472
when 'master_value' then count(*)
where master>=30
else null
end as value1

from table1 t1
cross join temp

left join profile_54646 pr_46 
on t1.projectid = pr_46.projectid

left join profile_76895 pr_95
on t1.pace_goals = pr_95.projectid

where t1.strategic_yn = 'Yes'

Group by  t1.projectId, t1.facility_name, t1.strategic_yn, t1.year_timerange, country,  vendor,pr_95.certified_mts,pr_95.pace_introduced,pr_95.certified_trainers,t1.pace,
director_region,t1.pace_goals