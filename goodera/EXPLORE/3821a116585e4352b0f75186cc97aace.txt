with table1 as
(
  select p.projectid , p._id , p.fy_timerange , sta.name as state_update , dis.name as district_update , rapid_test from profile_82798 as p
  
  left join profile_82797 p1
  on p.benef = p1._id
  
  left join ds_mysql_prod_tagelement sta
  on p1.state = sta.id 
  
  left join ds_mysql_prod_tagelement dis
  on p1.district = dis.id
  ),
  
  table2 as
  ( 
	select  p.*, d1 from table1 as p , p.rapid_test as d1
	)
  
  select p.* , rapid.name as rapid_test_update from table2 as p
  
  left join ds_mysql_prod_tagelement rapid
  on p.rapid_test = rapid.id
  