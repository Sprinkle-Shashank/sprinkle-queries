with table1 as
(
  select p.* , sta.name as state_update , dis.name as district_update ,  row_number() over 
(partition by p.projectid
 order by p._id desc) as row ,   (40*bmi_percent) as bmi_number , case when bmi_number>18.5 then 'Underweight' else 'Extreme Obesity' end as bmi_category from profile_82799 as p
  
 left join ds_mysql_prod_tagelement sta
 on p.state = sta.id 
 
 left join ds_mysql_prod_tagelement dis
 on p.dist = dis.id 
  )
  
  select * from table1 where row=1