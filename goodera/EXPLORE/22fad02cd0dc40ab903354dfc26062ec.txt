with table1 as
(
  select p.* , sta.name as state_update , dis.name as district_update ,  row_number() over 
(partition by p.projectid
 order by p._id desc) as row ,  18.5 as bmi_number
  
  ---(40.5*bmi_percent)/100 as bmi_number
  
  , case when bmi_number<18.5 then 'Underweight' when bmi_number>=18.5 and bmi_number<25 then 'Healthy' when bmi_number>=25 and  bmi_number<30 then 'OverWeight' else 'Obesity' end as bmi_category from profile_82799 as p
  
 left join ds_mysql_prod_tagelement sta
 on p.state = sta.id 
 
 left join ds_mysql_prod_tagelement dis
 on p.dist = dis.id 
  )
  
  select * from table1 where row=1