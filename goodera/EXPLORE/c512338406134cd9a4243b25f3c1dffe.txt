with table1 as (select  yr.name as year, period.name as reporting_period,sum(p2.target_ind16)/ 2 as trgt  from profile_23116 as p2

left join ds_mysql_prod_tagelement yr
on p2.year_3 = yr.id

left join ds_mysql_prod_tagelement period
on p2.reporting_period_3 = period.id

where target_ind16 is not null

group by yr.name,period.name 

order by year asc),
table2 as (
select sum(p.enrollment)as enrollment, yr.name as year,p.lg_status,extract(month from p.date_of_formation)as month,
 case when month in ('2', '3', '4')
then '1st(Feb-Apr)'
when month in ('5','6','7')
then '2nd(May-Jul)'
when month in ('8', '9', '10')
then '3rd(Aug-Oct)'
when month in ('11', '12',  '1')
then '4th(Nov-Jan)'
end as quarter  
  
  from profile_29179 p
left join ds_mysql_prod_tagelement yr
on p.year = yr.id
 where lg_status = 847850 or lg_status is null  
group by yr.name,lg_status,month
order by year asc
),

/*select year,quarter,'Enrollment' as dim , sum(enrollment) as val from table2
 group by year ,quarter,dim */
table3 as (select '1st(Feb-Apr)' as quarter 
		   union all
		   select '2nd(May-Jul)' as quarter 
           Union all
		   select '3rd(Aug-Oct)' as quarter
		   Union all
           select all '4th(Nov-Jan)' as quarter)

select t1.year,t1.reporting_period,t1.trgt, t3.quarter from table1 t1

cross join table3 t3 
order by year asc
/*insert into quarter values
('1st(Feb-Apr)'),
('2nd(May-Jul)'),
('3rd(Aug-Oct)'),
('4th(Nov-Jan)')*/

--select * from quarter
  --p.date_of_completion ,p.pace_completion, p.date_of_formation , p.lg_status,p.year from profile_29179 p
