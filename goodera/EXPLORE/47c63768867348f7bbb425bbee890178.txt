with


 table11 as(
select  projectId,ngo, schedule_vii, local_yn, fy_timerange, endd,start,imp_direct, csr_reg_num, state_district, ongoing,sum(val) as val,dim from t1 
   
Group By projectId, fy_timerange, Dim,ngo, schedule_vii, local_yn, fy_timerange, endd,start,imp_direct, csr_reg_num, state_district, ongoing),

table2 as (select t1.*,state_distric from table11 t1 , t1.state_district as state_distric)

select  p.projectId,ngo, schedule_vii, local_yn, fy_timerange, endd,start,imp_direct, csr_reg_num, state_distric, ongoing,sum(val) as val,dim from table2 as p

  Group By p.projectId, fy_timerange, Dim,ngo, schedule_vii, local_yn, fy_timerange, endd,start,imp_direct, csr_reg_num, state_distric, ongoing
  
  
  
  