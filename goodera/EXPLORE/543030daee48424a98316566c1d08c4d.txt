SELECT sq.fy_timerange, pd.pvh_id, mr.region, COUNT(sq.fy_timerange) AS batches
FROM profile_62491 sq
LEFT JOIN profile_62948 pd
ON sq.project_id=pd.project_id
LEFT JOIN profile_60928 mr
ON pd.project_id=mr.factory_id
WHERE sq.end_date_2 IS NOT NULL AND pd.pvh_id IS NOT NULL AND extract(year from(cast(fy_timerange.start as datetime)))>=2020
GROUP BY sq.select_modules, sq.fy_timerange, pd.pvh_id, mr.timeperiod_timerange, mr.region, sq.end_date_2, sq.num_females_graduated, sq.hours, sq.num_males, sq.num_females, sq.num_females_dropout, sq.num_males_graduated, sq.num_males_dropout, sq.name


--3rd new field & 4th left--