SELECT sq.fy_timerange, pd.pvh_id, pd.timeperiod_timerange, sq.region, COUNT(pd.pvh_id) AS batches
FROM profile_62491 sq
LEFT JOIN profile_62498 pd
ON sq.project_id=pd.project_id
LEFT JOIN profile_60928
ON pd.project_id=mr.factory_id
WHERE sq.end_date_2 IS NOT NULL AND pd.pvh_id IS NOT NULL AND sq.fy_timerange.start>=2020
GROUP BY sq.fy_timerange, pd.pvh_id, pd.timeperiod_timerange, sq.region, batches, sq.end_date_2, sq.num_females_graduated, sq.hours, sq.num_males, sq.num_females, sq.num_females_dropout, sq.num_males_graduated, sq.num_males_dropout, sq.name


--3rd new field & 4th left--