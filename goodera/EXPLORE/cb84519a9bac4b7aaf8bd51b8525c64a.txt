select p2.name as projectid, p3.name as partner,p7.name as project_name, p6.name as partner2,p1.fy_timerange,t1.name as impl_partner,sum(p1.allocated)

from profile_65557 p1
left join ds_mysql_prod_project p2 on p2.id = p1.project_name
left join ds_mysql_prod_project p3 on p3.id = p2.parent

left join profile_65552 p4 on p4._id = p1.projectid
left join ds_mysql_prod_tagelement t1 on t1.id= p4.impl_agency 
left join ds_mysql_prod_project p5 on p5.id= p4.projectid
left join ds_mysql_prod_project p6 on p6.id = p5.parent

left join ds_mysql_prod_project p7 on p7.id = p4.proj_name

group by p2.name, p3.name, p7.name, p6.name, t1.name,p1.fy_timerange, p1.allocated