with table1 as
(
  select proj.name as projectid,	p._id	, p.fy_timerange,	projects	,quarter_report,	p.ngo	, impact	,annual_report,	mou	,remarks,	link	, p.name	,quarter_file
 , qua.name as quarter_update , ng.name as ngo_update from profile_83043 as p
  
  left join ds_mysql_prod_tagelement qua
  on p.quarter_report = qua.id
  
  left join ds_mysql_prod_tagelement ng
  on p.ngo = ng.id
  
  left join ds_mysql_prod_project proj
  on p.projectid = proj.id
),

table2 as
(
  select p.* , cast(d1 as varchar) as d1_update_quarter_file , cast(d2 as varchar) as d2_update_annual_file ,  d3 as quarter_report_update
  from table1 as p, p.quarter_file as d1 , p.annual_report as d2, p.quarter_report as d3 
)

select * from table2 as p

/*
table3 as
(
   select cast(p.fy_timerange.start as date) as fy_1 , extract(year from fy_1) as fy_timerange , projectid , impact , remarks , link , ngo_update , quarter_update , d1_update_quarter_file , d2_update_annual_file , mou_update , annual_report_update  from table2 as p
  )
  
  select * from table3
  
  */