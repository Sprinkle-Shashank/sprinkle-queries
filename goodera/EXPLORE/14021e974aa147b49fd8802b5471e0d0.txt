select fac.name as projectId, cou.name as country, ven.name as vendor, 
--Count(projectId) as randl_engaging, 

nvl2(opinion_heard = 1060677,1,0) as opinion_heard1,
nvl2(opinion_express = 1060677,1,0) as opinion_express1,
nvl2(different_work = 1060677,1,0) as different_work1,
nvl2(easy_content = 1060677,1,0) as easy_content1,
nvl2(encourage_participation = 1060677,1,0) as encourage_participation1,
(opinion_heard1 + opinion_express1 + different_work1 + easy_content1 + encourage_participation1) as sum_responses


from profile_65254


left join ds_mysql_prod_project fac
on projectid = fac.id
left join ds_mysql_prod_project ven
on fac.parent = ven.id
left join ds_mysql_prod_project cou
on ven.parent = cou.id

where cou.name <> 'Test Country' and sum_responses>=4

--and (opinion_heard = 1060677 or opinion_express = 1060677 or different_work = 1060677 or easy_content = 1060677 or encourage_participation = 1060677)
group by fac.name, cou.name, ven.name, opinion_heard, opinion_express, different_work, easy_content, encourage_participation


/*

select fac.name as projectId, cou.name as country, ven.name as vendor,
Count(projectId) as randl_engaging
from profile_65254


left join ds_mysql_prod_project fac
on projectid = fac.id
left join ds_mysql_prod_project ven
on fac.parent = ven.id
left join ds_mysql_prod_project cou
on ven.parent = cou.id

where cou.name <> 'Test Country' and training_topics_relevant = 1060677
group by fac.name, cou.name, ven.name

*/