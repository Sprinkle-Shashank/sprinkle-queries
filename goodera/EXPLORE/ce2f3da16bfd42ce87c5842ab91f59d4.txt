with temp as(
  Select 'Villages' as col
  union all
  Select 'Schools' as col
  union all
  Select 'Youth' as col
    union all
  Select 'Students' as col
  union all
  Select 'Teachers' as col
    union all
  Select 'Fellows' as col
  union all
  Select 'Farmers' as col
    union all
  Select 'Women' as col
  union all
  Select 'Others' as col
  ),
  
 t1 as(
   Select t1.name fy_timerange, temp.col as dim,t.name select_quarter, split_part(split_part(prod.name,'|',1),'.',1) as ProjectCode, CONCAT(ProjectCode,fy_timerange) as CODE, sq.benef_upload,
   split_part(prod.name,'|',1) as Region1,
  case 
      when Region1 like '%.%' then split_part(prod.name,'|',2)
     else '-'
 end as Region
from profile_60787 sq
cross join temp
left join ds_mysql_prod_tagelement t
on t.id=sq.select_quarter
left join ds_mysql_prod_tagelement t1
ON t1.id=sq.fy
left join  ds_mysql_prod_project prod  on
prod.id=projectid
  
group by temp.col, t.name, t1.name, prod.name, Region1, Region, benef_upload
 ),
 
 t2 as(
     Select cast(q.name as varchar) as ProjectCode,f.name as fy_timerange,m.name as Project_Manager,CONCAT(ProjectCode,fy_timerange) as CODE
from profile_27420 d
left join ds_mysql_prod_tagelement f on
d.fy=f.id
left join ds_mysql_prod_tagelement m on
d.project_manager=m.id
left join profile_27396 q on
d.project_code=q._id	   
union all		   
select cast(c.name as varchar)as ProjectCode,f.name as fy_timerange,m.name as Project_Manager,CONCAT(ProjectCode,fy_timerange) as CODE 
from profile_27396 c	
left join ds_mysql_prod_tagelement f on
c.fy=f.id
left join ds_mysql_prod_tagelement m on
c.project_manager=m.id
 )
 
 
 Select t2.ProjectCode, t2.Project_Manager, t1.Region, t1.dim, t1.benef_upload, t2.fy_timerange, select_quarter
 from t1
 left join t2
 ON t1.CODE=t2.CODE