with s as (Select 
data.name,data.project_code,t1.name as project_manager,data.focus_area,data.start_date,data.end_date,
data.submissionlog,substring(t.name,1,4) as fy,approvallog,status
from ds_mongo_taskresponse 	
left join ds_mysql_prod_tagelement t
on t.id=data.fy
left join ds_mysql_prod_tagelement t1
on t1.id=data.project_manager
where profileId=27420
order by fy
)
,
s2 as(
Select max(name),(project_code),max(project_manager),max(focus_area),max(start_date),max(end_date),max(approvallog),max(status),sl."timestamp" as submissiondate,al."approvalStatus" as status2
from s as p,p.submissionlog sl,p.approvallog al
)
Select * from s2
/*
Select project_code,max(s2.name) as name,max(project_manager) as project_manager,max(focus_area) as focus_area,max(start_date) as start_date,max(end_date) as end_date,max(approvallog) as approvallog, max(status) as status,status2,max(submissiondate) as submissiondate
from s2
group by s2.project_code,status2
*/
	
	
	