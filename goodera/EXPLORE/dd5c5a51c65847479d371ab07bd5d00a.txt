with s as (Select 
data.name,data.project_code,data.project_manager,data.focus_area,data.start_date,data.end_date,
data.submissionlog."timestamp",substring(t.name,1,4) as fy
from ds_mongo_taskresponse 	
left join ds_mysql_prod_tagelement t
on t.id=data.fy
where profileId=27420
order by fy
)
/*
,
s2 as(
Select name,project_code,project_manager,focus_area,start_date,end_date,profileinstanceid,sl."timestamp" as submissiondate
from s as p,p.submissionlog sl
)
Select max(s2.name) as name,max(ngo_partner) as ngo_partner,max(t.name) as project_manager,max(t1.name) as focus_area,max(ss.name) as intervention_type,max(start_date) as start_date,max(end_date) as end_date,profileinstanceid,(al) as approvallog, max(status2) as status2,max(submissiondate) as submissiondate
from s2
left join profile_28235 ss
on ss._id=s2.intervention_type
left join ds_mysql_prod_tagelement t
on t.id=s2.project_manager
left join ds_mysql_prod_tagelement t1
on t1.id=s2.focus_area
group by s2.profileinstanceid,s2.al
*/
Select * from s
	
	