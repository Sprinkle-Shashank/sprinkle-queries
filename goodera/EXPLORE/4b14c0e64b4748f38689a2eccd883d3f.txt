with sub1 as(
  select p1.time_timerange as fy_timerange, t1.name as country, t2.name as focus_area
from profile_32441 p1
left join profile_63775 p2 on p2._id = p1.program_name
left join ds_mysql_prod_tagelement t1 on t1.id = p1.country_new
left join ds_mysql_prod_tagelement t2 on t2.id = p2.focus_area
where t1.name is not null),

--Investment Details (Above)

sub2 as(
  select p3.fy_timerange, t3.name as country, t4.name as focus_area
from profile_78057 p3
left join ds_mysql_prod_tagelement t3 on t3.id = p3.country
left join ds_mysql_prod_tagelement t4 on t4.id = p3.focus_area
where t3.name is not null),

--ONE OFF (Above)

sub3 as(
  select p4.fy_timerange, t5.name as country, t6.name as focus_area
from profile_78098 p4
left join ds_mysql_prod_tagelement t5 on t5.id = p4.country
left join ds_mysql_prod_tagelement t6 on t6.id = p4.focus_area
where t5.name is not null),

--Brand Led (Above)

sub4 as(
  select fy_timerange, country, focus_area from sub1
union all
select fy_timerange, country, focus_area from sub2
union all
select fy_timerange, country, focus_area from sub3)

select fy_timerange, country, focus_area, 1 as count from sub4
group by fy_timerange, country, focus_area