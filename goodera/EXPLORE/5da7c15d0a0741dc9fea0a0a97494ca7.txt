--Select pace_status_1 from profile_52713 p
with table1 as(Select p.name_country as country,p.name_vendor as partner,p._id,f_y.name as fy,mth.name as month,pro.name as factory,profile_54267.fac_vpid,profile_52713.pace_status_1 ,profile_52713.sourcing_yn,rating.name as facility_rating,p.name_vendor_filter as partner_consolidated,count(*),row_number() over 
(partition by factory
 order by p._id desc) as row


from profile_54646 p 

left join profile_54267 on
p.projectId = profile_54267.projectId

left join profile_52713 on
p.projectId = profile_52713.projectId

left join ds_mysql_prod_project pro
on p.projectId = pro.id

--left join ds_mysql_prod_tagelement pc_2
--on profile_52713.pace_status_1 = pc_2.id
left join ds_mysql_prod_tagelement f_y
on profile_54267.fy = f_y.id
left join ds_mysql_prod_tagelement mth
on profile_54267.month = mth.id

left join ds_mysql_prod_tagelement rating
on profile_54267.facility_rating = rating.id


where profile_52713.pace_status_1= 'Currently implementing P.A.C.E.' and profile_52713.sourcing_yn = 57472
and profile_54267.facility_rating = 845094

group by country,partner,partner_consolidated,profile_52713.pace_status_1,profile_52713.sourcing_yn,f_y.name,mth.name,rating.name,profile_54267.fac_vpid,pro.name,p._id

)
select Distinct factory,fy,month,row from table1
where row = 1
