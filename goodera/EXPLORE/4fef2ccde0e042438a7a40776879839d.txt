with table1 as(Select projectid,fy_timerange,tri.name as training_format,centres_qia_palliative_care,cen.name as centres_name_pal,male_qia_pal,female_qia_pal,male_qia_nurse_pal,female_qia_nurse_pal,report_pal from profile_79232 p

LEFT JOIN ds_mysql_prod_tagelement tri on
p.training_format = tri.id

LEFT JOIN ds_mysql_prod_tagelement cen on
p.centres_name_pal = cen.id
),
table2 as (select t1.*,CAST(centres_name_pal as super) from table1 t1,t1.centres_name_pal centres

)
select DISTINCT projectid,fy_timerange,tri.name as training_format,centres_qia_palliative_care,cen.name as male_qia_pal,female_qia_pal,male_qia_nurse_pal,female_qia_nurse_pal,report_pal,listagg(centres,',')

from table2

