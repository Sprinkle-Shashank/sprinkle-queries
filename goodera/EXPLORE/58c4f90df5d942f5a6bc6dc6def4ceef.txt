with sub1 as (
	SELECT sq.brand, sq.fy, sq.facility_type_parent, sq.region, SUM(total_area) as total_area_grouped
	FROM profile_56599 sq
	GROUP BY sq.fy, sq.facility_type_parent, sq.brand,sq.region),
sub2 as(
	SELECT s1.fy, s1.facility_type_parent, s1.total_area_grouped, brand11, region11 FROM sub1 s1, s1.brand brand11, s1.region region11
  ),
sub3 as (
	SELECT sq.*, t.name as brand_0, t1.name as region_0
	from sub2 sq
	left join ds_mysql_prod_tagelement t
    on sq.brand11 = t.id
	left join ds_mysql_prod_tagelement t1
	on sq.region11 = t1.id)
	
  SELECT brand,fy, facility_type_parent, case when region_0 IS NULL then 'Overall' else region_0 end as region, case when brand_0 IS NULL then 'Overall' else brand_0 end as brand
  FROM sub3