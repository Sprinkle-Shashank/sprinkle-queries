with test1 as(
select fy_timerange.start as fy_timerange, projectid,'Trucker' as f_category, media_truckers as final_sum from profile_63887
  union all
select fy_timerange.start as fy_timerange, projectid,'Allied' as f_category, media_allied as final_sum from profile_63887
  union all
select fy_timerange.start as fy_timerange, projectid,'Trucker' as f_category, outreach_total_coverage_truckers as final_sum from profile_63887
  union all
select fy_timerange.start as fy_timerange, projectid,'Allied' as f_category, outreach_total_coverage_allied as final_sum from profile_63887
  union all
select fy_timerange.start as fy_timerange, projectid,'Trucker' as f_category, peer_truckers as final_sum from profile_63887
  union all
select fy_timerange.start as fy_timerange, projectid,'Allied' as f_category, peer_allied as final_sum from profile_63887
),

test2 as(
select fy_timerange.start as fy_timerange, projectid,'Trucker' as f_category, truckers as final_sum from profile_59325
  union all
select fy_timerange.start as fy_timerange, projectid,'Allied' as f_category, allied as final_sum from profile_59325
),

test3 as(
select fy_timerange.start as fy_timerange, projectid,'Trucker' as f_category, (decode(truckers_one_to_one_sessions,null,0,truckers_one_to_one_sessions) + decode(truckers_one_to_group_sessions ,null,0,truckers_one_to_group_sessions) + decode(tbone,null,0,tbone) + decode(tbgroup,null,0,tbgroup)) as final_sum from profile_59326
  union all
select fy_timerange.start as fy_timerange, projectid,'Allied' as f_category, (decode(allied_one_to_one_sessions,null,0,allied_one_to_one_sessions) + decode(allied_one_to_group_sessions ,null,0,allied_one_to_group_sessions) + decode(abone,null,0,abone) + decode(abgroup,null,0,abgroup)) as final_sum from profile_59326
)

select fy_timerange, project.name as projectid, f_category,sum(final_sum) as final_sum
from final left join ds_mysql_prod_project as project
on project.id = final.projectid
group by 1,2,3