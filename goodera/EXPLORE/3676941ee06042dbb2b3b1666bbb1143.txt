with t1 as
(select p1.fy_timerange,p1.trainee_id,tag1.name as edu_qual,tag2.name as gender,p1.occupation,p1.fed_role,p1.job_status,p1.fam_income,p1.pre_income,p1.income_3months,p1.income_6months,p1.income_12months  
from profile_76022 p1
left join ds_mysql_prod_tagelement tag1 on
p1.edu_qual = tag1.id
left join ds_mysql_prod_tagelement tag2 on
p1.gender = tag2.id)

t2 as
(select t1.*,
case
when income_12months > 0 then t1.income_12months
when income_6months > 0 then t1.income_6months 
Else t1.income_3months
end as final_income
from t1)

select fy_timerange
from t2
