with sub1 as(
  select p1.id as event_id, p2.startdate as start_date, nvl(p2.enddate, p2.startdate) as end_date, INITCAP(p2.countryname) as country, p4.created as participation_date, cast(p4.duration as float) as duration
from ds_mysql_prod_empOpportunity p1
LEFT JOIN ds_mysql_prod_empVolunteeringOpportunity p2 ON p2.empOpportunityId = p1.id
LEFT JOIN ds_mysql_prod_empVolunteeringApplication p3 ON p3.empVolunteeringOpportunityId = p2.id
LEFT JOIN ds_mysql_prod_empVolunteeringParticipation p4 ON p4.empVolunteeringApplicationId = p3.id
where UPPER(p1.opportunityType) = 'VOL' and p1.securityContextId = 1615 and p4.active = 1 and p1.active = 1
and p4.duration != 0 and p4.duration is not null),

sub2 as(
  select p5.id as event_id, p6.created as start_date, p6.created as end_date, 
(cast(p6.timetaken as float)/60) as duration, NULL as country, p7.created as participation_date
from ds_mysql_prod_empOpportunity p5
LEFT JOIN ds_mysql_prod_empMicroOpportunity p6 ON p6.empOpportunityId = p5.id
LEFT JOIN ds_mysql_prod_empMicroContributor p7 ON p7.empMicroOpportunityId = p6.id 
where UPPER(p5.opportunityType) = 'MIC' and p5.securityContextId = 1615 and p5.active = 1 and p7.active = 1 
and p6.timetaken is not null and p6.timetaken != 0)

select event_id, start_date, participation_date, end_date, country, duration from sub1
UNION ALL
select event_id, start_date, participation_date, end_date, country, duration from sub2