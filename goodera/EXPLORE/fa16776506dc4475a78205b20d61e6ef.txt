

with t1 as
(SELECT * 
FROM
(Select  student_name, month_timerange as fy_timerange, status, english, kannada, evs, maths, hindi, computer, class from profile_60441 p
 
)
UNPIVOT (
    val FOR dim IN (  english, kannada, evs, maths, hindi, computer))

)

select fy_timerange,   avg(val) as total,dim  from t1 as p
   
Group By fy_timerange,dim
  


