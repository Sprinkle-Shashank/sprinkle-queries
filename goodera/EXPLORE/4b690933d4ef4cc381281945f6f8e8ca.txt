select p1.projectId, p1.end_date, p1.actual_end_date, p1.program_level_milestone as milestone_name,p2.country, p2.vendor, p2.cycle, p2.consultant, p2.product_category,current_date as current_date,

case 
when current_date < p1.end_date then 'ongoing'
when actual_end_date < p1.end_date then 'Completed'
when actual_end_date > p1.end_date then 'Delayed, but Completed'
else 'NA'
end as status, 

case 
when p1.program_level_milestone like 'Vendor vetting' then '1'
when p1.program_level_milestone = 'Factory MSA - Baseline' then '2'
when p1.program_level_milestone = 'milestone_name,"Worker Survey' then '3'
when p1.program_level_milestone = 'Worker survey scorecard' then '4'
when p1.program_level_milestone = 'Factory and Vendor On-boarding' then '5'
when p1.program_level_milestone = 'Formation of Worker - Management Committee' then '6'
when p1.program_level_milestone = 'Focused Group Discussion' then '7'
when p1.program_level_milestone = 'Deliver Train the Trainer workshop' then '8'
when p1.program_level_milestone = 'Factory MSA - Endline' then '9'
when p1.program_level_milestone = 'Deliver Workshop 1: Communication & Problem Solving' then '10'
else '11'
end as sort

from profile_64141 p1

left join profile_64362 p2 
on p1.projectId= p2.projectId
order by sort asc
