select p1.projectId, p1.end_date, p1.actual_end_date, p1.program_level_milestone,p2.country, p2.vendor, p2.cycle, p2.consultant, p2.product_category,current_date as current_date,
--if(lt($current_date,$end_date),Ongoing, if(ne($null_status,NA), if(lte($actual_end_date,$end_date),"Completed", if(gt($actual_end_date,$end_date),"Delayed, but Completed",NA)),NA),NA) 
case 
when current_date < p1.end_date then 'ongoing'
when actual_end_date < p1.end_date then 'Completed'
when actual_end_date > p1.end_date then 'Delayed, but Completed'
else 'NA'
end as status 
--case 
--when actual_end_date= null then 'NA' 
--else actual_end_date
--end as null_status
from profile_64141 p1
left join profile_64362 p2 
on p1.projectId= p2.projectId
