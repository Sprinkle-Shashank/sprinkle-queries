with sub1 as(
  select p1._id, p1.factory_id, p1.factory_name, p1.source_div, p1.region, p1.timeperiod_timerange,
dense_rank() over (order by cast(p1.timeperiod_timerange.start as DATE) desc) as rank
from profile_60928 p1
where p1.timeperiod_timerange is not null),

sub2 as(
  select * from sub1 where rank = 1)
  
select * from sub2