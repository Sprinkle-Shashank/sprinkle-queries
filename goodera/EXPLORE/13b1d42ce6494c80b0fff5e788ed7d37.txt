with sub1 as(
  select p1.grantproposalid, p1.createddate, p1.date_of_entry, p1.metrics_1, p1.metrics_2,
  
case
  	when p1.metrics_2 is null then p1.metrics_1
  	else p1.metrics_2
end as metrics_final
  
from profile_43726 p1),

sub2 as(
  select s1.grantproposalid as grantproposalid_1, s1.date_of_entry, s1.createddate, coun.progress, coun.uom 
from sub1 as s1, unpivot s1.metrics_final as coun),

sub3 as(
  select p2.grantproposalid, p2.createddate, p2.date_of_entry, p2.metrics_1, p2.metrics_2,
  
case
  	when p2.metrics_2 is null then p2.metrics_1
  	else p2.metrics_2
end as metrics_final
  
from profile_43728 p2),

sub4 as(
  select s3.grantproposalid  as grantproposalid_2 , s3.date_of_entry, s3.createddate, coun2.progress, coun2.uom 
from sub3 as s3, unpivot s3.metrics_final as coun2)
  
select s2.grantproposalid_1, s2.date_of_entry, s2.createddate, s4.grantproposalid_2
from sub2
left join sub4 s4 on s2.grantproposalid_1 = s4.grantproposalid_2