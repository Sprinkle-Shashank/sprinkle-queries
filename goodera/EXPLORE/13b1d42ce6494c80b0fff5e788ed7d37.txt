with sub1 as(
  select p1.grantproposalid, p1.createddate, p1.date_of_entry, p1.metrics_1, p1.metrics_2,
  
case
  	when p1.metrics_2 is null then p1.metrics_1
  	else p1.metrics_2
end as metrics_final
  
from profile_43726 p1),

sub2 as(
  select s1.grantproposalid, s1.date_of_entry, s1.createddate, coun.progress, coun.uom 
from sub1 as s1, unpivot s1.metrics_final as coun),

sub3 as(
  select p2.grantproposalid, p2.createddate, p2.date_of_entry, p2.metrics_1, p2.metrics_2,
  
case
  	when p2.metrics_2 is null then p2.metrics_1
  	else p2.metrics_2
end as metrics_final
  
from profile_43728 p2),

sub4 as(
  select s3.grantproposalid, s3.date_of_entry, s3.createddate, coun2.progress, coun2.uom 
from sub3 as s3, unpivot s3.metrics_final as coun2),

sub5 as(
  select grantproposalid, date_of_entry, createddate, progress, uom from sub2
  union all
  select grantproposalid, date_of_entry, createddate, progress, uom from sub4)
  
select * from profile_43726