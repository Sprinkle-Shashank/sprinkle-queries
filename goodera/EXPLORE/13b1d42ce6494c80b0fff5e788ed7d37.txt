with sub1 as(
  select p1.grantproposalid, p1.createddate, p1.date_of_entry, p1.metrics_1, p1.metrics_2,
  
case
  	when p1.metrics_2 is null then p1.metrics_1
  	else p1.metrics_2
end as metrics_final
  
from profile_43726 p1),

sub2 as(
  select s1.grantproposalid, s1.grantproposalid, s1.date_of_entry, x_axis, coun.progress, coun.uom 
from sub1 as s1, unpivot s1.metrics_final as coun),

sub3 as(
  select p2.grantproposalid, p2.createddate, p2.date_of_entry, p2.metrics_1, p2.metrics_2,
  
case
  	when p2.metrics_2 is null then p2.metrics_1
  	else p2.metrics_2
end as metrics_final
  
from profile_43728 p2)

select * from sub3