select p1._id as id, p2.name as projectid, p1.timerange_timerange, p1.year, p1.turnover,

case
	when IS_ARRAY(p3.product_category) = FALSE or GET_ARRAY_LENGTH(p3.product_category) = 0 then ARRAY(p3.product_category)
	else p3.product_category
end as product_category_new,

case
	when IS_ARRAY(p3.cycle) = FALSE or GET_ARRAY_LENGTH(p3.cycle) = 0 then ARRAY(p3.cycle)
	else p3.cycle
end as cycle_new,

p3.country, p3.vendor, p3.consutant
from profile_61528 p1

left join ds_mysql_prod_project p2 on p2.id = p1.projectid
left join profile_63452 p3 on p3.projectid = p1.projectid