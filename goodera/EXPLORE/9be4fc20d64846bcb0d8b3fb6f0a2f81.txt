with t1 as
(
  select p.projectid, proj.name as proj_update, disbursed, fy_timerange, p1.focus_area, foc.name as parent_focus_area
  from profile_56364 as p
  
  left join profile_56342 p1
  on p.projectid = p1.projectid
  
  left join ds_mysql_prod_tagelement foc
  on p1.focus_area = foc.id
  
  left join ds_mysql_prod_tagelement proj
  on p.projectid = proj.id
  ),
  t2 as
  (
	select proj_update, fy_timerange, sum(disbursed) as Total_Amount_disbursed, focus_area, parent_focus_area from t1
	
	group by proj_update, fy_timerange, focus_area, parent_focus_area
	)
	select * from t2