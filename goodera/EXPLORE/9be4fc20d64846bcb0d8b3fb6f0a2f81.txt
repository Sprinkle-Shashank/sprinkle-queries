with t1 as
(
  select p.projectid, proj.name as proj_update, disbursed, fy_timerange, focus_area1.name as focus_area, /*foc.name as focus_area_updated,*/ Parent_Focus_Area_1.name as Parent_Focus_Area
  from profile_56364 as p
  
  left join profile_56342 p1
  on p.projectid = p1.projectid
  
 /* left join ds_mysql_prod_tagelement focus 
  on p.focus_area = foc.id*/
  
  left join ds_mysql_prod_tagelement as Parent_focus_area1
on p.focus_area1 = Parent_focus_area_1.id
  
  left join ds_mysql_prod_tagelement as Parent_focus_area1_parent
on Parent_focus_area1.parent = Parent_focus_area1_parent.id
  
  left join ds_mysql_prod_tagelement proj
  on p.projectid = proj.id
  ),
  t2 as
  (
	select proj_update, fy_timerange, sum(disbursed) as Total_Amount_disbursed, focus_area, Parent_focus_area from t1
	
	group by proj_update, fy_timerange, focus_area, Parent_focus_area
	)
	select * from t2