with t1 as
(
  select p.projectid, proj.name as proj_update, disbursed, fy_timerange, p1.focus_area, foc.name as focus_area_updated,Parent_Focus_Area, Parent_Focus_Area_parent
  from profile_56364 as p
  
  left join profile_56342 p1
  on p.projectid = p1.projectid
  
  left join ds_mysql_prod_tagelement foc
  on p1.focus_area = foc.id
  
  left join ds_mysql_prod_tagelement as Parent_Focus_Area
on p1.focus_area = Parent_Focus_Area.id
  
  left join ds_mysql_prod_tagelement as Parent_Focus_Area_parent
on Parent_Focus_Area.parent = Parent_Focus_Area_parent.id
  
  left join ds_mysql_prod_tagelement proj
  on p.projectid = proj.id
  ),
  t2 as
  (
	select proj_update, fy_timerange, sum(disbursed) as Total_Amount_disbursed, focus_area_updated, Parent_Focus_Area_parent from t1
	
	group by proj_update, fy_timerange, focus_area_updated, Parent_Focus_Area_parent
	)
	select * from t2