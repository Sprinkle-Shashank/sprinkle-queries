
with sub1 as (
Select p1.name as projectid,p.timerange_timerange,p.num_female,p.num_female,t1.name as training_type,t2.name as year,t3.name as country, a.vendor,a.cycle,a.product_category,b.name as consultant
from profile_61528 p 
left join ds_mysql_prod_project p1 on p1.id = p.projectid

left join profile_64362 a on a.projectid = p.projectid
left join profile_61583 b on b._id = a.consultant

left join ds_mysql_prod_tagelement t1 on t1.id = p.training_type
left join ds_mysql_prod_tagelement t2 on t2.id = p.year
left join ds_mysql_prod_tagelement t3 on t3.id = a.country),

sub2 as ( Select c.*,unwind_cycle from sub1 c , c.cycle unwind_cycle )


Select d.projectid,d.timerange_timerange,d.num_female,d.num_male,d.training_type,d.year,d.country,d.vendor,d.consultant,t1.name as cycle from sub2 d
left join ds_mysql_prod_tagelement t1 on t1.id = sub2.unwind_cycle