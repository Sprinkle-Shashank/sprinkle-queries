with lookup as (select 
				taskuserid, p._id, p.status, p.active, 
				taskuser.taskid 
				from ds_mongo_taskresponse p
								
left join ds_mysql_prod_taskuser taskuser on
taskuser.id = p.taskuserid
),

lookup1 as (select 
				taskid, p._id, p.status, p.active, p.taskid, 
				task.flowtaskid
				from lookup p
				
				
left join ds_mysql_prod_task task on
task.id = p.taskid
),

lookup2 as (select 
			taskuserid, p._id, p.status, p.active, p.taskid, flowtaskid, 
			projectflow.projectid, 
			flowtask.sectionid
			from lookup p
 			
left join ds_mysql_prod_flowtask flowtask on 
flowtask.id = p.flowtaskid			
),

lookup3 as (select 
			taskid, p._id, p.status, p.active,  userid, programid, flowtaskid, projectid, sectionid, 
			section.profileid
			from lookup2 p
  
left join ds_mysql_prod_section section on
section.id = p.sectionid		
)

select taskid, _id, userid, programid, flowtaskid, projectid, sectionid, profileid 
from lookup3 p 
where (profileid = 145 or profileid = 36901) and status = 'REJECTED' and active = 't'