select p2.name as partner, p.fy_timerange,t3.name as district, t4.name as state, t8.name as domain,count(*),
case when t1.name = 'Yes' then 1 else 0 end as bene_enrolled,
case when t2.name = 'Yes' then 1 else 0 end as bene_training,
case when t5.name = 'Yes' then 1 else 0 end as bene_placed,
case when t6.name = 'Yes' then 1 else 0 end as still_employed,
case when t7.name = 'Yes' then 1 else 0 end as bene_certified
from profile_81359 p

left join ds_mysql_prod_project p1 on p1.id = p.projectid
left join ds_mysql_prod_project p2 on p2.id = p1.parent

left join ds_mysql_prod_tagelement t1 on t1.id=p.bene_enrolled
left join ds_mysql_prod_tagelement t2 on t2.id=p.bene_training
left join ds_mysql_prod_tagelement t3 on t3.id=p.state_district
left join ds_mysql_prod_tagelement t4 on t4.id=t3.parent
left join ds_mysql_prod_tagelement t5 on t5.id=p.bene_placed
left join ds_mysql_prod_tagelement t6 on t6.id=p.still_employed
left join ds_mysql_prod_tagelement t7 on t7.id=p.bene_certified
left join ds_mysql_prod_tagelement t8 on t8.id=p.domain

--left join profile_81570 p3 on p3.beneficiary=p._id

group by p2.name, p.fy_timerange,t3.name, t4.name , t8.name , t1.name, t2.name,t5.name,t6.name,t7.name