with table1 as (select projectid,fy_timerange,fy,mwra_using_old,mwra_using_new,
row_number() over 
(--partition by sellerid
 order by fy_timerange asc) as row from profile_59872)
 
 select fy_timerange,row,mwra_using_old, case when mwra_using_old = 0 and row = 1 then 0
          else 386 end as R , 0 as temp,mwra_using_old,
		  sum(mwra_using_new+temp) over(order by fy_timerange rows between unbounded PRECEDING and current row) AS S 
		
 from table1

--order by fy_timerange asc