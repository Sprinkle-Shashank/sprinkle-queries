with table1 as (select pro.name as projectid,fy_timerange,fy,mwra_using_old,mwra_using_new,
row_number() over 
(--partition by sellerid
 order by fy_timerange asc) as row 
	from profile_59872 p
left join ds_mysql_prod_project as pro
on p.projectid = pro.id				   ),
 
 table2 as (select projectid,fy_timerange,row,mwra_using_old, 
 case when mwra_using_old = 0 and row = 1 then 0
          else 386 end as r , 0 as temp,mwra_using_new,
		  sum(mwra_using_new+temp) over(order by fy_timerange rows between unbounded               PRECEDING and current row) AS s ,r+s as fin_value
		
         from table1)
select projectid, fy_timerange,fin from table2		 

--order by fy_timerange asc