
with table1 as 
(
select p.projectid, projcode_factory , substring(projcode_factory,0,2) as projcode_factory_updated1 ,  pr_27.select_modules as select_modules, b_outcome_yn from profile_54646 p

left join profile_4227 pr_27 on 
p.projectid = pr_27.projectid
 )
 
select tab1.* , cast(c as varchar) as select_mod , case when projcode_factory_updated1='C' then 'Not applicable'  when projcode_factory_updated1='F' and select_mod <> 64503 then 'not applicable' end as business_outcomes , from table1 tab1 , tab1.select_modules c


/*
Check if Project Code is "FXXX"
 For the Projects if select_modules == 64503
 b_outcome_yn == Yes 
 1. Not applicable: WHERE {projcode_factory} == "CPXXX" Color colding will be grey. Where project code is "FXXX" and select_modules != 64503 color coding will be grey
 
 Check if Project Code is "FXXX"
 For the Projects if select_modules == 64503 AND b_outcome_yn == Yes
 2. {Completed}: Date of submission of the Business outcome tracking section when it is filled. Color coding will be green.
 3. {Upcoming} - current date >= end_date_2 AND < end_date_2 + 90 days color coding will be Yellow 
 4. {Past Due date} - When current date >= end_date_2+90 days. Color coding will be red.

Show legends: Red - Past due date, Yellow - Upcoming, Green - Completed

*/