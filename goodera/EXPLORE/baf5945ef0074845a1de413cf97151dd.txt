with sub1 as(select p1.project_name ,
			  cast(p1.start_date as date) as start_date, cast(p2.offset_date as date) as offset_date,
			 case
	when p4.projcode_factory like 'C%' or p4.projcode_factory like '%PVH' then 1 
	else 0
end as filter,
			 p2.pvh_id
			 from profile_62491 p1
			 left join profile_62948 p2 on p2.project_id = p1.project_id
			 left join profile_60928 p3 on p2.pvh_id = p3.factory_id
left join profile_62482 p4 on p4.project_id = p1.project_id
where  start_date >= nvl(offset_date,'2020-02-01') and filter = 1
and nvl(p1.lg_status,0) != 1105812 --and p2.pvh_id is not NULL
			 )
select * from sub1 
/*with tab as (select p.profileid as pid1, 
				case when pid1 = '54963' then 1 else 0 end as idstatus,
				p.status as statusfinal,
				case when p.status = 'SUBMITTED'  or p.status = 'PENDING_APPROVAL' then 1 else 0 end as status1,
			 f.name as fy_timerange,
			 case when p.data.subcat_output is null then 0 else 1 end as output

		from ds_mongo_taskresponse p
			 
left join profile_54963 data54963 on 
data54963._id = p.profileInstanceId
			 
left join ds_mysql_prod_tagelement f on
data54963.fy=f.id
)

select * from tab p where fy_timerange = '2022-2023' and idstatus = 1 and status1 = 1 and output = 1*/