
SELECT projectid,year.name as year,participant_id,
CASE 
WHEN projectid IS NOT NULL
THEN 1
ELSE 0
END AS count,
CASE
WHEN participant_id IS NULL
THEN 'y'
ELSE participant_id
END AS participant_id_1
 
 from profile_29179 p
 							
  
 left join ds_mysql_prod_tagelement year
 on p.year = year.id 
  
 WHERE lg_status <> 847851 and 
 participant_id_1 <> 'y' 
 
 
 GROUP BY projectid, year.name , participant_id
 ORDER BY participant_id ASC