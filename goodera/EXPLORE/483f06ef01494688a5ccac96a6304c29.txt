with sub1 as(select t._id, fy_timerange, location, year, notes, partner, country, region, beneficiaries_enrolled_for_first_time, beneficiaries_completing_vocational_training, multiple_ethnicity_beneficiaries, male_indirect_beneficiaries, pwd_indirect, beneficiaries_enrolled, underrepresented_beneficiaries_direct, underrepresented_beneficiaries_indirect, age_below_5_years_indirect, age_11_to_13_years_direct, neither_gender_indirect_beneficiaries, beneficiaries_completed_the_program, latinx_hispanic_beneficiaries, beneficiary_learning_training_hours, age_29_to_32_years_indirect, beneficiaries_placed_in_an_internship_job_shadow, age_24_to_28_years_direct, age_19_to_23_years_indirect, age_below_5_years_direct, age_33_to_36_years_indirect, beneficiaries_placed_in_full_time_job, male_direct_beneficiaries, female_indirect_beneficiaries, age_33_to_36_years_direct, neither_gender_direct_beneficiaries, no_gender_disclosure_indirect_beneficiaries, age_above_37_years_indirect, pwd_direct, no_gender_disclosure_direct_beneficiaries, age_11_to_13_years_indirect, african_american_beneficiaries, age_6_to_10_years_indirect, age_14_to_18_years_indirect, female_direct_beneficiaries, age_above_37_years_direct, age_6_to_10_years_direct, beneficiaries_successfully_receiving_certification, age_14_to_18_years_direct, age_29_to_32_years_direct, age_24_to_28_years_indirect, asian_beneficiaries, age_19_to_23_years_direct, beneficiaries_indirect, latinx_hispanic_beneficiaries_indirect, african_american_beneficiaries_indirect, asian_beneficiaries_indirect, multiple_ethnicity_beneficiaries_indirect, age_unreported_direct, american_indian_alaskan_beneficiaries, hawaiian_pacific_islander_beneficiaries, white_beneficiaries, ethnicity_not_specified_beneficiaries, american_indian_alaskan_beneficiaries_indirect, hawaiian_pacific_islander_beneficiaries_indirect, white_beneficiaries_indirect, ethnicity_not_specified_beneficiaries_indirect, program_name,t.end_date,
case 
  when (extract(month from t.end_date) <=2) then ('FY' || (extract(year from t.end_date)-2000))
  when (extract(month from t.end_date) >2) then ('FY'|| (extract(year from t.end_date)+1-2000))
  end as FY
from profile_67395
left join profile_62886 t
on t._id =program_name
)


select * from sub1