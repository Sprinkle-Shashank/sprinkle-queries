SELECT t1.name as location, t2.name as type_of_school, timerange_timerange, sum(number_of_students) AS Total,count(*) AS Schools,
CASE 
	WHEN type_of_school=46509 THEN 1
	WHEN type_of_school=46510 THEN 3
	WHEN type_of_school=46511 THEN 4
	WHEN type_of_school=695348 THEN 2
	ELSE 0
END AS sort_school_type
FROM profile_4018
left join ds_mysql_prod_tagelement t1
on t1.id=location
left join ds_mysql_prod_tagelement t2
on t2.id=type_of_school
GROUP BY t1.name, t2.name, timerange_timerange