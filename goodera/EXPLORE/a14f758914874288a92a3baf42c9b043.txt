with main as(
Select prod.name AS projectId, timerange_timerange,
  case
  	when t2.name='Q1' then 1
    when t2.name='Q2' then 2
  	when t2.name='Q3' then 3
  	when t2.name='Q4' then 4
  end as quarter
FROM profile_3537
left join  ds_mysql_prod_project prod  on
prod.id=projectid
left join  ds_mysql_prod_tagelement t2  on
t2.id=quarter
WHERE timerange_timerange is not null
ORDER BY projectId asc, timerange_timerange asc, quarter desc)

Select projectId, timerange_timerange, listagg(quarter)
from main
group by projectId, timerange_timerange