with sub1 as(select t1.name as sub_location, count(*) as count,p2.imple_partner as impl_partner,p4.name as van,
case 
  		when (p2.date_yn = 28005) 
  			then 
  				p2.date_n
  		else p2.createddate
  	end as date

from profile_58474 p1
			
left join profile_58511 p2 on p2._id=p1.sel_camp
left join ds_mysql_prod_project p4 on p1.projectid = p4.id
left join profile_49219t p5 on p5.id=p2.location	
			 
where p2.name <> ''
group by t1.name,p2.imple_partner,date,p4.name,van)
select sub_location,count,impl_partner as name,date,van
from sub1