with tab1 as(Select projectId, nutri_atten, malnourish, breastfed, improvement, session_caregiver, train_atten, aww_train, monitoring, training, visit, awareness, sno, furniture, toys, regularity, session_parent, enroll, wall, do_not_use,
cast(fy_timerange.start as date) as start,extract(month from start) as month,extract(year from start) as year,
Case 
When month=1 then 'Q4'
When month=2 then 'Q4'
When month=3 then 'Q4'
When month=4 then 'Q1'
When month=5 then 'Q1'
When month=6 then 'Q1'
When month=7 then 'Q2'
When month=8 then 'Q2'
When month=9 then 'Q2'
When month=10 then 'Q3'
When month=11 then 'Q3'
When month=12 then 'Q3'
Else 'No Data Entry'
End as quarter,
year || '-'||quarter as y,
Case
when base_tar is null then y
else base_tar
end as Period,
Case
when nutri_atten is null then 0
else nutri_atten
end as nutri_atten_2,
Case
when malnourish is null then 0
else malnourish
end as malnourish_2,
Case
when breastfed is null then 0
else breastfed
end as breastfed_2,
Case
when improvement is null then 0
else improvement
end as improvement_2,
Case
when session_caregiver is null then 0
else session_caregiver
end as session_caregiver_2,
Case
when train_atten is null then 0
else train_atten
end as train_atten_2,
Case
when aww_train is null then 0
else aww_train
end as aww_train_2,
Case
when monitoring is null then 0
else monitoring
end as monitoring_2,
Case
when training is null then 0
else training
end as training_2,
Case
when visit is null then 0
else visit
end as visit_2,
Case
when awareness is null then 0
else awareness
end as awareness_2,
Case
when furniture is null then 0
else furniture
end as furniture_2,
Case
when toys is null then 0
else toys
end as toys_2,
Case
when regularity is null then 0
else regularity
end as regularity_2,
Case
when session_parent is null then 0
else session_parent
end as session_parent_2,
Case
when enroll is null then 0
else enroll
end as enroll_2,
Case
when wall is null then 0
else wall
end as wall_2,
Case
when sno is null then 0
else sno
end as sno_2,
base_tar, fy_timerange,
concat(concat(concat(concat('{"start":"','2017-04-01T00:00:00.000Z'),'","end":"'),'2025-04-01T00:00:00.000Z'),'"}') as fy_test,

cast('{"start": "2017-04-01T00:00:00.000Z","end": "2025-04-01T00:00:00.000Z"}' as varchar) as fy_test_2

from profile_62950
where fy_timerange is not null
group by projectId, base_tar, do_not_use, start, year, quarter, y, Period, nutri_atten, malnourish, breastfed, improvement, session_caregiver, train_atten, aww_train, monitoring, training, visit, awareness, furniture, toys, regularity, session_parent, enroll, wall, sno, fy_timerange, month)
,
ss as (
Select 
Case
when base_tar not in ('Target','Baseline') then fy_timerange
else cast(fy_test_2 as varchar) 
end as fy_timerange_2

from tab1
)

Select replace(fy_timerange_2,'\','') as fy_timerange_2
from ss