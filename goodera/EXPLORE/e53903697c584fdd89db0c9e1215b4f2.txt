select substring(p.submission_date,6,2) as months
FROM profile_27398 p
/*With tab1 as(Select split_part(split_part(prod.name,'|',1),'.',1) as projectcode,
t.name as fy_timerange,
concat(projectcode,fy_timerange) as CODE,sum(p.hdfc_cost_monthly) as hdfc_cost,t2.name as Quarter,p1.village,p1.state
from profile_29974 p
left join ds_mysql_prod_project prod on
prod.id=p.projectid
left join ds_mysql_prod_tagelement t
on p.fy=t.id
left join ds_mysql_prod_tagelement t1
on p.month_number=t1.id
left join ds_mysql_prod_tagelement t2
on t1.parent=t2.id
left join profile_27489 p1 on
split_part(prod.name,'|',3)=p1.name
group by 1,2,3,5,6,7),

tab2 as (Select split_part(split_part(prod.name,'|',1),'.',1) as projectcode,
t.name as fy_timerange,
concat(projectcode,fy_timerange) as CODE,sum(p.monthly_cost) as monthlycost ,t2.name as Quarter
from profile_30171 p
left join ds_mysql_prod_project prod on
prod.id=p.projectid
left join ds_mysql_prod_tagelement t
on p.fy=t.id
left join ds_mysql_prod_tagelement t1
on p.month_number=t1.id
left join ds_mysql_prod_tagelement t2
on t1.parent=t2.id
group by 1,2,3,5),

tab3 as(Select t.projectcode as projectcode,t.fy_timerange fy,t.quarter Quarter,t.CODE as CODE,(t.hdfc_cost+t1.monthlycost) as Allocated,t.village Village,t.state State
from tab1 t
left join tab2 t1 on
t.CODE=t1.CODE and t.Quarter=t1.Quarter),

tab4 as(select p1.name as projectcode ,sum(d.payment_amount) as DisbursedAmount,sum(d.amnt_utlzd) as Utilized,t1.name as Quarter, f.name  as financial_year,concat(projectcode,financial_year) as CODE,t3.name as Core_Ares,t4.name as ProjectManager,p6.name as Intervention_Type,p7.name as Ngo_Partner
from profile_27396 p1
left join profile_27398 d on
p1._id=d.project_name 
left join ds_mysql_prod_tagelement t1 on
d.tranche=t1.id 
left join ds_mysql_prod_tagelement f on
d.fy=f.id 
left join ds_mysql_prod_tagelement t3
on p1.focus_area=t3.id
left join ds_mysql_prod_tagelement t4
on p1.project_manager=t4.id
left join profile_28235 p6
on p1.intervention_type=p6._id
left join profile_27395 p7
on p1.ngo_partner=p7._id
group by f.name,p1.name,t3.name,t4.name,P6.NAME,P7.NAME,t1.name)

Select t1.projectcode,t1.fy,t1.Quarter,t1.Allocated,t1.Village,t1.State,t2.DisbursedAmount,t2.Utilized,t2.Core_Ares,
t2.ProjectManager,t2.Intervention_Type,t2.Ngo_Partner
From tab3 t1
left join tab4 t2
on t1.CODE=t2.CODE*/


/*Select t1.name as FY, p2.name as ProjectCode, p1.village_name as Village,t2.name as Output_Statement, t3.name Output_Indicator, p1.planned_q1, p1.planned_q2, p1.planned_q3, p1.planned_q4, p1.progress_q2, p1.progress_q4, p1.baseline,p1.progress_q3
from profile_27417 p1
left join profile_27396 p2
on p1.prj_code=p2._id
left join ds_mysql_prod_tagelement t1
on p1.fy=t1.id
left join ds_mysql_prod_tagelement t2
on p1.op_statement_new=t2.id
left join ds_mysql_prod_tagelement t3
on p1.op_indic_new=t3.id
group  by t2.name,t1.name,p2.name, p1.village_name, t3.name, p1.planned_q1, p1.planned_q2, p1.planned_q3, p1.planned_q4, p1.progress_q2, p1.progress_q4, p1.baseline,p1.progress_q3*/

/*Select t.name as fy,p3.projectid as Project_Code,p2.hdfc_cost_monthly,p3.monthly_cost as monthly,p4.name
from profile_27396 p1
left join profile_29974 p2
on p1._id=p2.prj_code
left join profile_30171 p3
on p1._id=p3.prj_code
left join ds_mysql_prod_tagelement t
on p1.fy=t.id
left join profile_28235 p4
on p4._id=p1.intervention_type*/

/*Select t1.name as FY, p2.name as ProjectCode, p1.village_name as Village,t2.name as Output_Statement, t3.name Output_Indicator, p1.planned_q1, p1.planned_q2, p1.planned_q3, p1.planned_q4, p1.progress_q2, p1.progress_q4, p1.baseline,p1.progress_q3
from profile_27417 p1
left join profile_27396 p2
on p1.prj_code=p2._id
left join ds_mysql_prod_tagelement t1
on p1.fy=t1.id
left join ds_mysql_prod_tagelement t2
on p1.op_statement_new=t2.id
left join ds_mysql_prod_tagelement t3
on p1.op_indic_new=t3.id
group  by t2.name,t1.name,p2.name, p1.village_name, t3.name, p1.planned_q1, p1.planned_q2, p1.planned_q3, p1.planned_q4, p1.progress_q2, p1.progress_q4, p1.baseline,p1.progress_q3*/

/*With x as(Select distinct(p9.village) as Village,p9.state as State,p1.name pd,t2.name as Quarter
from profile_29974 p8
left join ds_mysql_prod_project t5
on p8.projectid=t5.id
left join profile_27489 p9
on split_part(t5.name,'|',3)=p9.name
left join profile_27396 p1
on p1._id=p8.prj_code
left join ds_mysql_prod_tagelement t1
on p8.month_number=t1.id
left join ds_mysql_prod_tagelement t2
on t1.parent=t2.id),

y as(select p1.name as projectcode ,sum(d.payment_amount) as DisbursedAmount,sum(d.amnt_utlzd) as Utilized, f.name  as financial_year,t3.name as Core_Ares,t4.name as ProjectManager,p6.name as Intervention_Type,p7.name as Ngo_Partner
from profile_27396 p1
left join profile_27398 d on
p1._id=d.project_name 
left join ds_mysql_prod_tagelement f on
d.fy=f.id 
left join ds_mysql_prod_tagelement t3
on p1.focus_area=t3.id
left join ds_mysql_prod_tagelement t4
on p1.project_manager=t4.id
left join profile_28235 p6
on p1.intervention_type=p6._id
left join profile_27395 p7
on p1.ngo_partner=p7._id
group by f.name,p1.name,t3.name,t4.name,P6.NAME,P7.NAME)

Select distinct(x.village),x.state,y.projectcode,y.DisbursedAmount,Y.Utilized,x.Quarter,y.financial_year,y.Core_Ares,
y.ProjectManager,y.Intervention_Type,y.Ngo_Partner
from x
left join y
on x.pd=y.projectcode*/