Select Type,Count,FY,Village
from (t1.name as financial_year, p.project_proposal as "Project Proposal",p.budget as "Budget File",p.monitoring_plan as "Project Monitoring Plan", p.rra_file as "RRA Report",p.impact_file as "Impact Report",p.pad_file as "Project Activities Details"
from profile_27396 p
left join profile_27420 q 
on q.project_code=p.name
left join ds_mysql_prod_tagelement t1
on p.fy = t1.id
group by financial_year)
unpivot
(Count for Type in 
 ("Project Proposal","RRA Report"))

/*With x as(Select distinct(p9.village) as Village,p9.state as State,p1.name pd,t2.name as Quarter
from profile_29974 p8
left join ds_mysql_prod_project t5
on p8.projectid=t5.id
left join profile_27489 p9
on split_part(t5.name,'|',3)=p9.name
left join profile_27396 p1
on p1._id=p8.prj_code
left join ds_mysql_prod_tagelement t1
on p8.month_number=t1.id
left join ds_mysql_prod_tagelement t2
on t1.parent=t2.id),

y as(select p1.name as projectcode ,sum(d.payment_amount) as DisbursedAmount,sum(d.amnt_utlzd) as Utilized, f.name  as financial_year,t3.name as Core_Ares,t4.name as ProjectManager,p6.name as Intervention_Type,p7.name as Ngo_Partner
from profile_27396 p1
left join profile_27398 d on
p1._id=d.project_name 
left join ds_mysql_prod_tagelement f on
d.fy=f.id 
left join ds_mysql_prod_tagelement t3
on p1.focus_area=t3.id
left join ds_mysql_prod_tagelement t4
on p1.project_manager=t4.id
left join profile_28235 p6
on p1.intervention_type=p6._id
left join profile_27395 p7
on p1.ngo_partner=p7._id
group by f.name,p1.name,t3.name,t4.name,P6.NAME,P7.NAME)

Select distinct(x.village),x.state,y.projectcode,y.DisbursedAmount,Y.Utilized,x.Quarter,y.financial_year,y.Core_Ares,
y.ProjectManager,y.Intervention_Type,y.Ngo_Partner
from x
left join y
on x.pd=y.projectcode*/