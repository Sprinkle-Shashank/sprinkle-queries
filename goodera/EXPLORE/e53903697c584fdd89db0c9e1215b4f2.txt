Select split_part(split_part(prod.name,'|',1),'.',1) as projectcode,
t.name as fy_timerange,
concat(projectcode,fy_timerange) as CODE,sum(p.hdfc_cost_monthly) as hdfc_cost,p1.village,p1.state,
case
when t2.name='January' then 'Quarter 4'
when t2.name='February' then 'Quarter 4'
when t2.name='March' then 'Quarter 4'
when t2.name='April' then 'Quarter 1'
when t2.name='May' then 'Quarter 1'
when t2.name='June' then 'Quarter 1'
when t2.name='July' then 'Quarter 2'
when t2.name='August' then 'Quarter 2'
when t2.name='September' then 'Quarter 2'
when t2.name='October' then 'Quarter 3'
when t2.name='November' then 'Quarter 3'
when t2.name='December' then 'Quarter 3'
end as Quarter

from profile_29974 p
left join ds_mysql_prod_project prod on
prod.id=p.projectid
left join ds_mysql_prod_tagelement t
on p.fy=t.id
left join ds_mysql_prod_tagelement t2
on p.month=t2.id
left join ds_mysql_prod_tagelement t1
on p.month_number=t1.id
left join profile_27489 p1 on
split_part(prod.name,'|',3)=p1.name
left join ds_mysql_prod_tagelement t3 on
p.month=t3.id
group by 1,2,3,5,6,7


/*Select t1.name as FY, p2.name as ProjectCode, p1.village_name as Village,t2.name as Output_Statement, t3.name Output_Indicator, p1.planned_q1, p1.planned_q2, p1.planned_q3, p1.planned_q4, p1.progress_q2, p1.progress_q4, p1.baseline,p1.progress_q3
from profile_27417 p1
left join profile_27396 p2
on p1.prj_code=p2._id
left join ds_mysql_prod_tagelement t1
on p1.fy=t1.id
left join ds_mysql_prod_tagelement t2
on p1.op_statement_new=t2.id
left join ds_mysql_prod_tagelement t3
on p1.op_indic_new=t3.id
group  by t2.name,t1.name,p2.name, p1.village_name, t3.name, p1.planned_q1, p1.planned_q2, p1.planned_q3, p1.planned_q4, p1.progress_q2, p1.progress_q4, p1.baseline,p1.progress_q3*/