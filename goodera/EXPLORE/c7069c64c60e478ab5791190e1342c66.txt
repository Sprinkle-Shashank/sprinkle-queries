with sub1 as(
  select p2.name as projectid, p3.name as country, p1.fy_timerange, p1.datanumbase, p1.keyword 
from sus_9539 p1

left join ds_mysql_prod_project p2 on p2.id = p1.xprojectid
left join ds_mysql_prod_project p3 on p3.id = p2.parent

where keyword in ('refrigerant_type_amount', 'co2_refilled', 'dry_powder_refilled', 'electric_consumption_1', 'electric_consumption_2', 'electric_consumption_3', 'solar_generation', 'water_consumption_1', 'water_consumption_2', 'water_consumption_3', 'waste_type') 

and datanumbase is not null and datanumbase != 0)

select projectid, country, fy_timerange, keyword, sum(datanumbase) as total
from sub1 
group by projectid, country, fy_timerange, keyword