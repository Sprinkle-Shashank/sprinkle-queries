with temp as (
Select 'GJ' as col
 union all
Select 'kwH' as col

),
s1 as (Select t.name as site,t1.name as sub_Region,t2.name as Region,
	   fy_timerange,
	   t3.name as Month,len(t3.name) as Month_Length,
	   (Month_length-7) as month_length1,substring(Month,1,month_length1) as Monthly,
	   --ubstring(fy_timerange.startdate,6,2) as time_month,
	   --extract(month from cast(fy_timerange as date)) as time_month,
      
	  Sum(CASE 
             WHEN keyword = 'electricity_usage' THEN datanumBase
             ELSE 0 
           END) AS Elec_usage,
		   Sum(CASE 
             WHEN keyword = 'propane_usage' THEN datanumBase
             ELSE 0 
           END) AS prop_usage,
		   Sum(CASE 
             WHEN keyword = 'diesel_fuel_usage' THEN datanumBase 
             ELSE 0 
           END) AS fuel_usage,
		   Sum(CASE 
             WHEN keyword = 'gasoline_usage' THEN datanumBase
             ELSE 0 
           END) AS gasoline_usage,
		   Sum(CASE 
             WHEN keyword = 'natural_gas_usage' THEN datanumBase
             ELSE 0 
           END) AS natural_gas_usage
		   from sus_56999 
		   left join ds_mysql_prod_project t
  on xprojectid=t.id
  left join ds_mysql_prod_project t1
  on t.parent=t1.id
  left join ds_mysql_prod_project t2
  on t1.parent=t2.id
	   left join ds_mysql_prod_tagelement t3
  on financialperiod=t3.id
	   
	   
		   where keyword in ('electricity_usage','propane_usage','diesel_fuel_usage','gasoline_usage','natural_gas_usage')
group by t.name,t2.name,t1.name,
	   fy_timerange,
	   t3.name
)
Select * from s1