with t1 as(select salary :: varchar
,
case
when p1.salary is not null then p1.salary
else 'not defined'
end as salary1
from profile_75132 p1
)
select t1.salary1,
case
when t1.salary1 < 30000 then '<30k' 
when t1.salary1 < 50000 then '30k-50k'
when t1.salary1 < 100001 then '50k-100k'
when  t1.salary1 < 150001 then '100k-150k'
when  t1.salary1  < 200001 then '150k-200k'
when  t1.salary1= 'not defined' then 'not defined'
else '>200k'
end as salary_bracket
from t1