select  p1._id, p1.fy_timerange, p1.line_item, tag2.name as category, p1.budgeted_amount, tag1.name as projectId , p2.amount_utilized ,p2.date
--first(p2.amount_utilized) :: INT as amount_utilized
--, Cast(first(p2.date) as date)
,budgeted_amount- amount_utilized as sub
case
when budgeted_amount >= amount_utilized then sub
else 0
end as unspent
from profile_74913 p1
left join profile_74914 as p2 on
p2.line_item = p1._id
left join ds_mysql_prod_project tag1
on p1.projectId = tag1.id
left join ds_mysql_prod_tagelement tag2
on p1.category = tag2.id

group by p1._id, p1.fy_timerange, p1.line_item, tag2.name , p1.budgeted_amount,tag1.name,p2.date
order by date desc



/*with t1 as 
(select fy_timerange, fy_timerange.start as start_date
from profile_71780),

t2 as 
(select fy_timerange, start_date :: date
from t1)

select fy_timerange, start_date, to_char(start_date, 'MM'), to_char(start_date, 'Month')
from t2*/