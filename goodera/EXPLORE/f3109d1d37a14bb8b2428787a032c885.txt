with t1 as 
(select p2.name as projectId, name_project, start_date :: timestamp, end_date :: timestamp, description, objectives, location :: super, name_coordinator, designation, email, tag2.name as focus_area, p1.sdg, tag3.name as schedule_vii, photo, phone_no, to_char(start_date, 'MM') as start_month, to_char(end_date, 'MM') as end_month, start_date|| '|' ||end_date as fy_timerange, to_char(start_date, 'DD') as start_day, to_char(end_date, 'DD') as end_day, to_char(start_date, 'YYYY') as start_year, to_char(end_date, 'YYYY') as end_year, p3.name as p3, p4.name as p4, p5.sdg_icon, loc

from profile_65003 p1
left join ds_mysql_prod_tagelement tag2
on p1.focus_area = tag2.id
left join ds_mysql_prod_tagelement tag3
on p1.schedule_vii = tag3.id

left join ds_mysql_prod_project p2 on p2.id = p1.projectid
left join ds_mysql_prod_project p3 on p3.id = p2.parent
left join ds_mysql_prod_project p4 on p4.id = p3.parent
--left join profile_65010 p2
--on p2.projectId = tag5.parent
left join profile_65010 p5 on p5.projectid=p3.parent)

select *, loc
from t1, t1.location loc









