with t1 as 
(select tag1.name as projectId, name_project, start_date :: timestamp, end_date :: timestamp, description, location, name_coordinator, designation, email, tag2.name as focus_area, sdg, tag3.name as schedule_vii, photo, phone_no, objectives, to_char(start_date, 'MM') as start_month, to_char(end_date, 'MM') as end_month, start_date|| '|' ||end_date as fy_timerange
from profile_65003 p1
left join ds_mysql_prod_project tag1
on p1.projectId = tag1.id
left join ds_mysql_prod_tagelement tag2
on p1.focus_area = tag2.id
left join ds_mysql_prod_tagelement tag3
on p1.schedule_vii = tag3.id)

select t1.projectId, t1.name_project, t1.start_date, t1.end_date, t1.description, t1.location, t1.name_coordinator, t1.designation, t1.email, t1.focus_area, t1.sdg, t1.schedule_vii, t1.photo, t1.phone_no, t1.objectives, t1.start_month :: integer, t1.end_month :: integer, t1.fy_timerange,

case t1.start_month :: integer 
when t1.start_month :: integer = 1 then 'January'
when t1.start_month :: integer = 2 then 'February'
when t1.start_month :: integer = 3 then 'March'
when t1.start_month :: integer = 4 then 'April'
when t1.start_month :: integer = 5 then 'May'
when t1.start_month :: integer = 6 then 'June'
when t1.start_month :: integer = 7 then 'July'
when t1.start_month :: integer = 8 then 'August'
when t1.start_month :: integer = 9 then 'September'
when t1.start_month :: integer = 10 then 'October'
when t1.start_month :: integer = 11 then 'November'
when t1.start_month :: integer = 12 then 'December'
else 'null'
end as start_month1,

case t1.end_month :: integer 
when t1.end_month :: integer = 1 then 'January'
when t1.end_month :: integer = 2 then 'February'
when t1.end_month :: integer = 3 then 'March'
when t1.end_month :: integer = 4 then 'April'
when t1.end_month :: integer = 5 then 'May'
when t1.end_month :: integer = 6 then 'June'
when t1.end_month :: integer = 7 then 'July'
when t1.end_month :: integer = 8 then 'August'
when t1.end_month :: integer = 9 then 'September'
when t1.end_month :: integer = 10 then 'October'
when t1.end_month :: integer = 11 then 'November'
when t1.end_month :: integer = 12 then 'December'
else 'null'
end as end_month1

from t1

