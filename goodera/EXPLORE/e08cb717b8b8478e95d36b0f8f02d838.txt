Select fy_timerange, training,p1.school_name, t2.name as district,count(*),t1.name as state
FROM profile_76395 sq
LEFT JOIN profile_76387 p1
ON p1.id=sq.school_name
LEFT JOIN ds_mysql_prod_tagelement t
ON t.id=sq.state_district
left join ds_mysql_prod_tagelement t1
ON t1.id=t.parent
left join ds_mysql_prod_tagelement t2
ON t2.id=p1.state_district
GROUP BY fy_timerange, school_name, district, t2.name, training,t1.name