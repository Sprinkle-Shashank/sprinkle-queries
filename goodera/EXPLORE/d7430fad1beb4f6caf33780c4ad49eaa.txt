with table1 as (select p.projectId,p._id,p1.name_factory,p2.pace_status,row_number() over (partition by p.projectId order by p._id desc) as row from profile_52713 p

left join profile_54646 p1 on 
 p.projectid = p1.projid_factory

left join profile_54267 p2 on 
 p.projectid = p2.projectid

where sourcing_yn = 57472 and p2.pace_status = 845114 
),
table2 as (select t1.* from table1 t1 
	   where row =1),
	   
table3 as(Select p.projectId,p._id,p1.name_factory,p.pace_status_2 from profile_52713 p
		  
left join profile_54646 p1 on 
p.projectid = p1.projid_factory		  
	   
where sourcing_yn = 57473 and (p.pace_status_2 = 845114 or p.pace_status_2 is null)	   
),
table4 as(Select  p.projectId,p._id,p1.name_factory,p2.pace_status from profile_52713 p
		 
 left join profile_54646 p1 on 
p.projectid = p1.projid_factory	
		  
left join profile_4948 p2 on 
 p.projectid = p2.projectid

where p2.pace_status = 182398
),
table5 as(
Select name_factory from table2
Union all 
Select name_factory from table3
Union all
Select name_factory from table4
),
table6 as(select p.factory_vpid as location_id from profile_52713 p
		  ),
table7 as(Select p.cp_location_id as location_id from profile_4948 p
),
table8 as(
select location_id from table6 
union all
select loaction_id from table7
)
Select * from table8
		  
  
