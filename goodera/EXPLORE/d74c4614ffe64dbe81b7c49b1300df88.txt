

select fac.name as factoryname, p.name, other, trainer_organization, notes, photo, file, trainer, historical, keyword_1, num_female, num_male, num_middle, hours, total_participants, num_other, projectId , extract(year from date) as year, cou.name as country, ven.name as vendor 
from profile_64801 as p
  
 left join ds_mysql_prod_project fac 
on p.projectId = fac.id

 left join ds_mysql_prod_project ven 
on fac.parent = ven.id

 left join ds_mysql_prod_project cou 
on ven.parent = cou.id

where projectid != 13761
 group by p.name, other, trainer_organization, notes, photo, file, trainer, historical, keyword_1, num_female, num_male, num_middle, hours, total_participants, num_other, country, projectId, vendor_name, vendor, year, date