

select fac.name as factoryname, p.name, other, trainer_organization, notes, photo, file, trainer, historical, keyword_1, num_female, num_male, num_middle, hours, total_participants, num_other, projectId, projectId , extract(year from date).name as year, cou.name as country, ven.name as vendor /* ,check again later Field: vendor_nameExpression: mid($vendor,1,find($vendor," ("))  error in char  */  /*
SUBSTRING(ven.name, 1, CHARINDEX(ven.name,' c') ) as vendor_name */ /* , check again this also minor error */ /* ifelse( vendor_name="", ven.name, vendor_name) */ /* ,  ifelse(extract(month from date)=1,toString(extract(year from date)-1), toString(extract(year from date))) as year   check again this also minor error */
from profile_64801 as p
  
 left join ds_mysql_prod_project fac 
on p.projectId = fac.id

 left join ds_mysql_prod_project ven 
on fac.parent = ven.id

 left join ds_mysql_prod_project cou 
on ven.parent = cou.id

/* check again later Filter Field: countryCondition: project_is_notMatch Values: 13761   */
where projectid != 13761
 group by p.name, other, trainer_organization, notes, photo, file, trainer, historical, keyword_1, num_female, num_male, num_middle, hours, total_participants, num_other, cou.name as country, projectId, vendor_name, ven.name as vendor, year, date