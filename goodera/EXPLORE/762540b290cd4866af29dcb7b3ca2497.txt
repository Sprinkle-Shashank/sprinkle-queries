with table1 as (select t.projectId, ngo, schedule_vii, local_yn, project_start_date, project_end_date, imp_direct, csr_reg_num, state_district, ongoing, 
 		  concat(concat(concat(concat('{"start":"',project_start_date),'","end":"'),project_end_date),'"}') as duration,
		 sum(p2.prescribed_csr) as allocated
,
row_number() over 
(partition by t.projectid
 order by t._id desc) as row

from profile_46325 t

left join profile_76972 p2
on p2.projectid=t.projectid


left join profile_76976 p3
on p3.projectid=p2.projectid

left join profile_76977 p4
on p4.projectid=t.projectid



where ongoing is not null
Group By t._id,t.projectId, ngo, schedule_vii, local_yn, project_start_date, project_end_date, imp_direct, csr_reg_num, state_district, ongoing
)
select * from table1 where row=1
