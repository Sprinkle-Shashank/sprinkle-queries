with table1 as (select t.projectId,  ngo, schedule_vii, local_yn, project_start_date, project_end_date, imp_direct, csr_reg_num, state_district, ongoing, 
concat(concat(CASE 
    WHEN t.project_start_date IS NULL THEN '-' 
    ELSE to_char(t.project_start_date, 'YYYY-MM-DD')
END ,'  to  '),CASE 
    WHEN t.project_end_date IS NULL THEN '-' 
    ELSE to_char(t.project_end_date, 'YYYY-MM-DD')
END ) as duration,			t.fy_timerange,p3.amount as dis,p2.prescribed_csr as alo,p4.amount as uti,
				p3.amount-p4.amount as unspent,t1.name 
from profile_46325 t

left join profile_76972 p2
on p2.projectid=t.projectid


left join profile_76976 p3
on p3.projectid=t.projectid

left join profile_76977 p4
on p4.projectid=t.projectid
				
				
left join ds_mysql_prod_tagelement t1 on t1.id=t.state_district
left join ds_mysql_prod_tagelement t2 on t2.id=t1.parent

where ongoing is not null
Group By t.projectId , ngo, schedule_vii, local_yn, project_start_date, project_end_date, imp_direct, csr_reg_num, state_district, ongoing,t.fy_timerange,dis,alo,uti,unspent,t1.name
				order by t.fy_timerange desc
),

table2 as
(
select *, 
row_number() over 
(partition by project_start_date
 order by fy_timerange desc) as row from table1 
 )
 
 select * from table2 where row=1
 
 
