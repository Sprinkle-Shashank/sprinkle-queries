with table1 as (
 
  select t.projectId,   ongoing, csr_reg_num
		t.fy_timerange,p3.amount as dis,p2.prescribed_csr as alo
from profile_46325 t

left join profile_76972 p2
on p2.projectid=t.projectid


left join profile_76976 p3
on p3.projectid=t.projectid

left join profile_76977 p4
on p4.projectid=t.projectid
				
where ongoing is not null
  
Group By t.projectId , ongoing,dis,alo,t.fy_timerange,csr_reg_num


),


table2 as
(
select *, 
row_number() over 
(partition by projectId
 order by fy_timerange desc) as row from table1 
 )
 
 select * from table2 where row=1
 
 
