
select  p.projectId , ven.name as vendor , cou.name as country ,
p1.fac_cl_vpid, p1.vendor_ngo_id ,
primary_category1.name as primary_category ,
trainer_organization1.name as trainer_organization ,                 --1
training_type1.name as training_type,
local_foreign1.name as local_foreign

from profile_61572 p

--hirercy

left join ds_mysql_prod_project fac
on  p.projectid = fac.id
left join ds_mysql_prod_project ven
on fac.parent = ven.id
left join ds_mysql_prod_project cou
on ven.parent = cou.id

  
--lookup

left join profile_52810 p1
on p.projectId = p1.projectId
left join profile_64801 p2
on p.projectId = p1.projectId

--tag element

left join ds_mysql_prod_tagelement primary_category1 on
	p1.primary_category = primary_category1.id
left join ds_mysql_prod_tagelement trainer_organization1 on                    --1
	p.trainer_organization = trainer_organization1.id
left join ds_mysql_prod_tagelement training_type1 on
	p.training_type = training_type1.id
left join ds_mysql_prod_tagelement local_foreign1 on
	p.local_foreign = local_foreign1.id

--group by
group by  p.projectId , ven.name  , cou.name ,
p1.fac_cl_vpid, p1.vendor_ngo_id , primary_category1.name,
trainer_organization1.name ,training_type1.name,local_foreign1.name

union
select p3.trainer_organization, p3.submitter_indepth, p3.in_depth_training, p3.num_female, p3.num_male, p3.num_middle, p3.hours, p3.total_participants, p3.num_other, p3.date,
trainer_organization2.name as trainer_org_indepth
from profile_64801 p3

left join ds_mysql_prod_tagelement trainer_organization2 on 
	p3.trainer_organization = trainer_organization2.id

--group by
group by  p3.trainer_organization, p3.submitter_indepth, p3.in_depth_training, p3.num_female, p3.num_male, p3.num_middle, p3.hours, p3.total_participants, p3.num_other, p3.date,
trainer_organization2.name
  
