with table1 as(
  
select * from profile_61572 
),

table2 as 
(
   select p.* , cast(c as varchar)  as trainer_organization1 from table1 as p , p.trainer_organization as c
 ),
 
 table4 as 
 ( 
   select p.* , x2.name as trainer_organization  from table2 p
   

	 left join ds_mysql_prod_tagelement x2 on
 	 p.trainer_organization1 = x2.id
   ),
  
  
table3 as
( 
select  p.projectId , ven.name as vendor , cou.name as country ,
p1.fac_cl_vpid, p1.vendor_ngo_id , primary_category1.name as primary_category ,
p.trainer_organization ,p.training_type
from table2

--hirercy

left join ds_mysql_prod_project fac
on  p.projectid = fac.id
left join ds_mysql_prod_project ven
on fac.parent = ven.id
left join ds_mysql_prod_project cou
on ven.parent = cou.id

--tag element

left join ds_mysql_prod_tagelement primary_category1 on
p1.primary_category = primary_category1.id
  
--lookup

left join profile_52810 p1
on p.projectId = p1.projectId

--group by
group by  p.projectId , ven.name  , cou.name ,
p1.fac_cl_vpid, p1.vendor_ngo_id , p1.primary_category,
p.trainer_organization ,p.training_type
  
