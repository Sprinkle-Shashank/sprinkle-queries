with tab1 as (SELECT t.name as fy,q.name as project_code,t2.name as project_manager,
       Sum(CASE 
             WHEN p.budget_head = 'Admin Cost' THEN p.cost_yearly 
             ELSE 0 
           END) AS Admin_cost, 
       Sum(CASE 
             WHEN p.budget_head = 'Human Resource' THEN p.cost_yearly
             ELSE 0 
           END) AS Human_resource,
		   Sum(CASE 
             WHEN p.budget_head = 'NGO Management Cost' THEN p.cost_yearly
             ELSE 0 
           END) AS NGO_Management_Cost 
FROM   profile_29976 p
left join ds_mysql_prod_tagelement t on
p.fy=t.id
left join profile_27396 q on
p.prj_code=q._id
left join ds_mysql_prod_tagelement t2 on
q.project_manager=t2.id

GROUP  BY 1, 
          2,3),
tab2 as( select p.village_name,q.name as project_codes from profile_29973 p
			 left join profile_27396 q on
p.prj_code=q._id)

select  t.fy,t.project_code,t1.village_name,t.Admin_cost,t.Human_resource,t.NGO_Management_Cost,t.project_manager from tab1 t
left join tab2 t1 on
t.project_code=t1.project_codes