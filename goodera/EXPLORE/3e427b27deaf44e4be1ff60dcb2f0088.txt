with sub1 as(select p1.fy_timerange, p4.name as projectid, t1.name as village,1 as count,p2.name as activity,p3.name as participants,t2.name as caste,t3.name as age,t4.name as gender,count(p3.hh_id) as hh_total,SUM(p1.nyra_contri) as contri,extract(year from cast(p1.fy_timerange.start as date)) as start_year,p3.hh_id,

case
	when age < 18 then 'Below 18'
	when age > 17 and age < 41 then '18-40'
	when age > 40 and age < 60 then '18-45'
	when age > 60 then 'Above 60'
	else null
end as age_group

from profile_81209 p1
left join profile_81201 p2 on p2._id=p1.activity
left join profile_81185 p3 on p3._id=p1.participants
left join ds_mysql_prod_project p4 on p4.id=p1.projectid
left join ds_mysql_prod_tagelement t1 on t1.id=p1.village
left join ds_mysql_prod_tagelement t2 on t2.id=p3.caste
left join ds_mysql_prod_tagelement t3 on t3.id=p3.age
left join ds_mysql_prod_tagelement t4 on t4.id=p3.gender

group by p2.name,p1.fy_timerange,t1.name,p2.name,p3.name,t2.name,t3.name,t4.name,age_group,p4.name,start_year,p3.hh_id
),

sub2 as (select p1.fy_timerange, p4.name as projectid, t1.name as village,1 as count,p2.name as activity,p3.name as participants,t2.name as caste,t3.name as age,t4.name as gender,count(p3.hh_id) as hh_total,SUM(p1.nyra_contri) as contri,extract(year from cast(p1.fy_timerange.start as date)) as start_year,p3.hh_id,

case
	when age < 18 then 'Below 18'
	when age > 17 and age < 41 then '18-40'
	when age > 40 and age < 60 then '18-45'
	when age > 60 then 'Above 60'
	else null
end as age_group

from profile_81208 p1
left join profile_81201 p2 on p2._id=p1.activity
left join profile_81185 p3 on p3._id=p1.participants
left join ds_mysql_prod_project p4 on p4.id=p1.projectid
left join ds_mysql_prod_tagelement t1 on t1.id=p1.village
left join ds_mysql_prod_tagelement t2 on t2.id=p3.caste
left join ds_mysql_prod_tagelement t3 on t3.id=p3.age
left join ds_mysql_prod_tagelement t4 on t4.id=p3.gender

group by p2.name,p1.fy_timerange,t1.name,p2.name,p3.name,t2.name,t3.name,t4.name,age_group,p4.name,start_year,p3.hh_id),

sub3 as (select p1.fy_timerange, p4.name as projectid, t1.name as village,1 as count,p2.name as activity,p3.name as participants,t2.name as caste,t3.name as age,t4.name as gender,count(p3.hh_id) as hh_total,SUM(p1.nyra_contri) as contri,extract(year from cast(p1.fy_timerange.start as date)) as start_year,p3.hh_id,

case
	when age < 18 then 'Below 18'
	when age > 17 and age < 41 then '18-40'
	when age > 40 and age < 60 then '18-45'
	when age > 60 then 'Above 60'
	else null
end as age_group

from profile_81203 p1
left join profile_81201 p2 on p2._id=p1.activity
left join profile_81185 p3 on p3._id=p1.participants
left join ds_mysql_prod_project p4 on p4.id=p1.projectid
left join ds_mysql_prod_tagelement t1 on t1.id=p1.village
left join ds_mysql_prod_tagelement t2 on t2.id=p3.caste
left join ds_mysql_prod_tagelement t3 on t3.id=p3.age
left join ds_mysql_prod_tagelement t4 on t4.id=p3.gender

group by p2.name,p1.fy_timerange,t1.name,p2.name,p3.name,t2.name,t3.name,t4.name,age_group,p4.name,start_year,p3.hh_id),

sub4 as (select p1.fy_timerange, p4.name as projectid, t1.name as village,1 as count,p2.name as activity,p3.name as participants,t2.name as caste,t3.name as age,t4.name as gender,count(p3.hh_id) as hh_total,SUM(p1.nyra_contri) as contri,extract(year from cast(p1.fy_timerange.start as date)) as start_year,p3.hh_id,

case
	when age < 18 then 'Below 18'
	when age > 17 and age < 41 then '18-40'
	when age > 40 and age < 60 then '18-45'
	when age > 60 then 'Above 60'
	else null
end as age_group

from profile_81207 p1
left join profile_81201 p2 on p2._id=p1.activity
left join profile_81185 p3 on p3._id=p1.participants
left join ds_mysql_prod_project p4 on p4.id=p1.projectid
left join ds_mysql_prod_tagelement t1 on t1.id=p1.village
left join ds_mysql_prod_tagelement t2 on t2.id=p3.caste
left join ds_mysql_prod_tagelement t3 on t3.id=p3.age
left join ds_mysql_prod_tagelement t4 on t4.id=p3.gender

group by p2.name,p1.fy_timerange,t1.name,p2.name,p3.name,t2.name,t3.name,t4.name,age_group,p4.name,start_year,p3.hh_id),

sub5 as(select * from sub1
union all
select * from sub2
union all
select * from sub3
union all
select * from sub4)

select * from sub5
--fy_timerange, projectid, village,1 as count, activity, participants, caste, age, gender, hh_total from sub1,sub2,sub3,sub4
		 