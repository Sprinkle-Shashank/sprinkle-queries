with lookup as (select
				JSON_SERIALIZE(table_52810.pace_brands) as pace_brand,
				case when pace_brand like '%1151834%' then 1 else 0 end  as brand,
				SUBSTRING(p.name, 1, 2) as ExtractString,
				case when (ExtractString) like ' - '  then 0 else 1 end as ch,
				p.name as name,
				p.module_name as module_name,
				p.start_date as start_date,
				p.end_date as end_date,
				p.pre_post_yn as pre_post_yn,
				p.no_pre_assessment as no_pre_assessment,
				p.score as score,
				p.no_post_assessment as no_post_assessment,
				p.score2 as score2,
				p.attendance as attendance	
				
				from profile_4228 p
						
inner join profile_52810 table_52810 on
table_52810.projectid=p.projectid
				
inner join profile_4227 table_4227 on
table_4227.projectid=p.projectid
				
left join ds_mongo_taskresponse taskResponse on
taskResponse.profileinstanceid=p._id		
			
			   
order by extractstring)
--group by   pace_brand, p.projectid,brand,paceStatus,status,factory_name)
select * from lookup p where brand = 1 and ch =1