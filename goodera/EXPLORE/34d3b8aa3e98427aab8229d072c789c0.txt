with lookup as (select
				JSON_SERIALIZE(table_52810.pace_brands) as pace_brand,
				case when pace_brand like '%1151834%' then 1 else 0 end  as brand,
				SUBSTRING(p.name, 1, 2) as ExtractString,
				case when (ExtractString) like ' -' or (ExtractString) like '- ' then 0 else 1 end as ch,
				listagg(p.name) as name,
				p._id as id1,
				listagg(p.module_name) as module_name,
				listagg(p.start_date) as start_date,
				listagg(p.end_date) as end_date,
				listagg(p.pre_post_yn) as pre_post_yn,
				listagg(p.no_pre_assessment) as no_pre_assessment,
				listagg(p.score) as score,
				listagg(p.no_post_assessment) as no_post_assessment,
				listagg(p.score2) as score2,
				listagg(p.attendance) as attendance	
				
				from profile_4228 p
						
inner join profile_52810 table_52810 on
table_52810.projectid=p.projectid
				
inner join profile_4227 table_4227 on
table_4227.projectid=p.projectid
				
left join ds_mongo_taskresponse taskResponse on
taskResponse.profileinstanceid=p._id		
			
group by id1)
select * from lookup p where brand = 1 and ch =1