with temp as (
  select 'completed_training' as col
  union all
  select 'ongoing_training' as col
  union all
  select 'placed_count' as col),
sub1 as(
  select projectId, placed, center_location, fy_timerange, zone_db, partner_db, center_name_db, center_id_db, batch_id_db, batch_end_db from profile_145
  union all
  select projectId, placed, center_location, fy_timerange, zone_db, partner_db, center_name_db, center_id_db, batch_id_db, batch_end_db from profile_36901),
  sub2 as(
  select t2.name as project, p.projectId, placed, center_location, fy_timerange, zone_db, partner_db, center_name_db, center_id_db, substring(batch_end_db,1,10) as batch_end_db , batch_id_db, substring(getdate(),1,10) as today from sub1 p
	LEFT JOIN ds_mysql_prod_project t on p.projectId=t.id
LEFT JOIN ds_mysql_prod_project t1 on t.parent=t1.id
LEFT JOIN ds_mysql_prod_project t2 on t1.parent=t2.id)
select case when batch_end_db>=today then 1 else 0 end as app from sub2