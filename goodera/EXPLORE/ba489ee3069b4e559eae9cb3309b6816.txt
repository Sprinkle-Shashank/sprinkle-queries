select p.projectCode, profile_54963.fy, 
t.name as displayName
from profile_54963 
left join (select cast(x.id as varchar) as id, x.tagid, x.name, x.parent, x.sortorder, x.sourceid, x.start  from ds_mysql_tagelement x) t on profile_54963.fy=t.id 
left join (select cast(y.id as varchar) as id, y.programid, y.code, y.name, cast(SPLIT_PART(SPLIT_PART(y.name, '|', 1), '.', 1) as varchar) as projectCode, y.parent, y.projectmanagerids, y.dashboardids from ds_mysql_project y) p on profile_54963.projectid=p.id
left join (select cast(z._id as varchar) as recordId, z.project_manager from profile_27396 z) data_27396 on p.projectCode=data_27396.name

group by profile_54963.fy, t.name, p.name, p.projectCode
order by displayName
