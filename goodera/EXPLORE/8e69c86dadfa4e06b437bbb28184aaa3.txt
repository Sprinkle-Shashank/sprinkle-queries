Select prod.name as dataproj, split_part(prod.name,'|',1) as projectcode1, split_part(prod.name,'|',4) as prjmanager
from profile_59426 p
left join project_4188 prod on
prod.id=p.projectid

/*
with Lookup as
(select cast((split_part(split_part(prod.name,'|',1),'.',1)) as varchar) as ProjectCode,f.name as fy_timerange,CONCAT(ProjectCode,fy_timerange) as CODE
from profile_59426 p 
left join project_4188 prod on
prod.id=p.projectid
left join tagelement_4188 f on
p.fy=f.id
 group by ProjectCode, f.name
),
*/