
SELECT prod.name AS projectId, timerange_timerange,sum(amount_utilized) AS Utilized,
SUM(case
	when amount_rvd is NULL then 0
	else amount_rvd
	end) as Approved, (Approved-Utilized) to_be_spent, 
	cast(timerange_timerange.start as date) start, cast(timerange_timerange.end as date) end1,
concat(concat(projectId,start), end1) as CODE

FROM profile_3537

left join  ds_mysql_prod_tagelement t2  on
t2.id=year
left join  ds_mysql_prod_project prod  on
prod.id=projectid
WHERE timerange_timerange is not null
GROUP BY prod.name, timerange_timerange
ORDER BY timerange_timerange DESC, projectId DESC