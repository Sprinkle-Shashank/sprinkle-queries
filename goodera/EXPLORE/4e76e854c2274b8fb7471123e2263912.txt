with temp1 as
(select _id as old_id, projectId, project_code_new, amount, month_timerange, project_name, vertical, focus, direct_or_partner

 from profile_55194 as m
 
 left join profile_62881 AS r 
 on m.project_code_new = r._id
 
 where m.project_code_new IS NOT NULL AND r.project_name IS NOT NULL),
 
temp2 as
(select project_code_new, amount, month_timerange, project_name, vertical, focus, vertical_new
 from temp1 as m, m.vertical vertical_new),
 
temp3 as
(select project_code_new, amount, month_timerange, project_name, focus,
 
 case 
when vert1.name IS NULL AND vert.name IS NOT NULL THEN vert.name
when vert1.name IS NULL AND vert.name IS NULL then 'Admin'
else vert1.name 
END AS vertical

from temp2 AS m

left join ds_mysql_prod_tagelement as vert
  on m.vertical_new = vert.id
  
left join ds_mysql_prod_tagelement as vert1
  on vert.parent = vert1.id),
  
 temp4 as
(select 