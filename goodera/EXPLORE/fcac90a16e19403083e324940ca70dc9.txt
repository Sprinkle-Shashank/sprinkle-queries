Select t.name as site,t1.name as sub_region,t2.name as region,fy_timerange,
	sum(
  case
 when keyword='water_usage_new_water_reclaimed' then datanum
  else 0
  end )as water_usage_new_water_reclaimed,
  sum(
  case
 when keyword='total_water_usage' then datanum
  else 0
  end )as total_water_usage,
  sum(
  case
 when keyword='water_usage_reclaimed_storm' then datanum
  else 0
  end )as water_usage_reclaimed_storm,
  sum(
  case
 when keyword='water_usage_utility_provider' then datanum
  else 0
  end )as water_usage_utility_provider,
  sum(
  case
 when keyword='water_usage_well_water' then datanum
  else 0
  end )as water_usage_well_water
  
from sus_56999
left join ds_mysql_prod_project t
on xprojectid=t.id
left join ds_mysql_prod_project t1
on t.parent=t1.id
left join ds_mysql_prod_project t2
on t2.parent=t2.id

where keyword in ('water_usage_new_water_reclaimed', 'total_water_usage', 'water_usage_reclaimed_storm', 'water_usage_utility_provider', 'water_usage_well_water')
group by t.name,t1.name,t2.name,fy_timerange

