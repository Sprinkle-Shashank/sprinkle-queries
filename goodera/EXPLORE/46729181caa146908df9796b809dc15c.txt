with table1 AS 
(SELECT m.projectid, m._id, m.month_timerange AS fy_timerange, m.project_code_new, m.amount, r.project_name, r.vertical, r.focus , vert.name AS vertical2, vert_1.name AS vertical1,

case when vert.name IS NULL AND vert_1.name IS NOT NULL THEN vert.name 
when vert_1.name IS NULL AND vert.name IS NOT NULL THEN vert_1.name
when m.entity IS NULL THEN 'Mylan Pharmaceuticals Private Limited'
else 'Admin' 
END AS entity

FROM profile_55194 AS m

LEFT JOIN profile_62881 AS r 
 ON m.project_code_new = r._id),

left join ds_mysql_prod_tagelement as vert
  on r.vertical = vert.id

left join ds_mysql_prod_tagelement as vert_1
  on vert.parent = vert_1.id
  
left join ds_mysql_prod_tagelement as entity
  on m.entity = entity.id
  
table2 as 
( select p.*, q1 from table1 as p, p.vertical as q1)

select p.*, new_2.name AS verticals From table2
AS p

left join ds_mysql_prod_tagelement as new_1
  on p.q1 = new_1.id
  
left join ds_mysql_prod_tagelement as new_2
  on new_1.parent = new_2.id
	
ORDER BY p.project_code_new ASC