WITH Table1 AS 
(SELECT m.projectid, m._id, m.month_timerange AS fy_timerange, m.project_code_new, m.amount, r.project_name, r.vertical, r.focus, vert.name AS vertical2, vert_1.name AS vertical1,

case when vert.name IS NULL AND vert_1.name IS NOT NULL THEN vert.name 
when vert_1.name IS NULL AND vert.name IS NOT NULL THEN vert_1.name
when m.entity IS NULL THEN 'Mylan Pharmaceuticals Private Limited'
else 'Admin' 
END AS entity

FROM profile_55194 AS m

LEFT JOIN profile_62881 AS r 
 ON m.project_code_new = r._id

left join ds_mysql_prod_tagelement as vert
  on m.vertical = vert.id

left join ds_mysql_prod_tagelement as vert_1
  on vert.parent = vert_1.id
  
left join ds_mysql_prod_tagelement as entity
  on m.entity = entity.id),
  
table2 as 
( select p.*, q1 from table1 as p, p.vertical as q1)

Select p.*, new_1.name AS vertical From Table2
AS p

left join ds_mysql_prod_tagelement as new_1
  on p.q1 = new_1.id
	
/*GROUP BY m.projectid, m._id, m.month_timerange, m.project_code_new, r.project_name, r.vertical, r.focus, m.entity, vert.name, vert_1.name 

ORDER BY m.project_code_new ASC),*/