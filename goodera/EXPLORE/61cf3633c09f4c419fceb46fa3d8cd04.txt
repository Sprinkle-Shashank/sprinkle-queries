with sub1 as ( Select p.projectid , p.location ,p1.location as loc, p1.lat as latitude , p1.longi as longitude, p1.base_dist as base_distance from profile_58511 p
  
   left join profile_49219 p1
   on p.location = p1._id  
  
			  WHERE p1.location <> ' '
  
			 ),
			 
			 
 sub2 as ( 
   
   
			Select count(*) , p1.location , p2.location as loc from profile_58474 p
   
    left join profile_58511 p1
   on p.sel_camp = p1._id  
   left join profile_49219 p2
   on p1.location = p2._id  
    GROUP BY p1.location , p2.location 
   
   )
  
 Select count , sub2.loc , p3.lat as latitude , p3.longi as longitude, p3.base_dist from sub2
 LEFT JOIN sub1  p3 on 
 sub2.loc = sub1.loc
