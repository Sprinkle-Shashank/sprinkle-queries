with sub1 as (select p2.name as location, p1.lat as latitude,p1.longi as longitude,p1.base_dist as distance,count(*) as count
case 
  	when (p2.date_yn is not null and p2.date_yn = 28005 ) then p2.date_n
  	else p2.createddate
  	end as date


from profile_49219 p1
left join profile_58511 p2 on p2._id=p1.location
where p2.name <> ' ' and p2.name is not null
			 
			 )
			 
			 select * from sub1


