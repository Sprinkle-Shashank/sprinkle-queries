with t1 as 
(select tag1.name as projectid, fy_timerange, state, district, p2.name as location, villages, beneficiaries, drinking_water_cans, water_units, unit_capacity, water_cans_sold, water_available, 'Health & Hygiene' as theme, 'Water Purification Units' as Program, (water_units*unit_capacity) as total_capacity, fy_timerange.start :: date as start_date, fy_timerange.start :: date as end_date
from profile_51091 p1

left join ds_mysql_prod_project tag1
on p1.projectid = tag1.id
left join ds_mysql_prod_tagelement tag2
on p1.state = tag2.id
left join ds_mysql_prod_tagelement tag3
on p1.district = tag3.id
left join profile_83287 p2
on p1.location = p2._id )

select projectid, fy_timerange, state, district, location, villages, beneficiaries, drinking_water_cans, water_units, unit_capacity, water_cans_sold, water_available, theme, program, total_capacity, extract(year from start_date) as start_year, extract(year from end_date) as end_year
from t1










 














 



