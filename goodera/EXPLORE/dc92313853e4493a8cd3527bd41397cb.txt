--Yuva_gfc_heatmap


select fy_timerange, tag1.name as projectid, tag3.name as school_loc, tag4.name as state,
case when tag2.name is null then tag1.name else tag2.name end as donor,
case when tag4.name is null then tag3.name else tag4.name end as state_new
from profile_80582 p1
left join ds_mysql_prod_project tag1 
on tag1.id = p1.projectid
left join ds_mysql_prod_project tag2
on tag2.id = tag1.parent
left join ds_mysql_prod_tagelement tag3
on tag3.id = p1.school_loc
left join ds_mysql_prod_tagelement tag4
on tag4.id = tag3.parent







 



