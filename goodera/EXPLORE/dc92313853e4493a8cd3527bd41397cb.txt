with sub1 as (select a.*, unwind_schedule_7 from profile_75046 as a, a.schedule_7 as unwind_schedule_7),

t1 as 
(select projectId, unwind_schedule_7, start_date, end_date, description, logo, spoc, sdg_select, status, phone, fy_timerange, spoc || ' - ' || phone as spoc_details,
case 
when status = 1497035 then 'completed' 
else 'ongoing'
end as status_2, to_char(start_date, 'DD  Month YYYY') as start_date1, to_char(end_date, 'DD  Month YYYY') as end_date1
from sub1 p1)

select projectId, tag1.name as unwind_schedule_7, description, logo, sdg_select :: varchar, status, fy_timerange, spoc_details, status_2, start_date1 || ' - ' || end_date1 as duration
from t1
left join ds_mysql_prod_tagelement tag1
on t1.unwind_schedule_7 = tag1.id
group by 
projectId, tag1.name, description, logo, sdg_select :: varchar, status, fy_timerange, spoc_detail









