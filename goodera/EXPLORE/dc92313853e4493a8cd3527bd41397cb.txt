with t1 as 
(select _id, projectid, ngo, proj, tag1.name as proposed, tag2.name as approved, tag3.name as ongoing, tag4.name as completed, tag5.name as disqualify, 
case 
when tag1.name = 'Yes' or tag2.name = 'Yes' or tag3.name = 'Yes' or tag4.name = 'Yes' or  tag5.name = 'Yes' then 'Completed'
else 'NA'
end as Status 
from profile_70244 p1
left join ds_mysql_prod_tagelement tag1
on p1.proposed = tag1.id
left join ds_mysql_prod_tagelement tag2
on p1.approved = tag2.id
left join ds_mysql_prod_tagelement tag3
on p1.ongoing = tag3.id
left join ds_mysql_prod_tagelement tag4
on p1.completed = tag4.id 
left join ds_mysql_prod_tagelement tag5
on p1.disqualify = tag5.id)

select _id, projectid, ngo, proj, proposed, approved, ongoing, completed, disqualify, status,
case 
when proposed = 'Yes' and approved is null and ongoing is null and completed is null and disqualify is null then 'Proposed'
when approved = 'Yes' and proposed is null or 'Yes' and approved = 'Yes' and ongoing is null and completed is null and disqualify is null then 'Approved'
when ongoing = 'Yes' and proposed = 'Yes' and approved = 'Yes' and completed is null and disqualify is null then 'Ongoing'
when completed = 'Yes' and proposed = 'Yes' and approved = 'Yes' and ongoing = 'Yes' and disqualify is null then 'Completed'
when disqualify is null or 'Yes' and proposed is null or 'Yes' and approved is null or 'No' and ongoing is null and completed is null then 'Disqualified'
when proposed is null and approved is null and ongoing is null and completed is null and disqualify is null then 'NA'
end as status_new

from t1


 














 



