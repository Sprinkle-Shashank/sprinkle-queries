 with t1 as 
 (select count(*) as benef_1, p2.name as batch_id_1
 from profile_145 p1
 left join profile_196 p2
 on p1.batch_id = p2._id
 group by batch_id, p2.name),
 
 t2 as 
 (select batch_id_db as batch_id_2, count(*) as benef_2
from profile_36901 p1
group by batch_id_db),

t3 as 
(select t1.batch_id_1, t2.batch_id_2, t1.benef_1 :: float, t2.benef_2 :: float
from t1, t2)

select t3.batch_id_1, t3.batch_id_2, sum(t3.benef_1, t3.benef_2) as a

 
 
 

 



