with t1 as 
(select tag1.name as projectid, tag2.name as fy_1, tag3.name as state, tag4.name as district, location, fy_timerange, villages, beneficiaries, drinking_water_cans, water_units, water_cans_sold, water_available, 'Health & Hygiene' as theme, 'Water Purification Units' as Program, fy_timerange.start :: date as start_date, fy_timerange.start :: date as end_date
from profile_51091 p1

left join ds_mysql_prod_project tag1
on p1.projectid = tag1.id
left join ds_mysql_prod_tagelement tag2
on p1.fy_1 = tag2.id
left join ds_mysql_prod_tagelement tag3
on p1.state = tag3.id
left join ds_mysql_prod_tagelement tag4
on p1.district = tag4.id)

select *, extract(year from start_date) as start_year, extract(year from end_date) as end_year, start_year || ' - ' || end_year
from t1











 














 



