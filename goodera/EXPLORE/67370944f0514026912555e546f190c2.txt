with tab1 as (select p1.allocation,p1.fy_timerange,t1.name as entity,t2.name as focus,sum(allocation) as sum
from profile_61799 p1
left join ds_mysql_prod_tagelement t1
on t1.id = p1.entity
left join ds_mysql_prod_tagelement t2
on t2.id = p1.focus
			 group by 1,2,3,4)
			 
			 Select fy_timerange,distinct(entity),focus,sum
			 from tab1