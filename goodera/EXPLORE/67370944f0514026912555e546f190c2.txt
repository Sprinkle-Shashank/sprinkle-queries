with tab1 as (select P.name as projectname,sum(p1.allocation),p1.fy_timerange,t1.name as entity,t2.name as focus
from profile_61799 p1
left join ds_mysql_prod_tagelement t1
on t1.id = p1.entity
left join ds_mysql_prod_tagelement t2
on t2.id = p1.focus
LEFT JOIN ds_mysql_prod_project AS P
ON p1.projectid = P.id
where entity is not null
group by 1,3,4,5),

tab2 as 
(Select projectname,sum,fy_timerange,entity,focus,
		 LAG(sum,1)
		 OVER (PARTITION BY focus ORDER BY [fy_timerange] AS V1,
		 LAG(fy_timerange,1)
		 OVER (PARTITION NY indicator ORDER BY [fy_timerange]) AS V2
			 from tab1)
		 Select projectname,sum,fy_timerange,entity,focus,V1,V2
		 from tab2
			 
	
	
	
	/*tab3 as (Select indicator, [Year1], value,fy_timerange,
LAG (value,1)
OVER (PARTITION BY indicator ORDER BY [Year1]) AS PrevYearRevenue1, 
LAG (year1,1)
OVER (PARTITION BY indicator ORDER BY [Year1]) AS PrevYear 
from tab2
ORDER BY indicator, [Year1]
),*/
