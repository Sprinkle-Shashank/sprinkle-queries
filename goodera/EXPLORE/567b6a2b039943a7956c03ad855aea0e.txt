select fy_timerange,tag1.name as gender ,plac_income,
case
when plac_income <30000 then'<30k'
when plac_income <50000 then '30k-50k'
when plac_income <100001 then '50k-100k'
when plac_income <150001 then '100k-150k'
when plac_income <200001 then '150k-200k'
else '>200k'
end as salary_bracket,count(*)
from profile_76123 p1
left join ds_mysql_prod_tagelement as tag1
on p1.gender = tag1.id
where plac_income is not null
group by fy_timerange,tag1.name  ,plac_income, salary_bracket,count