With query1 as (Select (q1+q2+q3+q4) as allocated,project_name,t1.name as year,t2.name as entity
From profile_61799
left join ds_mysql_prod_tagelement t1
on year=t1.id
left join ds_mysql_prod_tagelement t2
on entity=t2.id
where project_name = 1064011
group by project_name,t1.name,t2.name,allocated),

query2 as(
Select q1 as previous, (q2+q3+q4) as current,t1.name as year,t2.name as entity
From profile_61799
left join ds_mysql_prod_tagelement t1
on year=t1.id
left join ds_mysql_prod_tagelement t2
on entity=t2.id
where project_name = 1064011
group by previous,current,t1.name,t2.name
),

query3 as( Select month_timerange as fy_timerange,sum(amount)
From profile_55698
Where projectId = 43294
group by month_timerange),

query4 as( Select fy_timerange,
Case
		  When category = 948972 then sum(amount) 
		  When category = 929913 then sum(amount)
          When category = 929912 then sum(amount)
END AS Amount, t1.name as category
From profile_55699
left join ds_mysql_prod_tagelement t1
on t1.id=category
where projectId = 43294
group by t1.name,fy_timerange
)

Select * from query4