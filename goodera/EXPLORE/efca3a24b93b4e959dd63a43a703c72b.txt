--EIL_project_documentation_table3
with table1 as
(
  select proj.name as projectid,p._id, p.fy_timerange,	projects	,quarter_report,	p.ngo	, impact,annual_report,	mou	,remarks,link, p.name , ng.name as ngo_update, 
  
 case when is_array(q1_file) = false or get_array_length(q1_file) = 0 then array(q1_file)
else (q1_file) end as q1_file_n , 
 case when is_array(q2_file) = false or get_array_length(q2_file) = 0 then array(q2_file)
else (q2_file) end as q2_file_n ,
case when is_array(q3_file) = false or get_array_length(q3_file) = 0 then array(q3_file)
else (q3_file) end as q3_file_n ,
case when is_array(q4_file) = false or get_array_length(q4_file) = 0 then array(q4_file)
else (q4_file) end as q4_file_n ,
case when is_array(annual_report) = false or get_array_length(annual_report) = 0 then array(annual_report)
else (annual_report) end as annual_report_n ,
case when is_array(mou) = false or get_array_length(mou) = 0 then array(mou)
else (mou) end as mou_n ,
case when is_array(quarter_report) = false or get_array_length(quarter_report) = 0 then array(quarter_report) else (quarter_report) end as quarter_report_n ,
   q1_file , q2_file , q3_file, q4_file from profile_83043 as p
  
  left join ds_mysql_prod_tagelement ng
  on p.ngo = ng.id
  
  left join ds_mysql_prod_project proj
  on p.projectid = proj.id
)

select * from table1 