--Tally_Amount_Disbursed_Rainbow Homes
with t1 as 
(select fy_timerange, sum(disbursed) as disbursed, p.name as projectid, fy_timerange.start as start_date, fy_timerange.end as end_date,

case
	when p.name like '%ANC%' then 'Rainbow Homes (ANC Rainbow Homes)'
	when p.name like '%Bosco%' then 'Rainbow Homes (Bosco Rainbow Homes)'
	when p.name like '%Sanrakshan%' then 'Rainbow Homes (Sanrakshan Rainbow Homes)'
	else NULL
end as projectid_old

from profile_79979

left join ds_mysql_prod_project p
on p.id=projectid

--where disbursed is not null and 
--(p.name like '%ANC%' or p.name like '%Bosco%' or p.name like '%Sanrakshan%') 

group by fy_timerange, p.name),

t2 as 
(select fy_timerange, disbursed, projectid, start_date :: date, end_date :: date, projectid_old
from t1
where projectid_old is not null)

select fy_timerange, disbursed, projectid, to_char(start_date, 'YYYY') as start_date_Year, to_char(end_date, 'YYYY') as end_date_year
from t1





