with sub1 as(
SELECT sq.project_id, sq.pvh_id,  pd.region
from profile_62948 sq
left join profile_60928 pd
on sq.pvh_id=pd.factory_id
), 
sub2 as
(select project_id, pvh_id, region, mr.country
 from sub1 sq
 left join profile_62972 mr
on sq.pvh_id=mr.cdms_id), 
sub3 as
(select project_id, pvh_id, rtrim(ltrim(json_serialize(region),'["'),'"]') as region_new, country from sub2),
sub4 as(
  select project_id, pvh_id, 
  --case when region_new is Null then country else region_new end as region, 
  country
  from sub3)
  select * from sub4