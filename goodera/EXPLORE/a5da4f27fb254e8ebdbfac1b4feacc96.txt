with temp as(
  select 'students' as col 
  union all
  select 'teachers' as col 
  union all
  select 'parents' as col)
  
select p1.fy_timerange, p2.name as school, temp.col as dimensions, 
sum(case col
		when 'students' then p1.students
		when 'teachers' then p1.teachers
		when 'parents' then p1.parents
	else null
end) as values
from profile_78608 p1
cross join temp
left join profile_77282 p2 on p2._id = p1.school	
group by p1.fy_timerange, p2.name, temp.col