with t1 as(
  select _id, start, p1.end, fy_timerange ,fy_timerange.end as end_date ,end_date :: date as date1 ,to_char(date1,'MM') as month1,fy_timerange.start as start_date ,start_date :: date as date ,to_char(date,'MM') as month,
case
when month1='01' then 'January'
when month1='02' then 'February'
when month1='03'then 'March'
when month1='04' then 'April'
when month1='05' then 'May'
when month1='06' then 'June'
when month1='07' then 'July'
when month1='08'then 'August'
when month1='09'then 'September'
when month1='10' then 'October'
when month1='11' then 'November'
else 'December'
end as end_month,
case
when month='01' then 'January'
when month='02' then 'February'
when month='03'then 'March'
when month='04' then 'April'
when month='05' then 'May'
when month='06'then 'June'
when month='07' then 'July'
when month='08'then 'August'
when month='09'then 'September'
when month='10' then 'October'
when month='11' then 'November'
else 'December'
end as start_month
from profile_75130 p1
		  ),

item as 
(
select 'start_month' as c
union all
select 'end_month' as c
),

t2 as
(
  select fy_timerange,
case c

when 'end_month' then  t1.end_month
when 'start_month' then t1.start_month
else null
end as month_1,item.c as start_month1,count(*)
from t1 cross join item

group by fy_timerange,month,item.c,start_month,end_month,month_1
)

select  t2.*,
case
when month_1 = 'January' then 1
when month_1 = 'february'then 2
when month_1 = 'March' then 3
when month_1 = 'April' then 4
when month_1 = 'May' then 5
when month_1 = 'June' then 6
when month_1= 'July' then 7
when month_1 = 'August' then 8
when month_1 = 'Septemner' then  9
when month_1 = 'October' then 10
when month_1 = 'November' then 11
else 12
end as month_sort
from t2


