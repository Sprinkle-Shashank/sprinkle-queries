with sub1 as(
SELECT ANY_VALUE(mr.source_div) as source_div, ANY_VALUE(mr.region) as region, mr.timeperiod_timerange
FROM profile_62948 sq
LEFT JOIN profile_60928 mr
ON mr.factory_id=sq.pvh_id
  left join profile_62972 ad
	on ad.cdms_id=sq.pvh_id
  where ad.program!=1140839
  group by sq.pvh_id,mr.timeperiod_timerange
ORDER BY mr.timeperiod_timerange DESC
  ),
  sub2 as(
select t.name as region2 
	from sub1
	left join ds_mysql_prod_tagelement t
	on t.id=sub1.region
	)
	SELECT * from sub2