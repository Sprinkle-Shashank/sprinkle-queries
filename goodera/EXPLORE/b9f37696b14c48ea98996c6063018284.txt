SELECT projectid,loc.name as geography,state.name as State,extract(month from start_date) as month,extract(month from start_date)as s_year,
case when month is 1 then (year-1) 
else (year+1) END AS e_year , concat(s_year,concat(" - ",e_year)) as year,
'Water.Org' as partner, '1' as dim, 'Number of people participating in trainings implemented to create awareness of WSS financing in target communities' as indicator, number_of_participants as val from profile_26658 p
  
 left join ds_mysql_prod_tagelement year
 on p.year = year.id 
 
 left join ds_mysql_prod_tagelement loc
 on p.geography = loc.id 
 left join ds_mysql_prod_tagelement state
on loc.parent = state.id