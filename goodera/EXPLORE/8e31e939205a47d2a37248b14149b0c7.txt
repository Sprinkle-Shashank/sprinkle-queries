with t1 as 
(select fy_timerange, tag1.name as batch, sum(meeting_principal) as Number_of_meetings_with_principal, sum(parent_teacher_meeting) as Number_of_parents_teacher_meetings
from profile_61652 p1
left join ds_mysql_prod_tagelement tag1
on p1.batch = tag1.id
group by fy_timerange, tag1.name),

items as (
select Number_of_meetings_with_principal as c
union all
select Number_of_parents_teacher_meetings as c
),

t2 as (
select it.c,

case c 
when 'Number_of_meetings_with_principal' then t1.Number_of_meetings_with_pricipal
when 'Number_of_parents_teacher_meetings' then t1.Number_of_parents_teacher_meetings
end 
from t1 cross join items it
)
select t1.fy_timerange, t1.batch, t2.c as dimensions, t2.case as values
from t1, t2

