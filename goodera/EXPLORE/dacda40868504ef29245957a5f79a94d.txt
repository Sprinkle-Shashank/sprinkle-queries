with table1 as
(
  select projectid,	p._id	,fy_timerange,	projects	,quarter_report,	ngo	impact	,annual_report,	mou	,remarks,	link	,name	,quarter_file
 , qua.name as quarter_update , ng.name as ngo_update , p1.name as projectid_new  from profile_83043 as p
  
  left join ds_mysql_prod_tagelement qua
  on p.quarter_report = qua.id
  
  left join ds_mysql_prod_tagelement ng
  on p.ngo = ng.id
  
  left join profile_46325 p1
  on p.projects = p1._id
),

table2 as
(
  select p.* , cast(d1 as varchar) as d1_update_quarter_file , cast(d2 as varchar) as d2_update_annual_file , case when mou is null then '-' else 'Download' end as mou_update , case when annual_report is null then '-' else 'Download' end as annual_report_update from table1 as p, p.quarter_file as d1 , p.annual_report as d2 
),

table3 as
(
   select p.fy_timerange , projectid_new , impact , remarks , link , ngo_update , quarter_update , d1_update_quarter_file , d2_update_annual_file , mou_update , annual_report_update  from table2 as p
  )
  
  select * from table3