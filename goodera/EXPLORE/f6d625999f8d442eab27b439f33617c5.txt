select _id, p.name, p.city, p.address, p.school_type, p.principal, p.contact_number, p.boys, p.girls, p.total_strength, p.teachers, listagg(p.grades_taught,', ') grades_taught
from(
  select m.*, grades,t.name city, q.name school_type, r.name grades_taught
  from profile_78773 m, m.grades grades  
  left join ds_mysql_prod_tagelement t
  on m.location = t.id
  left join ds_mysql_prod_tagelement q
  on m.school_type = q.id
  left join ds_mysql_prod_tagelement r
  on m.grades = r.id) p
group by 1,2,3,4,5,6,7,8,9,10,11;