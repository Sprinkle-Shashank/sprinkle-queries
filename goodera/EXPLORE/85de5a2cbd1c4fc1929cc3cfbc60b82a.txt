with table1 as
( select p.* , act.name as activtiy_name_update , cen.name as center , course.name as course_name_update from profile_81612 as p

left join profile_81436 p1 
on p.batch = p1._id 
 
left join ds_mysql_prod_tagelement course
on p.course_name = course.id

left join ds_mysql_prod_tagelement cen 
on p1.center_name = cen.id

left join ds_mysql_prod_tagelement act
on p.activity_names = act.id )

select * from table1 

/*
table2 as
(
select p.*, cast(d1 as varchar) as d1_updated from table1 as p , p.images as d1
),

table3 as
( select p.projectid , p._id , fy_timerange , batch_name , activity_date , activtiy_name_update , guest_name , desci , listagg(distinct d1_updated, ',') as image_updates from table2 as p
 
 group by  p.projectid , p._id , fy_timerange , batch_name , activity_date , activtiy_name_update , guest_name , desci 
 )

select * from table3

*/