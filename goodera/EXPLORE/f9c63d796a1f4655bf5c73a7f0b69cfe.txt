with sub1 as(
  select p1._id as id, p.name as projectId, p2.vendor as vendor, t1.name as country, p2.cycle, t2.name as consultant, t3.name as select_field,
(d1.name+d2.name+d3.name+d4.name+d5.name+d6.name+d7.name+d8.name+d9.name+d10.name+d11.name+d12.name+d13.name+
 d14.name+d15.name+d16.name+d17.name+d18.name+d19.name+d20.name) as score

from profile_62700 p1

left join ds_mysql_prod_tagelement d1 on d1.id = p1.overall_engagement
left join ds_mysql_prod_tagelement d2 on d2.id = p1.overall_engagement_1
left join ds_mysql_prod_tagelement d3 on d3.id = p1.overall_engagement_2
left join ds_mysql_prod_tagelement d4 on d4.id = p1.working_conditions_1
left join ds_mysql_prod_tagelement d5 on d5.id = p1.working_conditions_2
left join ds_mysql_prod_tagelement d6 on d6.id = p1.working_conditions_3
left join ds_mysql_prod_tagelement d7 on d7.id = p1.working_conditions_4
left join ds_mysql_prod_tagelement d8 on d8.id = p1.working_conditions_5
left join ds_mysql_prod_tagelement d9 on d9.id = p1.working_conditions_6
left join ds_mysql_prod_tagelement d10 on d10.id = p1.working_conditions_7
left join ds_mysql_prod_tagelement d11 on d11.id = p1.working_conditions_8
left join ds_mysql_prod_tagelement d12 on d12.id = p1.relationship_1
left join ds_mysql_prod_tagelement d13 on d13.id = p1.relationship_2
left join ds_mysql_prod_tagelement d14 on d14.id = p1.relationship_3
left join ds_mysql_prod_tagelement d15 on d15.id = p1.relationship_4
left join ds_mysql_prod_tagelement d16 on d16.id = p1.relationship_5
left join ds_mysql_prod_tagelement d17 on d17.id = p1.learning_1
left join ds_mysql_prod_tagelement d18 on d18.id = p1.learning_2
left join ds_mysql_prod_tagelement d19 on d19.id = p1.learning_3
left join ds_mysql_prod_tagelement d20 on d20.id = p1.value
left join profile_64362 p2 on p2.factory_id = p1.fac_id
left join ds_mysql_prod_project p on p.id = p2.projectid
left join ds_mysql_prod_tagelement t1 on t1.id = p1.country
left join ds_mysql_prod_tagelement t2 on t2.id = p2.consultant_tag
left join ds_mysql_prod_tagelement t3 on t3.id = p1.select

where p.name is not null),

sub2 as(
  select s1.*, cycle_new from sub1 s1, s1.cycle cycle_new)
  
select * from sub2