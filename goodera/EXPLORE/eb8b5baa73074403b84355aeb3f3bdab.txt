with table1 as(
	select p1.name as name, t1.name as van,
    case 
  		when (p2.date_yn = 28005) 
  			then 
  				p2.date_n
  		else p2.createddate
  	end as date, t.name as treatment_mode
  	from profile_58474 p
  	left join 
  	ds_mysql_prod_project t1
  	on p.projectid = t1.id
  	left join profile_58511 p2
  	on p.sel_camp = p2._id 
  	left join 
  	profile_51990 p1
  	on p2.imple_partner = p1.projectid
  	left join ds_mysql_prod_tagelement t
  	on p.treatment_mode = t.id
)
select *, 1 as count from table1