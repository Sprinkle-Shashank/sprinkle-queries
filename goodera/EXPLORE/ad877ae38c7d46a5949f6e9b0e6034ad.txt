with temp as (
Select 'GJ' as col
 union all
Select 'kwH' as col
)
Select t.name as site,t1.name as sub_Region,t2.name as Region,t4.name as fin_q,t5.name as fin_hy,t6.name as fin_y,EXTRACT(YEAR FROM(CAST(startdate AS datetime))) as year,(datanum*3.6) as GJ,(DATANUM*277.778) as kwH,
sum(case
  	when 'GJ' then datanum*3.6
    when 'kwH' then datanum*3.6*277.778
  else null
  end) as Energy_Consumption,temp.col as Unit
from sus_56999
  cross join temp
  left join ds_mysql_prod_project t
  on xprojectid=t.id
  left join ds_mysql_prod_project t1
  on t.parent=t1.id
  left join ds_mysql_prod_project t2
  on t1.parent=t2.id
  left join ds_mysql_prod_tagelement t3
  on financialperiod=t3.id
  left join ds_mysql_prod_tagelement t4
  on t3.parent=t4.id
  left join ds_mysql_prod_tagelement t5
  on t4.parent=t5.id
  left join ds_mysql_prod_tagelement t6
  on t5.parent=t6.id
  where  keyword ='electricity_usage' and site!=47608
  group by t.name,t1.name,t2.name,t3.name,t4.name,t5.name,t6.name,startdate,Unit