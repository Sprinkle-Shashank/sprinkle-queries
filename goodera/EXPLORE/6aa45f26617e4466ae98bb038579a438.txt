with s as 
(Select name as site,('FY '||EXTRACT(YEAR FROM(CAST(startdate AS datetime)))||'-'||substring(EXTRACT(YEAR FROM(CAST(startdate AS datetime)))+1,3,2) )as year,fy_timerange,datatablebase,tablesettings,questiontext
from sus_64073
where keyword= 'emission_factor_fuel_type'
),
s3 as (
Select 'Coal' as col
 union all
Select 'Natural Gas' as col
  union all
Select 'Pet Coke' as col
  union all
Select 'Petrol' as col
   union all
Select 'Diesel' as col
   union all
Select 'FO' as col
   union all
Select 'South African Coal' as col
   union all
Select 'Anthracite Coal' as col
   union all
Select 'Lubricants' as col
  union all
Select 'Plastics' as col
  union all
Select 'Indonesian Coal' as col
  
 )
 
 ,
 sw as(
Select  site,year financialPeriod,fy_timerange,questiontext questions, coun.emission_factor as  Values, cast(coun.unit_em_factor as varchar) unit,var from s as s1, unpivot s1.datatablebase as coun at var
)


Select  site, financialPeriod,fy_timerange, questions, 
s3.col as Source,
	 sum(  sw.Values) as Values, unit
from sw
cross join s3
where sw.values is not null and   sw.values!=0
group by site, financialPeriod,fy_timerange, questions,sw.var,sw.unit,s3.col


