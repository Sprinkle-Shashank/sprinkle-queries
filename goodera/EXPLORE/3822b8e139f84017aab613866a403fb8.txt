with table1 as(select *, 
			  case when gender = 257687 then total_child_provide_home
			      else 0 
				  end as male,
			   case when gender = 257688 then total_child_provide_home
			   else 0 
			   end as female 
			   from profile_78765 )
,
			   




 temp as (
  select 'male' as C
  Union all
  select 'female' as C
  Union all 
  select 'total_child_provide_home' as C
  Union all 
  select 'child_age_6_14_provided_home' as C
  Union all
  select 'child_age_15_18_provided_home' as C
  Union all
  select 'child_age_18_provided_home' as C
  
 
	)


select pro.name as projectid ,fy_timerange,home_type.name as home_type, 

Sum(Case C
	When 'male' then p.male
	when 'female' then p.female
	When 'total_child_provide_home' then p.total_child_provide_home
	When 'child_age_6_14_provided_home' then p.child_age_6_14_provided_home
	When 'child_age_15_18_provided_home' then p.child_age_15_18_provided_home
	When 'child_age_18_provided_home' then p.child_age_18_provided_home
	Else Null
	
END) as values , temp.C as dimensions
from table1 as p

cross join temp

left join ds_mysql_prod_tagelement as gend 
  on p.gender = gend.id
left join ds_mysql_prod_tagelement as home_type
  on p.home_type = home_type.id  
  
  left join ds_mysql_prod_project as pro
  on p.projectid = pro.id
  
  group by pro.name, p.fy_timerange, home_type.name,temp.c
  
 
