
with table1 as 
( select p.projectid , case when extract(month from p.date)=1 then (extract(year from p.date)-1)
else extract(year from p.date) end as year from profile_61572 as p
 
 order by year
 )
 
 select distinct year, p.projectid from table1
 
 
/*
with table1 as 
(
select case when extract(month from p.date)=1 then (extract(year from p.date)-1)
else extract(year from p.date) end as year_aware, q.date as new_date, 

case when extract(month from new_date)=1 then (extract(year from new_date)-1)
else extract(year from new_date) end as year_in , 

case when year_in is null then year_aware else year_in end as year 
from profile_61572 as p,profile_64801 as q 
  
group by p.date, q.date
)

select distinct year from table1

order by year asc
*/