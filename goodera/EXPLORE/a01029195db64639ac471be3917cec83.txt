select case when extract(month from p.date)=1 then (extract(year from p.date)-1)
else extract(year from p.date) end as year_aware, q.date as new_date, 
case when extract(month from q.new_date)=1 then (extract(year from q.new_date)-1)
else extract(year from q.new_date) end as year_in , 
case when year_in is null then year_aware else year_in end as year 
from profile_61572 as p,profile_64801 as q
/*
case when extract(month from q.new_date)=1 then (extract(year from q.new_date)-1)
else extract(year from q.new_date) end as year_in , 

case when year_in is null then year_aware else year_in end as year 
*/

group by year, p.date, q.new_date 

order by year asc
