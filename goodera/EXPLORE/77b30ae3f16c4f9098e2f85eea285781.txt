select sum( case when type(end_date_2) = date then num_females_graduated 
		         else 0) end as total_females_graduated from profile_4227
/*select sum(nvl2(end_date_2,num_females_graduated,0)) as total_females_graduated FROM profile_4227 */


LEFT JOIN profile_54646 ON
profile_4227.projectId = profile_54646.projectId

where lg_status =848007 or lg_status is null