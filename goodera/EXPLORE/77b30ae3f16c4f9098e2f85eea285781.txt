select sum( case when end_date_2 is null then 0 
		         else num_females_graduated end) as total_females_graduated,pro.name as lg  from profile_4227 p
/*select sum(nvl2(end_date_2,num_females_graduated,0)) as total_females_graduated FROM profile_4227 */
left join ds_mysql_prod_tagelement as pro
on p.lg_status = pro.id	

LEFT JOIN profile_54646 ON
p.projectId = profile_54646.projectId

where lg <> 'Dropped' --lg_status = 848007 or lg_status is null --or lg_status 

group by pro.name