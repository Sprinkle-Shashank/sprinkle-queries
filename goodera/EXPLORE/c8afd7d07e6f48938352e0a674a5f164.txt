with table1 as (
  select t3.name as projectid, p.fy_timerange,t1.pvh_id, reg, cast(p.fy_timerange.start as date) as start_date
  from profile_62491 p, t2.region reg
	left join profile_62948 t1 on t1.projectid = p.projectid
	left join profile_60928 t2 on t1.pvh_id = t2.factory_id
	left join ds_mysql_prod_project t3 on t3.id = p.projectid
	)
	
select projectid, fy_timerange, pvh_id, last_value(reg) over (partition by projectid, pvh_id order by start_date desc rows between unbounded preceding and unbounded following) from table1

