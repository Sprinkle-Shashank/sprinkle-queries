with sub1 as(
	select p1.project_id, p1.fy_timerange, p2.pvh_id, p3.region, p1.end_date_2 as end_date, p1.project_name, extract(year from cast(p1.fy_timerange.start as date) as start_year
from profile_62491 p1
	left join profile_62948 p2 on p2.project_id = p1.project_id
	left join profile_60928 p3 on p2.pvh_id = p3.factory_id
	where start_year >= 2020 )
	
select project_id, fy_timerange, project_name, end_date, any_value(pvh_id) as pvhid, any_value(region) as country from sub1 group by project_id, fy_timerange, project_name, end_date