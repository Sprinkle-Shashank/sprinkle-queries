with table1 as (
  select t3.name as projectid, p.fy_timerange,t1.pvh_id, cast(t2.region as INT)
  from profile_62491 p
	left join profile_62948 t1 on t1.projectid = p.projectid
	left join profile_60928 t2 on t1.pvh_id = t2.factory_id
	left join ds_mysql_prod_project t3 on t3.id = p.projectid
	)
	
select projectid, fy_timerange, pvh_id, last_value(region) over (partition by pvh_id order by fy_timerange desc rows between unbounded preceding and unbounded following) from table1 group by projectid, fy_timerange, pvh_id