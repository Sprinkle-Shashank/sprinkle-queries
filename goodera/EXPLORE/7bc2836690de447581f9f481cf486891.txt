with table1 as (select add_factory.projectid,pace_mapping.name_factory as factory,pace_mapping.name_vendor_filter as vendor,pace_mapping.name_country as country,factory_vpid_1 as community_id, child_vendor_vpid as vp_id from profile_52713 add_factory

left join profile_54646 pace_mapping 
on add_factory.projectid = pace_mapping.projectid ),

table2 as ( 
  select projectid, start_date, end_date, end_date_2, num_females from profile_4227 p
  /*left join ds_mysql_prod_project as pro
on p.projectid = pro.id*/
  where end_date_2 is null 
),
table3 as ( select pro.name as projectid,count(*),end_date from profile_4228 p
		   
		   left join ds_mysql_prod_project as pro
on p.projectid = pro.id
		   where end_date is not null 
		  group by pro.name,end_date)
  
  select * from table3