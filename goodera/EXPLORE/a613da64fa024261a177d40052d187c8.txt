with test0 as(Select p.* ,CAST(gbv_goals as VARCHAR)from profile_76755 p
, p.gbv_goals_arr gbv_goals
),
 test1 as (Select p.projectId,p.facility_name,p.year_timerange,p.country,p.director_region,p.facility_type,p1.gbv_policy,p1.channels_more, p1.anonymous_channel, p1.third_party_channel, p1.response_provided, p1.issues_resolved,case 
	when 1=1
	then 1
	else 0
	end
	as count,
CASE WHEN (p1.gbv_policy = 57472) or (p1.anonymous_channel=57472) or (p1.third_party_channel=57472) or (p1.response_provided=57472) or (p1.issues_resolved = 57472) and (p1.channels_more=1538190) or (p1.channels_more = 1538189) Then 'YES'
ELSE 
'NO'
END AS result

from test0 p
		    
left join profile_76894 p1 on 
p.gbv_goals = p1._id
			   
left join ds_mysql_prod_project fac
on p.projectId = fac.id
left join ds_mysql_prod_project ven
on fac.parent = ven.id
			   
Group by p.projectId,p.facility_name,p.year_timerange,p.country,p.director_region,p.facility_type,ven.name,result,p1.gbv_policy,p1.channels_more, p1.anonymous_channel, p1.third_party_channel, p1.response_provided, p1.issues_resolved			   
)
Select p.* from test0 p			  







