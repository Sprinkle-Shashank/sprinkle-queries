with table1 as (select taskuserid,projectid from ds_mongo_profileinstance
where profileid = 4227)

select  p.taskuserid,t1.projectid/*,pu.programid,u.email,pp.name*/ from profile_4227 p

left join  table1 t1 on
p.taskuserid = t1.taskuserid
 
 where taskuserid is not null

/*select t1.projectid, p.taskuserid,pu.programid,u.email,pp.name from profile_4227 p
left join ds_mysql_prod_taskuser tu on
p.taskuserid = tu.id
left join table1 t1 on
p.taskuserid = t1.taskuserid
left join ds_mysql_prod_programuser pu on
tu.programuserid = pu.id 
/*left join ds_mysql_prod_project as pro
on pu.programid = pro.programid*/
left join ds_mysql_prod_user u on
pu.userid = u.id
left join ds_mysql_prod_personprofile pp on
u.id = pp.userid*/

/*select  programid from ds_mysql_prod_programuser p

left join ds_mysql_prod_project as pro
on p.programid = pro.programid

where pro.name ilike'%Factory%'*/
