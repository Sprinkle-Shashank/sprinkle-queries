with temp as(
  Select 'Completed' as col
  union all
  Select 'Enrolled' as col
),

t1 as(
  Select id, t.name as ts, p.name as bs
from profile_3864 sq
left join profile_3863 p 
ON p._id=sq.batch_details
left join ds_mysql_prod_tagelement t
On t.id=sq.training_status
  ),
  t2 as(
Select bs, 
  case
  when ts='Completed' then 'Completed'

end as s
from t1
Where bs!=''
)

Select temp.col as dim,
case col
when 'Enrolled' then bs
when 'Completed' then s
end as t21,
count(*)
from t2
cross join temp
where t21 !=NULL
group by bs, s, temp.col