
with table1 as 
(
select p.projectId, ven.name as vendor,cou.name as country, nvl2(SUBSTRING(ven.name, 1, POSITION(' (' in ven.name)), SUBSTRING(ven.name, 1, POSITION(' (' in ven.name)), ven.name) as vendor_name, case when vendor_name='' then vendor else vendor_name end as new_vendor, p.projectId as facility

from profile_61572 as p 

left join ds_mysql_prod_project fac 
on p.projectId = fac.id

 left join ds_mysql_prod_project ven 
on fac.parent = ven.id

 left join ds_mysql_prod_project cou 
on ven.parent = cou.id
)
select new_vendor as vendor,  country from table1
/*
where country <> '______________' and vendor <> 'Test Vendor'

group by country /* , vendor */

order by vendor asc
*/