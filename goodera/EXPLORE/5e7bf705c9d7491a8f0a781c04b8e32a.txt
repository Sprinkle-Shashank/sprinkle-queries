WITH table1 AS (
  SELECT fy_timerange, projectid, name, logo, description_innovation, url ,reg_address , stage_startup, stage_product, sdg_photo, target_category
  
  FROM profile_79637),

table2 AS (SELECT t1.* , CAST(photo_sdg AS VARCHAR) 

FROM table1 t1 , t1.sdg_photo photo_sdg )

SELECT projectid, p.name, pro.name AS startup_name, fy_timerange, logo, description_innovation, url, target_category, reg_address,
strt.name AS stage_startup, 
pdt.name AS stage_product,

LISTAGG(DISTINCT CAST(p.photo_sdg AS VARCHAR),',') AS sdg_photo_unwind2

from table2 p 

LEFT JOIN ds_mysql_prod_tagelement AS strt
ON p.stage_startup = strt.id

LEFT JOIN ds_mysql_prod_tagelement AS pdt
ON p.stage_product = pdt.id

LEFT JOIN ds_mysql_prod_project AS pro
ON p.projectid = pro.id

GROUP BY projectid, p.name, pro.name, fy_timerange, logo, description_innovation, url, reg_address, strt.name, pdt.name, target_category, photo_sdg