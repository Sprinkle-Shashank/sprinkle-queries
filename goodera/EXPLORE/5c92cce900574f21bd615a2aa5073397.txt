select p2.name as projectId, ngo, proj, proposed, approved, ongoing, completed, disqualify,p2.remarks,p2.upload,p2.date,
(case 
when disqualify=335745 or approved = 335744 or ongoing = 335744 or completed = 335744 or proposed = 335744 then 'Disqualified'
when completed=335745 then 'Completed'
when ongoing = 335745 then 'Ongoing'
when approved = 335745 then 'Approved'
when proposed = 335745 then 'Proposed'
else 'NA'
end) as status,
case 
when upload = 0 then 0
when upload = '-' then 'Download'
else 0
end as Download,
case
when status = 'Completed' then 1
when status = 'Approved' then 2
when status = 'Proposed' then 3
when status = 'Ongoing' then 4
else 5
end as sort,
extract(month from cast(p2.date as datetime)) as month,extract(year from cast(p.date as datetime)) as year
from profile_70244 p1
left join profile_70245 p2 on p1._id = p2.ngo_projects
left join ds_mysql_prod_project p3 on p3.id=p1.projectId
left join ds_mysql_prod_project p4 on p4.id=p3.parent
where p2.upload is not null