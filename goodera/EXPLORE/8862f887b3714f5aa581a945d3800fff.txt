with lookup as (select 
				taskid, programuserid, p.securitycontextid,
				programuser.userid, programuser.programid,
				task.projectflowid 
				from ds_mysql_prod_taskuser p
				
left join ds_mysql_prod_programuser programuser on
programuser.id = p.programuserid
				
left join ds_mysql_prod_task task on
task.id = p.taskid
),
			   
lookup2 as (select 
			taskid, programuserid, p.securitycontextid, userid, programid, projectflowid, 				prog_user.email 
			from lookup p
  
left join ds_mysql_prod_user prog_user on
prog_user.id = p.userid
)
select taskid, programuserid, userid, programid, projectflowid, email from lookup2 p where p.securitycontextid = 1137 and taskid = 213746