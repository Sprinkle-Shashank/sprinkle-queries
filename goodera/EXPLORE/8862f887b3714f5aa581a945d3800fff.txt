with lookup as (select
				JSON_SERIALIZE(table_52810.pace_brands) as pace_brand,
				p._id,
				p.factory_vpid_1, p.factory_vpid_2, p.sourcing_yn, p.child_vendor_vpid, p.projectid,
				table_54267._id as id_54267,
				case when pace_status is not NULL then pace_status else pace_status_2 end  as pacestatus,
				case when pace_brand like '%1151834%' then 1 else 0 end  as brand,
				case when sourcing_yn=57472 then factory_vpid_1 else factory_vpid_2 end  as factory_id
				from profile_52713 p
left join profile_52810 table_52810 on
table_52810.projectid=p.projectid
left join profile_4227 table_4227 on
table_4227.projectid=p.projectid
left join profile_54267 table_54267 on
table_54267.projectid=p.projectid)
select factory_vpid_1, factory_vpid_2, sourcing_yn, child_vendor_vpid, projectid, factory_id from lookup p where brand = 1 and (pacestatus = 845114 or pacestatus = null) group by factory_vpid_1, factory_vpid_2, sourcing_yn, child_vendor_vpid, projectid, id_54267, factory_id order by id_54267