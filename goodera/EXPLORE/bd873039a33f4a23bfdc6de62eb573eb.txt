with table1 as
( 
  select p.* , f1 from profile_81523 as p, p.location as f1
),
  
  table2 as
  ( select p.*, d1 from table1 as p,p.sdg as d1 ),
  
table3 as
( select p.* , cast(d1 as varchar) as sdg_values , sta.name as state from table2 as p

left join ds_mysql_prod_tagelement ci 
on p.f1 = ci.id

left join ds_mysql_prod_tagelement sta 
on ci.parent = sta.id
 ),
 
 table4 as
 (
 select p.projectid , p._id , listagg(sdg_values, ',') as sdg_values  , state  , proj_duration , desc as description , logo , ngo_names from table3 as p
 
 group by  p.projectid , p._id , proj_duration , description , logo  , ngo_names , state
)

select * from table4
 
 /*
 , desc , logo 
   , ngo_names
 

 
  listagg(state,',') as
 */

