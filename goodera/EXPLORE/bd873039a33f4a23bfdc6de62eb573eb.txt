with table1 as
( 
  select * , sta.name as state from profile_81523 as p
 
left join ds_mysql_prod_tagelement ci 
on p.location = ci.id

left join ds_mysql_prod_tagelement sta 
on ci.parent = sta.id
  ),
  
  table2 as
  ( select p.*, d1 from table1 as p,p.sdg as d1 )
  
  select p* , sdg_updated.name as sdg_values from table2 as p
  
  left join ds_mysql_prod_tagelement sdg_updated
  on p.sdg = sdg_updated.id