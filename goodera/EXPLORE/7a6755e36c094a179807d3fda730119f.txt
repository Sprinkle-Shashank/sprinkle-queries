with Base1 as(select p.name as ProjectCode,f.name as fy_timerange,p.budget,p.project_proposal,p.monitoring_plan,p.rra_file,p.impact_file,p.pad_file from profile_27396 p
left join ds_mysql_prod_tagelement f on
p.fy=f.id
union
select l.name as ProjectCode,f.name as fy_timerange,p.budget,p.project_proposal,p.monitoring_plan,p.rra_file,p.impact_file,p.pad_file from profile_27420 p
left join ds_mysql_prod_tagelement f on
p.fy=f.id
left join profile_27396 l on
p.project_code=l._id),Base2 as(select fy_timerange,case when len(budget)>0 then 'budget' end as Budget,budget from Base1)
select * from Base1
