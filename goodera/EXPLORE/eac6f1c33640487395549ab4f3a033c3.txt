with x as (select name as projectid, financialperiod,fy_timerange, datatablebase from sus_56551 where keyword='gri_water_withdrawal_details' ) ,
temp2 as (

select * , temp1.gri_volume_water_recycled
  from x as temp, unpivot temp.datatablebase as temp1 at row)
  
 select projectid, sum(temp1.gri_volume_water_recycled) as gri_volume_water_recycled , t1.name as financialperiod , fy_timerange, split_part(fy_timerange,'-',1) as Year, split_part(fy_timerange,'-',2) as Month
 


from temp2  
left join ds_mysql_prod_tagelement t1 on t1.id = financialperiod 

group by
projectid,t1.name, fy_timerange, Year, Month

