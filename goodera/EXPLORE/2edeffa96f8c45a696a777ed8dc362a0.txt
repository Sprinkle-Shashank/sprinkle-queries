with test1 as(
select p.projectId, p.fy_timerange.start as fy_timerange, p.sti_gu as genital_ulcers, p.sti_ud as urethral_discharg, p.sti_vd as veginal_discharge, p.sti_lap as lower_abdomen_pain, p.sti_ss as scrotal_swelling, p.sti_is as inguinal_swelling, p.sti_others as other from profile_63885 p
)

with pivot1 as(
select 'genital_ulcers' as sti from test1
  union all
select 'urethral_discharg' as sti from test1
  union all
select 'veginal_discharge' as sti from test1
  union all
select 'lower_abdomen_pain' as sti from test1
  union all
select 'scrotal_swelling' as sti from test1
  union all
select 'inguinal_swelling' as sti from test1
  union all
select 'other' as sti from test1
),

final1 as(
select p.projectId, p.fy_timerange, t.sti,
  case sti
  when 'genital_ulcers' then p.genital_ulcers
  when 'urethral_discharg' then p.urethral_discharg
  when 'veginal_discharge' then p.veginal_discharge
  when 'lower_abdomen_pain' then p.genital_ulcers
  when 'scrotal_swelling' then p.scrotal_swelling
  when 'inguinal_swelling' then p.inguinal_swelling
  when 'other' then p.other
  else null
  end as final_sum from test1 p cross join pivot1 t
)


select * from final1