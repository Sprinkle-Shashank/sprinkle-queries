with sub1 as(
  select p1.*, is_array(p1.indicator) as array_check,
  case
  	when(array_check = false) then array(p1.indicator)
  	else p1.indicator
  end as indicator_new
from profile_55605 p1),

sub2 as(
  select s1.*, indicator_605 from sub1 s1, s1.indicator_new indicator_605)
  
select s2.*, p3.indicator as indicator_604, p2.data
from sub2 s2
left join profile_55606 p2 on p2._id = s2.indicator
left join profile_55604 p3 on p3._id = p2.indicator