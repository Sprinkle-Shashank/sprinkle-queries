
with table3 as 
(
 select pr_27.projectid , cast(pr_27.name as varchar) as name, row_number() over 
(partition by pr_27.projectid  --factory
 order by pr_27.start_date desc) as row2 , position('Batch ' in name) as index_value , (len(name) -index_value) as exact_position , right( name , exact_position) as updated_name  from profile_4227 pr_27 
 )
 
 select tab3.name as name , index_value , updated_name from table3 tab3