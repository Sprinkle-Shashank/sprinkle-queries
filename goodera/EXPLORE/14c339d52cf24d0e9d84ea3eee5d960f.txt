with t1 as
(
  select batch, dropout_reason, state, p1.fy as name_update, p1.month as month_up 

  from profile_30527 as p
  
  left join profile_30532 p1
  on p.batch = p1._id
  
  where dropout_reason IN ('566391', '566389', '566390', '577331', '577332')
  ),
  
  t2 as
  (
	select dropout_reason, state, name_update, month_up, count(*) as dropoutnums from t1
	
	group by dropout_reason, state, name_update, month_up
	)
	select dropout_reason, state, name_update, month_up, dropoutnums from t2
  