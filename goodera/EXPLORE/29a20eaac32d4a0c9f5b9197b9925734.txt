with t1 as
(
  select projectId.name as projectId, services, fy_timerange, ser
  left join ds_mysql_prod_project as projectId
  on p.projectId = projectId.id
  from profile_54243 as p, p.services as ser
  ),
  
  t2 as
  (
	select fy_timerange, count(*) as count_up, projectid,serv.name as service_updated from t1
	
	left join ds_mysql_prod_tagelement serv
     on t1.ser = serv.id
	group by projectid, service_updated, fy_timerange
	)
  select projectid, cast(service_updated as VARCHAR) as service_new, fy_timerange, count_up from t2
	