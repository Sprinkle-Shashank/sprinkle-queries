with s as 
(Select t.name as projectid,('FY'||substring(EXTRACT(YEAR FROM(CAST(startdate AS datetime))),3,2)||'-'||substring(EXTRACT(YEAR FROM(CAST(startdate AS datetime)))+1,3,2) ) as year, fy_timerange,
 Sum(CASE 
             WHEN keyword = 'renewable_energy_consumed_solar' THEN datanumBase/1000
             ELSE 0 
           END) AS renewable_energy_consumed_solar

from sus_79029
left join ds_mysql_prod_project t
on xprojectid=t.id
where keyword ='renewable_energy_consumed_solar'
group by t.name,startdate,fy_timerange
), s2 as (
Select 
  (CASE 
             WHEN keyword = 'financial_year' THEN datanumBase
             ELSE 0 
           END) AS f_year,
  Sum(CASE 
             WHEN keyword = 'net_sales_revenue' THEN datanumBase
             ELSE 0 
           END) AS net_sales_revenue
from sus_79269 ss

where keyword in ('financial_year','net_sales_revenue')
    group by ss.keyword,ss.datanumbase
  )
  Select projectid, year, fy_timerange,renewable_energy_consumed_solar,s2.net_sales_revenue
  from s
  left join s2 on 
  s.year=s2.f_year