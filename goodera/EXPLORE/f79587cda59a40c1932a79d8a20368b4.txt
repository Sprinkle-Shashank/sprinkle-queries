select p.projectId, worker_late, gender, fair_baised, to_do_list, worker_not_paid, marital_status, age, work_area, education, work_ex, assign_job, timeline_miss, worker_leave, belief, conflict_worker,score_total, cou.name as country, ven.name as vendor, post_supervisor_total_respondents, survey_type,
SUBSTRING(to_char(profile_63439.date, 'DD/MM-YYYY'), POSITION('-' in to_char(profile_63439.date, 'DD/MM-YYYY'))+1,4 ) as year, profile_63439.training_id, profile_63439.trainer_organization
from profile_65222 p

left join profile_63439
on p._id = profile_63439.survey


left join ds_mysql_prod_project fac
on p.projectid = fac.id
left join ds_mysql_prod_project ven
on fac.parent = ven.id
left join ds_mysql_prod_project cou
on ven.parent = cou.id

group by p.projectId, worker_late, gender, fair_baised, to_do_list, worker_not_paid, marital_status, age, work_area, education, work_ex, assign_job, timeline_miss, worker_leave, belief, conflict_worker, trainer_organization, score_total, cou.name, ven.name, year, survey_type