with temp as (
  select 'pregnant_anemic_patients' as C
  Union all 
  select 'lactating_anemic_patients' as C
  Union all 
  select 'child_anemic_patients' as C
 /* Union all
  select 'total_patients' as C
*/
  )

select projectid,fy_timerange,cit.name as location,pregnant_anemic_patients,
 lactating_anemic_patients ,
 child_anemic_patients , pregnant_anemic_patients+lactating_anemic_patients+child_anemic_patients as total_patients,
 Case C
 When 'pregnant_anemic_patients' then p.pregnant_anemic_patients
	When 'lactating_anemic_patients' then p.lactating_anemic_patients
	When 'child_anemic patients' then p.child_anemic_patients
/*	When 'total_patients' then p.total_patients */
	Else Null
END as values , temp.C as dimensions
 
 from profile_78549 p
 cross join temp
 left join ds_mysql_prod_tagelement cit
 on p.locate = cit.id 
 
 group by projectid, fy_timerange,location, pregnant_anemic_patients,
 lactating_anemic_patients ,
 child_anemic_patients , total_patients
