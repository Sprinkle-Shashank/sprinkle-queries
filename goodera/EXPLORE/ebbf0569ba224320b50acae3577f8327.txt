with table1 as
( select p.projectid , p._id , fy_timerange , story_pic_1, story_2, story_description_1, story_description_2, sdg_goal, project_pic, name, projects, fy_1, project_status, theme, description, sdg_goal_number, project_pic_link, year_of_inception, stories, target_students, target_schools, beneficiaries, d1,d2,d3
 from profile_51331 as p, p.ngo as d1, p.state as d2, p.city as d3
 ),
 
 table2 as
 ( 
   select p.* , sta.name as state_update , ci.name as city_update , ng.name as ngo_update from table1 as p
   
left join ds_mysql_prod_tagelement sta
on p.d1 = sta.id 
 
left join ds_mysql_prod_tagelement ci
on p.d2 = ci.id 
   
left join ds_mysql_prod_tagelement ng
on p.d3 = ng.id 
   )

select * from table2

where project_pic is not null 

order by fy_timerange , description desc
