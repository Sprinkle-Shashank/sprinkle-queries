
select distinct p4.village as village, f.name as fy, p4.state as State, p4.district as District,
count(distinct p2.name) as no_of_projects, count(distinct p2.ngo_partner) as no_of_implementing_agencies, 
m.name as ProjectManager
																															   
from profile_29974 p1
left join ds_mysql_prod_tagelement f on
p1.fy=f.id 
left join profile_27396 p2 on 
p1.prj_code=p2._id
left join profile_30171 p3 on 
p1.prj_code=p3.prj_code
left join profile_27489 p4 on
p1.census_code=p4._id 
left join ds_mysql_prod_tagelement m on
p2.project_manager=m.id
																										
group by p4.village,p4.state, p4.district,f.name,m.name

/*select distinct p1.village_name as village, f.name as financial_year, p4.state as State, p4.district as District,
count(distinct p1.prj_code) as no_of_projects, count(distinct p2.ngo_partner) as no_of_implementing_agencies, sum(p1.hdfc_cost_monthly+p3.monthly_cost) as allocatedamount
																															   
from profile_27489 p4
left join profile_29974 p1 on
p1.census_code=p4._id 
left join ds_mysql_prod_tagelement f on
p1.fy=f.id 
left join profile_27396 p2 on 
p1.prj_code=p2._id
left join profile_30171 p3 on 
p1.prj_code=p3.prj_code


																													
group by p1.village_name,p4.state, p4.district,f.name*/

/**/
