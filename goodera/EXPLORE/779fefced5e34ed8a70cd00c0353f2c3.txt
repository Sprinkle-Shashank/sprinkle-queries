select p1.village_name as village, count(distinct p1.prj_code) as no_of_projects, count(distinct p2.ngo_partner) as no_of_implementing_agencies, sum(p1.hdfc_cost_monthly+p3.monthly_cost) as allocatedamount
																															   
from profile_29974 p1
left join profile_27396 p2 on 
p1.prj_code=p2._id
left join profile_30171 p3 on 
p1.prj_code=p3.prj_code
																													
group by village
