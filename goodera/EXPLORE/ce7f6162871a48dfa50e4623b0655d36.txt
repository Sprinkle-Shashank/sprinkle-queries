with temp as(
  Select 'male' as col
  	union all
  Select 'female' as col
  	union all
  Select 'other gender' as col
)


select fy_timerange,school_name,taga.name as location,count(*),
(male_6th + male_7th + male_8th + male_9th + diff_abled_male_6th + diff_abled_male_7th + diff_abled_male_8th + diff_abled_male_9th) as sum_of_male,
(female_6th + female_7th + female_8th + female_9th + diff_abled_female_6th + diff_abled_female_7th + diff_abled_female_8th + diff_abled_female_9th) as sum_of_female,
(other_gender_6th + other_gender_7th + other_gender_8th + other_gender_9th) as sum_other_gender,temp.col,

(case col
	when 'male' then a.sum_of_male
	when 'female' then a.sum_of_female
	when 'other gender' then a.sum_other_gender
else NULL
end)as gender_distribution
from
profile_79481 a
cross join temp
left join ds_mysql_prod_tagelement taga on taga.id = a.state_district


group by fy_timerange,school_name,location,sum_of_male,sum_of_female,sum_other_gender,temp.col,gender_distribution

