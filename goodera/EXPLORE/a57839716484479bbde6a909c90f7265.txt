with test as (
Select pro.name as projectId, pro.parent,p._id,
--pro2.name as parentproject,
p1.name as head,p1.head as category_head ,sum(p.amount) ,p.fy_timerange,p.name,p.head from profile_78834 p 
 left join profile_78833 p1
on p.head = p1._id
left join ds_mysql_prod_project as pro
  on p.projectid = pro.id
-- left join ds_mysql_prod_project as pro2
--  on pro.parent = pro2.id

group by p.projectId, p.fy_timerange, p1.name, p1.head,pro.name, pro.parent,
--pro2.name,
p.name,p.head
)

select * ,pro2.name
from test
left join ds_mysql_prod_project pro2
 on test.parent = pro2.id