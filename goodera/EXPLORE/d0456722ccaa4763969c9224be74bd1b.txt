with sub1 as(select p1.name as projectid,t1.name as financial_period,nvl(measureunitbase,'NUMBER') as unit,('FY' || ' ' || split_part(financial_period, ' ', 2)) as FY,questiontext,

p1.datanumbase,
case keyword
    when 'gri_renewable' then 'Renewable Energy Source'
	when 'gri_consumed_renewableelectricity_produced' then 'Renewable Electricity Produced'
	else null
	end 
	as consumption_type

from sus_56551 p1
left join ds_mysql_prod_tagelement t1 on t1.id=p1.financialperiod
where p1.keyword in ('gri_renewable','gri_consumed_renewableelectricity_produced') and datanumbase is not null)

select *,sum(consumption_type) as values

group by p1.name,t1.name,p1.datanumbase,p1.keyword,unit,questiontext