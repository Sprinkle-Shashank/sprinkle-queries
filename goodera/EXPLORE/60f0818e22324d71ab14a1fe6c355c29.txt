with sub1 as(
  select p1.*,
cast(timestamp 'epoch' + CAST(p1.eventdate AS BIGINT)/1000 * interval '1 second' as varchar) as event_date,
cast(timestamp 'epoch' + CAST(p1.created AS BIGINT)/1000 * interval '1 second' as varchar) as create_date,
is_array(p1.focus_area) as array_check,
case
	when array_check = false then array(p1.focus_area)
	else p1.focus_area
end as focus_area_new
from profile_26729 p1),

sub2 as(
  select s1.*, focus_area from sub1 s1, s1.focus_area_new focus_area)
  
select country, officecountry, geo_address.country from profile_26729
group by country, officecountry, geo_address.country