with sub1 as(
  select p1.quarter_timerange as fy_timerange, t1.name as meet_target, p1.factory_text, p1.cdms_id, 
row_number() over (partition by p1.factory_text, p1.cdms_id order by cast(p1.quarter_timerange.start as date) desc) as row_number
from profile_66533 p1
left join ds_mysql_prod_tagelement t1 on t1.id = p1.meet_target)

select * from sub1
where row_number = 1
