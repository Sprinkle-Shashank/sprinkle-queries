SELECT S.registration, S.completion_status, S.voucher,
t.name AS gender,
S.date AS fy_timerange,
DISTINCT COUNT (S.registration)

FROM profile_77915 AS S

LEFT JOIN ds_mysql_prod_tagelement AS t
ON S.gender = t.id

GROUP BY S.registration, S.completion_status, S.voucher, t.name, S.date