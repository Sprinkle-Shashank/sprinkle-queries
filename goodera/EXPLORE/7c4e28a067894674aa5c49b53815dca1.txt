with sub1 as(
  select projectId, sched7, spoc_name, name, spoc_email, remarks, project_status, fy_timerange, budget_approved, spoc_number, count(*) from profile_41363 group by projectId, sched7, spoc_name, name, spoc_email, remarks, project_status, fy_timerange, budget_approved, spoc_number),
  sub2 as(
	select projectId, sched7, spoc_name, name, spoc_email, remarks, project_status, fy_timerange, budget_approved, spoc_number, b.disbursed from sub1 a left join profile_79979 b on a.projectid=b.projectid)
	select p.name as projectId, sched7, spoc_name, name, spoc_email, remarks, project_status, fy_timerange, budget_approved-disbursed as amount, spoc_number from sub2 
	left join ds_mysql_prod_project p
on p.id=projectid
where p.name in ('Omashram Trust', 'One Billion Literates', 'Cuddles Foundation', 'Rainbow Homes (ANC Rainbow Homes)', 'Rainbow Homes (Bosco Rainbow Homes)', 'Rainbow Homes (Sanrakshan Rainbow Homes)','CUPA', 'Parikrma Foundation')