with temp as(
  Select 'The objectives of the training were clearly defined' as col
  	union all
  Select 'Participation and interaction were encouraged' as col
  	union all
  Select 'The topics covered were relevant to me' as col
  	union all
  Select 'The content was organized and easy to follow' as col
  	union all
  Select 'This training experience will be useful in my work' as col
  	union all
  Select 'The trainer was knowledgeable about the training topics' as col
  	union all
  Select 'The trainer was well prepared' as col
  	union all
  Select 'The training objectives were met' as col
  	union all
  Select 'The time allotted for the training was sufficient' as col
  	union all
  Select 'Feedback of the training by the student' as col
),
s1 as(
Select t1.name as projectId,date_completion, temp.col as Beneficiary, p1.name as location_filter,
avg(case col
	when 'The objectives of the training were clearly defined' then sq.
	when 'Participation and interaction were encouraged' then sq.
	when 'The topics covered were relevant to me' then sq.
	when 'The content was organized and easy to follow' then sq.
	when 'This training experience will be useful in my work' then sq.
	when 'The trainer was knowledgeable about the training topics' then sq.
	when 'The trainer was well prepared' then sq.
	when 'The training objectives were met' then sq.
	when 'The time allotted for the training was sufficient' then sq.
	when 'Feedback of the training by the student' then sq.
		else NULL
end)as score
  FROM  profile_79267 sq
  cross join temp
left join ds_mysql_prod_project p1
ON sq.projectId=p1.id 
left join ds_mysql_prod_project t1
ON  t1.id=sq.projectId

GROUP BY t1.name,date_completion, Beneficiary,p1.name,
)
Select projectId, date_completion, Beneficiary
FROM s1