with temp1 as
(select projectId, indicator, proj, target, indi_parent.name as int_indi , year, project_code_new 
from profile_61044 as m

left join ds_mysql_prod_tagelement as indi
on m.indicator = indi.id
 
left join ds_mysql_prod_tagelement as indi_parent
on m.parent = indi_parent.id


left join profile_55194 AS r 
 on m.proj = r.project_code_new

),
 
/* left join ds_mysql_prod_tagelement as year
   on r.year = year.proj
 
left join ds_mysql_prod_tagelement as project_code_new
on r.project_code_new = project_code_new.proj),*/

temp2 as
( select projectId, indicator, proj, target,int_indi ,year,project_code_new  , sum(target) as target_updated from temp1 
group by indicator, target, int_indi, year, project_code_new)
select * from temp2


/*

with temp1 as
(select m.projectId, m.indicator, m.proj, m.target, indi_parent.name as int_indi , r.year, r.project_code_new 
from profile_61044 as m

left join ds_mysql_prod_tagelement as indi
on m.indicator = indi.id
 
left join ds_mysql_prod_tagelement as indi_parent
on indi.parent = indi_parent.id


left join profile_55194 AS r 
 on m.proj = r.project_code_new),
 
/* left join ds_mysql_prod_tagelement as year
   on r.year = year.proj
 
left join ds_mysql_prod_tagelement as project_code_new
on r.project_code_new = project_code_new.proj),*/

temp2 as
( select m.projectId, m.indicator, m.proj, m.target, indi_parent.name as int_indi , r.year, r.project_code_new  , sum(target) as target_updated from temp1 
group by m.indicator, m.target, m.int_indi, m.year, m.project_code_new)
select * from temp2


*/
