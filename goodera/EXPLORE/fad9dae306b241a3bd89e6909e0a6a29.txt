with table1 as (select projectid,indicator.name as indicator,int_indi.name as parent_indicator,focus.name as focus,proj,sum(target) as target from profile_61044 p

left join ds_mysql_prod_tagelement indicator
on p.indicator = indicator.id

left join ds_mysql_prod_tagelement int_indi
on indicator.parent = int_indi.id

left join ds_mysql_prod_tagelement focus
on int_indi.parent = focus.id
group by projectid,indicator.name,int_indi.name,focus.name,proj		  ),

table2 as (
select t1.projectid,indicator,parent_indicator,focus,proj,target,sum(fin.amount) as amount ,fin.month_timerange from table1 t1

left join  profile_55194 fin
on t1.proj=fin.project_code_new
group by t1.projectid,indicator,parent_indicator,focus,proj,target,fin.month_timerange)

select * from table2
