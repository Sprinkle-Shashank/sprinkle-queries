with sub1 as(
select projectId, sched7, spoc_name, location, project_duration, logo_image, project_descrip, project_name, spoc_email, project_status, fy_timerange, budget_approved, bene_num, spoc_number, name from profile_41363 where location is not null),
sub2 as (
select projectId, sched7, spoc_name, location1, project_duration, logo_image, project_descrip, project_name, spoc_email, project_status, fy_timerange, budget_approved, bene_num, spoc_number, name from sub1 a, a.location location1)
select projectId, fy_timerange, location1 as location, count(*) from sub2 group by projectId, fy_timerange, location