with sub1 as(
select p.name as projectId, sched7, spoc_name, location, project_duration, logo_image, project_descrip, project_name, spoc_email, project_status, fy_timerange, budget_approved, bene_num, spoc_number, a.name from profile_41363 a
  left join ds_mysql_prod_project p
  on p.id=projectid
  where location is not null),
sub2 as (
select projectId, sched7, spoc_name, location1, project_duration, logo_image, project_descrip, project_name, spoc_email, project_status, fy_timerange, budget_approved, bene_num, spoc_number, name from sub1 a, a.location location1)
select projectId, fy_timerange, t.name as location, count(*), case when projectId in ('Prasanna Trust', 'Kashtakari Panchayat', 'Shishu Mandir', 'SOUL', 'Narayanaamruta Medicare Foundation', 'SGBS Unnati Foundation','Makkala Jagariti', 'Reefwatch Marine Conservation', 'Nirvanavan Foundation', 'Win over cancer', 'Vipasana', 'Selco Foundation', 'CII Foundation', 'Disha') then 'Management Projects' when p.name in ('Omashram Trust', 'One Billion Literates', 'Cuddles Foundation', 'Rainbow Homes (ANC Rainbow Homes)', 'Rainbow Homes (Bosco Rainbow Homes)', 'Rainbow Homes (Sanrakshan Rainbow Homes)','CUPA', 'Parikrma Foundation','Other Projects') then 'Strategic Projects' else 'Other Projects' end as choose from sub2 
left join ds_mysql_prod_tagelement t
on t.id=location1
group by projectId, fy_timerange, t.name