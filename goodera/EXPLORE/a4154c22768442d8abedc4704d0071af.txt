WITH SUB1 AS (
  SELECT SE._id, SE.name, SE.fy_timerange, SE.shg_ent_name, SE.groups_reached, SE.fund_provided, SE.other_women,
  P.name AS projectname,
  SE.women_selected, 
  SER.name AS shg_ent,
  SE.other_women_2
--SE.women_added
--COUNT(*) AS registerations

  FROM profile_56593 AS SE

  LEFT JOIN ds_mysql_prod_project AS P
  ON SE.projectid = P.id

  LEFT JOIN ds_mysql_prod_tagelement AS SER
  ON SE.shg_ent = SER.id
  ),
  
  SUB2 AS (
	SELECT fy_timerange, shg_ent_name, groups_reached, fund_provided, other_women, projectname, shg_ent, other_women_2, WS, S1._id
	
	FROM SUB1 AS S1,
	
	S1.women_selected AS WS
	)
	
	SELECT fy_timerange, shg_ent_name, groups_reached, fund_provided, other_women, projectname, shg_ent, other_women_2, S1._id,
	BE.name AS women_selected
	
	FROM SUB2
	
	LEFT JOIN profile_56533 AS BE
	ON SUB2.WS = BE._id

--LEFT JOIN profile_56533 AS B
--ON B._id = SE.women_selected

--GROUP BY SE.name, SE.fy_timerange, SE.shg_ent_name, SE.groups_reached, SE.fund_provided, SE.other_women, P.name, SER.name, SE.other_women_2, BE.name