
Select  projectId, facility_name, strategic_yn, year_timerange, country, female_workers, male_workers, female_managers, male_managers, female_reps_worker, male_reps_workers, female_reps_management, male_reps_management, female_supervisors, male_supervisors, 
female_reps_management*100 AS a1,(female_reps_management + male_reps_management) AS b1,
a1/b1 AS f1,

female_managers*100 AS a2, (female_managers+male_managers) AS b2,
a2/b2 AS f2,

female_reps_worker*100 AS a3, (female_reps_worker + male_reps_workers) AS b3,
a3/b3 AS f3,

(female_workers+female_supervisors)*100 AS a4, (female_workers + female_supervisors+male_workers+male_supervisors) AS b4,
a4/b4 AS f4,

CASE WHEN(f1>f2 AND f3>f4) THEN 'YES'
ELSE
'NO'
END AS result,

 ven.name as vendor from profile_76755 
left join ds_mysql_prod_tagelement prnme
on profile_76755.projectId = prnme.id
left join ds_mysql_prod_tagelement cnt
on prnme.parent = cnt.id
left join ds_mysql_prod_tagelement ven
on cnt.parent=ven.id

where f1>f2 AND f3>f4 AND country IN('Cambodia','vietnam');
--Group By projectId, facility_name, strategic_yn, year_timerange, country,f1, f3, f4, result, vendor, f2;




 



