select p.diagnosis1,p.diagnosis2, p1.age,cast(DATEPART(YEAR,p1.createddate) as varchar) as created_year , cast(DATEPART(YEAR,current_date) as varchar) as current_year ,
(current_year - created_year)+ age as current_age, 1 as count ,
case when (current_age>= 0 and current_age<=5) then 1    
	 when current_age>= 6 and current_age<=18 then 2
     when current_age>=19 and current_age<=40 then 3
     when current_age>=41 and current_age<=60 then 4
     when current_age > 60  then 5 else 0 end as category	   
from profile_58474 p
left join profile_58473 p1
on p.projectid = p1.projectid