with table1 as
(
  select p.diagnosis1,p1.age,cast(DATEPART(YEAR,p1.createddate) as varchar) as created_year , cast(DATEPART(YEAR,current_date) as varchar) as current_year ,
(current_year - created_year)+ age as current_age, 1 as count ,
case when current_age>= 0 and current_age<=5 then '0-5'    
	 when current_age>= 6 and current_age<=18 then '6-18'
     when current_age>=19 and current_age<=40 then '19-40'
     when current_age>=41 and current_age<=60 then '41-60'
     when current_age > 60  then '60+' else null end as category	   
from profile_58474 p
left join profile_58473 p1
on p.patient = p1._id
 ),
 
 
 table2 as
(
  select p.diagnosis2, p1.age,cast(DATEPART(YEAR,p1.createddate) as varchar) as created_year , cast(DATEPART(YEAR,current_date) as varchar) as current_year ,
(current_year - created_year)+ age as current_age, 1 as count ,
case when current_age>= 0 and current_age<=5 then '0-5'    
	 when current_age>= 6 and current_age<=18 then '6-18'
     when current_age>=19 and current_age<=40 then '19-40'
     when current_age>=41 and current_age<=60 then '41-60'
     when current_age > 60  then '60+' else null end as category	   
from profile_58474 p
left join profile_58473 p1
on p.patient = p1._id
 )
 selcect * from table1
 union
 select * from table2