select t1.name as category, p.name, projectId, p.time_period_timerange, SUBSTRING(CAST(p.time_period_timerange.start as VARCHAR),1,4) as time , reg.name as region,reg_parent.name as region_global, t2.name as organization, amount, grant_period, purpose, t3.name as state, sdg,gender, age_group, bene_served, sum(amount) as amount_alloc
from profile_56194 p
Left join ds_mysql_prod_tagelement reg
on p.region = reg.id

left join ds_mysql_prod_tagelement reg_parent
on reg.parent = reg_parent.id

left join ds_mysql_prod_tagelement t1
on p.program_category = t1.id
left join ds_mysql_prod_tagelement t2
on p.organization = t2.id
left join ds_mysql_prod_tagelement t3
on p.state = t3.id


group by t1.name,p.time_period_timerange , region_global , t2.name, t3.name , p.name , p.projectId , reg.name , sdg, gender, age_group , bene_served , p.amount , p.grant_period , p.purpose