with temp as(
  Select 'teacher_enrolled' as col
    union all
  Select 'teachers_digital_badge' as col
    union all
  Select 'ctlt_lessons' as col
)
select a.fy_timerange,b.school_name as school,count(*) as val,temp.col as dimensions,
sum(case col
	when 'teacher_enrolled' then a.teacher_enrolled
	when 'teachers_digital_badge' then a.teachers_digital_badge
	when 'ctlt_lessons' then a.ctlt_lessons
	  else NULL
end) as Values
from profile_79306 a 
cross join temp
left join profile_79305 b on a.school = b._id

group by a.fy_timerange,b.school_name,dimensions