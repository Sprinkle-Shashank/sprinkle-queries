with sub1 as (select p1.name as projectid,t1.name as finanacial_period,datatablebase,tablesettings,questiontext

from sus_56551 p1
left join ds_mysql_prod_tagelement t1 on t1.id=p1.financialperiod
where keyword='gri_water_withdrawal_details'),

sub2 as (select *,temp.consumption,cast(temp.quality as varchar),cast(temp.importance_local as varchar) from sub1 s1,unpivot s1.datatablebase as temp at source)

select * ,(Initcap(split_part(source, '_', 1)) || ' ' || split_part(source, '_', 2)) as source_text
from sub2

--switch(month(dateFromString($fy_timerange.start)),case(1,January),case(2,February),case(3,March),case(4,April),case(5,May),case(6,June),case(7,July),case(8,August),case(9,September),case(10,October),case(11,November),case(12,December) )