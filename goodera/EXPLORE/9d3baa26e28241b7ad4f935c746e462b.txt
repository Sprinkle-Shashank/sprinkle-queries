select split_part(split_part(prod.name,'|',1),'.',1) as projectcode,t.name as fy_timerange,case
when t2.name='January' then 'Quarter 4'
when t2.name='February' then 'Quarter 4'
when t2.name='March' then 'Quarter 4'
when t2.name='April' then 'Quarter 1'
when t2.name='May' then 'Quarter 1'
when t2.name='June' then 'Quarter 1'
when t2.name='July' then 'Quarter 2'
when t2.name='August' then 'Quarter 2'
when t2.name='September' then 'Quarter 2'
when t2.name='October' then 'Quarter 3'
when t2.name='November' then 'Quarter 3'
when t2.name='December' then 'Quarter 3'
end as Quarter,concat(projectcode,fy_timerange) as CODE,split_part(prod.name,'|',3) as censuscode,q.village,sum(p.hdfc_cost_monthly) as hdfc_cost from profile_29974 p
left join ds_mysql_prod_project prod on
prod.id=p.projectid
left join ds_mysql_prod_tagelement t
on p.fy=t.id
left join ds_mysql_prod_tagelement t1
on p.month=t1.id
left join profile_27489 q on
split_part(prod.name,'|',3)=q.name
group by 1,2,3,4,5,6