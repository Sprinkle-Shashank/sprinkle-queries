with table1 as ( select
  			case when lg_status !=848008 then 1 else 0 end as status,
			case when table_54646.projectId is null then 0 else 1 end as status1,
			substring(table_54646.projcode_factory,1,1) as code,
			JSON_SERIALIZE(table_52810.pace_brands) as pace_brand,	
			case when pace_brand like '%1151834%' then 1 else 0 end  as brand,
			case when offset_date is null then '2020-02-01T00:00:00.000Z' else offset_date end as offset_date,
			case when start_date > offset_date then 1 else 0 end as token,
			sum(num_females) as total_females,
			sum(num_females_graduated) as total_females_graduated,
			sum(num_females_dropout) as total_females_dropout,
			case when end_date_2 is null or end_date_2 = '' then num_females else 0 end as ongoing,
			sum(ongoing) as total_females_ongoing,
			case when end_date_2 is null or end_date_2 = '' then 1 else 0 end as batchongoing,
			sum(batchongoing) as total_batches_ongoing,
			case when data(end_date_2) = date then 1 else 0 end as batchcomp,
			sum(batchcomp) as total_batches_completed
				
			from profile_4227 p
  
				
				
join profile_54646 table_54646 on
table_54646.projectId = p.projectId		

inner join profile_52810 table_52810 on
table_52810.projectId = p.projectId

group by p.lg_status,table_54646.projectId,table_52810.pace_brands,table_54646.projcode_factory,table_52810.offset_date,p.start_date
)



select * from table1 p where status = 1 
and status1 = 1 
and brand = 1 and token = 1