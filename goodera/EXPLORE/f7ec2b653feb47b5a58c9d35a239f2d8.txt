Select t.name as projectid,fy_timerange, extract(year from cast(startdate as DATETIME)) as year, Sum(CASE 
             WHEN keyword = 'ww_generated' THEN datanumBase
             ELSE 0 
           END) AS ww_generated,
		   Sum(CASE 
             WHEN keyword = 'ww_treated' THEN datanumBase
             ELSE 0 
           END) AS ww_treated,
		   Sum(CASE 
             WHEN keyword = 'ww_untreated' THEN datanumBase
             ELSE 0 
           END) AS ww_untreated,
		   Sum(CASE 
             WHEN keyword = 'ww_reused' THEN datanumBase
             ELSE 0 
           END) AS ww_reused,
		   Sum(CASE 
             WHEN keyword = 'ww_treated_thirdparty' THEN datanumBase
             ELSE 0 
           END) AS ww_treated_thirdparty,
		   Sum(CASE 
             WHEN keyword = 'ww_untreated_thirdparty' THEN datanumBase
             ELSE 0 
           END) AS ww_untreated_thirdparty,
		   Sum(CASE 
             WHEN keyword = 'ww_discharged_other' THEN datanumBase
             ELSE 0 
           END) AS ww_discharged_other

from sus_79419

left join ds_mysql_prod_project t
on xprojectid=t.id

where keyword in ('ww_generated','ww_treated','ww_untreated','ww_reused','ww_treated_thirdparty','ww_untreated_thirdparty','ww_discharged_other')


--, ww_generated, ww_treated, ww_untreated, ww_reused, ww_treated_thirdparty, ww_untreated_thirdparty, ww_discharged_other