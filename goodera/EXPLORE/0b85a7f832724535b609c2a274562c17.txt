with s1 as(
 Select  ss._id,t.name as proj_location, t1.name as partner, t2.name as projectId,ss.name, ss.start_date fy_timerange,  ss.trainer_training,  ss.trainer_quali,  ss.no_of_comp,  ss.no_of_staff,  ss.center_type,pl.location,po.impl_agency as imp_partner
from profile_1484 ss
left join ds_mysql_prod_project t
on ss.projectid=t.id
left join ds_mysql_prod_project t1
on t.parent=t1.id
left join ds_mysql_prod_project t2
on t1.parent=t2.id
left join profile_65603 pl
on pl.projectid=ss.projectid
left join profile_65552 po
on t.parent=po.projectid
where t2.name is not null and  coalesce(ss.projectId,null)= 54090

)
Select s1.proj_location, s1.fy_timerange, s1.partner, s1.projectId, s1.imp_partner, s1.location, s1.center_type ,count(*) no_centers,sum(s1.no_of_staff) no_staff
from s1
group by s1.proj_location, s1.fy_timerange, s1.partner, s1.projectId, s1.imp_partner, s1.location, s1.center_type