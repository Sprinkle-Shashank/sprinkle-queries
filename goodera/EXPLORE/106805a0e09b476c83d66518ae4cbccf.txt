Select tagid, name as year  from ds_mysql_prod_tagelement
where 
tagid = '22221' 
order by year
  
/*select p.projectId as project,fac.name as factory,ven.name as vendor,cou.name as country,type.name as event_type,p.description,p.doc,p2.status,p.pic,p.pic_2,p.caption,p.caption_2 from profile_17524 p


		  
left join ds_mysql_prod_project fac
on p.projectid = fac.id
left join ds_mysql_prod_project ven
on fac.parent = ven.id
left join ds_mysql_prod_project cou
on ven.parent = cou.id
			
left join profile_16619 p2 on
p.projectId = p2.projectId

left join ds_mysql_prod_tagelement type
on p.event_type = type.id
			

			
where (cou.name <> 'Test Country' and cou.name <> 'GAP Inc.') and (p2.status = 1400365 or p2.status is null)
			
group by project,fac.name,cou.name,ven.name,type.name,p.description,p.doc,p2.status,p.pic,p.pic_2,p.caption,p.caption_2
*/

/*with table2 as(select p._id,p.projectId,stat.name as status_new,case when status_new = 'Deactivated' then
			   'Deactivated' when status_new  is null then 'Ongoing' end as Status,p.sustainability_rating as rating_2,row_number() over 
(partition by p.projectid
 order by p._id desc) as row,to_char(p.date,'DD-MM-YYYY') as current_date
			   from profile_31726 p
	   
left join ds_mysql_prod_tagelement stat
on p.status = stat.id
),
table6 as 
(select * from table2 where row=1 
),

/*table4 as 
	 (select p.projectid,p._id, decode(p.sustainability_rating,null,0,p.sustainability_rating) as rating_1
 , row_number() over 
(partition by p.projectid
 order by p._id desc) as row from profile_17526 p
),
table5 as 
(select * from table4 
 where row=1 
),*/
table3 as(select p.projectId,fac.name as factory,ven.name as vendor,cou.name as country,p.status,
		 -- t5.rating_1,
		  decode(p2.sustainability_rating,null,0,p2.sustainability_rating) as rating_1,
		  to_char(p2.date,'DD-MM-YYYY') as start_date,p2.name as facility_names,t6.status,t6.rating_2,t6.current_date,abs(rating_1-rating_2) as differential,case when (differential >0) then 'down' 
when (differential < 0)
		  then 'up'
when (differential = 0)
		  then '-'
end as trend
		  from profile_16619 p

		  

left join profile_17526 p2
on p.projectId = p2.projectId		  
		  
left join ds_mysql_prod_project fac
on p.projectid = fac.id
left join ds_mysql_prod_project ven
on fac.parent = ven.id
left join ds_mysql_prod_project cou
on ven.parent = cou.id



left join table6 t6 on
p.projectId = t6.projectId

/*left join table5 t5 on
p.projectId = t5.projectId*/

where (p.status = 1400365 or p.status is null) and (cou.name <> 'Test Country' and cou.name <> 'GAP Inc.') 
 
 group by p.projectId,fac.name ,ven.name ,cou.name ,p.status,rating_1 ,p2.date,t6.status,t6.rating_2,trend,t6.current_date,p2.name
)
select * from table3
*/