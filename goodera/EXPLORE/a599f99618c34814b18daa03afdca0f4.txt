with temp as(
  select 'doctors' as col
  union all
  select 'nurses' as col
  union all
  select 'healthcare_assistant' as col
  union all
  select 'community_mobilizers' as col
  union all
  select 'aasha_workers' as col
  union all
  select 'other_staff' as col
  union all
  select 'total_eligible' as col)
  
select p._id as id, p.name as site, temp.col as Dimensions,

sum(case col
		when 'doctors' then p.doctors
		when 'nurses' then p.nurses
		when 'healthcare_assistant' then p.healthcare_assistant
		when 'community_mobilizers' then p.community_mobilizers
		when 'aasha_workers' then p.aasha_workers
		when 'other_staff' then p.other_staff
		when 'total_eligible' then p.total_eligible
	else NULL
end) as values,
	
case
	when(p.end_date is NULL) then
	(p.start_date||'|'||cast(current_date as datetime))
	else
	(p.start_date||'|'||p.end_date)
end as fy_timerange

from profile_78079 p
cross join temp
	group by id, site, dimensions, fy_timerange
  