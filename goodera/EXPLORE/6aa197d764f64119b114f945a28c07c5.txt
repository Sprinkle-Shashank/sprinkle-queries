with tab1 as ( SELECT p1.fy_timerange,p1.total_assp, p1.total_nios,
P.name AS projectname,
t1.name AS program,
t2.name AS frequency,
p1.name AS student_assp,
t3.name AS program_2,
t4.name AS frequency_2,
p1.name AS student_nios

FROM profile_56185 AS p1

LEFT JOIN ds_mysql_prod_project AS P
ON p1.projectid = P.id

LEFT JOIN profile_56184 AS p2
ON p2._id = p1.student_assp

LEFT JOIN ds_mysql_prod_tagelement t1
ON t1.id = p1.program

LEFT JOIN ds_mysql_prod_tagelement t2
ON t2.id = p1.frequency

LEFT JOIN ds_mysql_prod_tagelement t3
ON t3.id = p1.program_2

LEFT JOIN ds_mysql_prod_tagelement t4
ON t4.id = p1.frequency_2)

Select fy_timerange,total_assp,total_nios,frequency,frequency_2,student_assp,student_nios,count(*) as totalMid
from tab1
where frequency = 'Annual' or frequency_2 = 'Annual' 
group by 1,2,3,4,5,6,7

/*Select fy_timerange,total_assp,total_nios,frequency,frequency_2,totalMid,count(*) as totalFinal
from tab2
where frequency = 'Annual' or frequency_2 = 'Annual' 
group by 1,2,3,4,5,6*/