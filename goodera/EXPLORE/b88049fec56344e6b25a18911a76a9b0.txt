 select pro.name as projectid,fy_timerange/,fy,mwra_eligible_old,mwra_eligible_new,mwra_using_old,mwra_using_new,trunc(fy_timerange),
 row_number() over 
(partition by year order by fy_timerange asc) as row, Substring(json_serialize(fy_timerange),11,4)::smallint as year  
 
 from profile_59872 p
 
 left join ds_mysql_prod_project as pro
on p.projectid = pro.id