with table1 as
(select p.projectid , project_code_new ,p1.vertical from profile_55194 as p

left join profile_62881 p1 on 
p.project_code_new = p1._id
 ),
 
 table2 as 
 ( select p.*, q1 from table1 as p, p.vertical as q1)
 
select p.projectid  , new_1.name as vertical1 , new_2.name as vertical2 , 
case when vertical2 is null and vertical1 is null then 'Admin' 
when vertical1 is null then vertical2 
  end as verticals

from table2 as p
 
left join ds_mysql_prod_tagelement as new_1
on p.q1 = new_1.id
  
left join ds_mysql_prod_tagelement as new_2
on new_1.parent = new_2.id

order by verticals asc

 