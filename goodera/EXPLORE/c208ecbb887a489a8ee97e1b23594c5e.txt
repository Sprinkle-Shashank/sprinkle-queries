select p.projectId,  SUBSTRING(p.date, 1, 10) as new_date, p.grade, p.fy_timerange, reg3.name as course,count(*),p1.batchid from profile_46326 p

left join profile_53367 p1
on p.batch = p1._id
left join ds_mysql_prod_tagelement reg3
on reg3.id=p.course
where p.date is not null and grade is not null

Group By p.projectId,    p.grade, p.fy_timerange, new_date,reg3.name,p1.batchid
order by new_date 