with base1 as(
select substring(end_date,1,10) as end_date,CURRENT_DATE,date_cmp(cast(substring(end_date,1,10) as date),CURRENT_DATE) as datedif from profile_12743)
select end_date,CURRENT_DATE,case datedif
when -1 or 0
then 'completed' 
when 1
then 'pending'
else ''
end from base1