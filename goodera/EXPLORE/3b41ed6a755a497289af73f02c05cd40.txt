--46184, 46299, 46318, 46228, 55677, 55825\
---YYYY in mou_date
--x is no of months between mou_date and valid_date
--state_distric 2nd level
--sum(amount_released)
with base1 as(
  select prop_id,project_title,name_org,value.approved_amount,substring(mou_date,1,4) as yoa,
  MONTHS_BETWEEN(mou_date,valid_date) as project_duration,disbursement_thru,state.state_district,
  value.amount_released,value.payment_date from profile_46184 p,unpivot p.disbursement_plan as value at disbursement_plan,unpivot p.state_district as state at state_district
)
select * from base1