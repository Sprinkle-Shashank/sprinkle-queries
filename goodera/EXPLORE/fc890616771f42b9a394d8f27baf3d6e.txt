WITH table1 AS (SELECT xprojectid,financialperiod,keyword,name,datatablebase FROM sus_21557 AS p WHERE keyword = 'internal_training_programs'),

table2 AS (SELECT xprojectid,financialperiod,name, coun.tech_skills, coun.soft_skills,coun.health_safety,coun.other FROM table1 AS p, UNPIVOT p.datatablebase AS coun ),

table3 AS (SELECT xprojectid,financialperiod,keyword,name,datatablebase FROM sus_21557 AS p WHERE keyword = 'external_training_programs'),

table4 AS (SELECT xprojectid,financialperiod,name, coun.tech_skills, coun.soft_skills,coun.health_safety,coun.other FROM table3 AS p, UNPIVOT p.datatablebase AS coun )

select * from table4
/*SELECT t2.xprojectid,t2.financialperiod,t2.name,t1.name as company_category,'internal' as dim,tech_skills+soft_skills+health_safety+other as val FROM table2	t2

left join sus_46830 p
on t2.xprojectid = p.xprojectid

 left join tagElement_6664 t1 on t1.id = p.dataselect*/
 
 
 
 
 