with sub1 as (
select p.parent, p_54963.sub_cat_out_plan, p_54963.month, p_54963.fy, p_54963.subcat_output, p_54963.projectid
from profile_54963 p_54963

left join (select cast(y.id as varchar) as id, y.parent from ds_mysql_project y) p on p_54963.projectid=p.id
),

sub2 as (
select p.name, sub_cat_out_plan, month, fy, subcat_output, projectid, parent
from sub1

left join (select cast(y.id as varchar) as id, y.projectid, cast(SPLIT_PART(y.name, '|', 0) as varchar) as name from ds_mysql_project y) p on parent = p.id
)

select sub_cat_out_plan, month, fy, subcat_output, projectid, parent, name
from sub2
order by fy