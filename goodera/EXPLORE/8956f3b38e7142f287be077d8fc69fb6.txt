select  p1._id, tag1.name as projectId, p1.Grievance,  tag2.name as select_factory_msa,p2.country, p3.factory, p2.vendor, p2.cycle, p2.consultant, p2.product_category,
case 
when grievance = 1105581 then 5
when grievance = 1105582 then 4
when grievance = 1105583 then 3
when grievance = 1105585 then 1
else 2
end as grievance1,

case 
when grievance1 >= 3 then 1
else 0
end as all_questions,
count(*) as count
from profile_62477 p1
left join profile_64362 p2
on p1.projectId = p2.projectId
left join profile_64170 as p3
on p2.factory = p3._id
left join ds_mysql_prod_tagelement tag1
on p1.projectId = tag1.id
left join ds_mysql_prod_tagelement tag2
on p1.select_factory_msa = tag2.id
group by p1._id, p1.projectId, p3.factory, vendor, consultant, country, cycle, product_category, Grievance, All_Questions, select_factory_msa,tag1.name,tag2.name