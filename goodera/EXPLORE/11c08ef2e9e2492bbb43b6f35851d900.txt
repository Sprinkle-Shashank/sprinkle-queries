select p.name_vendor_filter,p.name_country,fac.name as facility_name,ven.name AS vendor from profile_54646 p

left join profile_4227 on 
p.projectId = profile_4227.projectId

left join ds_mysql_prod_project fac
on p.projectId = fac.id
left join ds_mysql_prod_project ven
on fac.parent = ven.id

group by p.name_vendor_filter,p.name_country,fac.name ,ven.name 