with table1 as (select fy_timerange, br.name as brand,bn.name as business,mt.name as material, sum(weight) as weight, fkey from profile_63455 p1


left join ds_mysql_prod_tagelement br
on p1.brand = br.id


left join ds_mysql_prod_tagelement bn
on p1.business = bn.id
			

left join ds_mysql_prod_tagelement mt
on p1.material = mt.id
			
				
group by fy_timerange, br.name, bn.name, mt.name, fkey)

select t1.fy_timerange, t1.brand, t1.business, t1.material, first(weight) as weight2, ct.name as cotton_type, sum((volume/1000) as bciweight) as bciweight from table1 t1

left join profile_62947 t2 on 
t1.fkey = t2.name

left join ds_mysql_prod_tagelement ct
on t2.cotton_type = ct.id

group by  t1.fy_timerange, t1.brand, t1.business, t1.material, ct.name


