with temp as 
(
  select 'material_type'  as col
  union all
  select 'cotton_type' as col
)
,
table1 as 
(
select fy_timerange, brand, business, division, material,sum(weight) as weight, fkey
from profile_63455 
			
group by fy_timerange,brand, business, division,material, fkey),

table2 as (
select fy_timerange, brand, business, material, t2.cotton_type,sum((volume/1000)) as bciweight,first_value(weight) over()
from table1

left join profile_62947 t2 on 
table1.fkey = t2.name

group by fy_timerange, brand, business, material, t2.cotton_type
)

select * from table2

  
