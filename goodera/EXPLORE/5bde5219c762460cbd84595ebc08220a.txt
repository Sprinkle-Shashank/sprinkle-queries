with table1 as
( select  m.projectId, m._id , project_name, vertical, focus, start_date, project_code, entity , row_number() over 
(partition by m.projectid
 order by m._id desc) as row from profile_62881 as m
 ),
 
 table2 as
 (
 select * from table1 where row=1
   )
  
  select * from table2



/*

With temp1 AS 
(SELECT m.projectId, m._id, m.project_name, m.vertical, m.focus, m.start_date, m.project_code, m.entity,
r.completed, r.fy_timerange AS fy_timerange_r, r.progress , ROW_NUMBER() over (order by m.projectId ) as row

FROM profile_62881 AS m

LEFT JOIN profile_55471 AS r
ON m.project_code = r.project_code

Group by m.projectId, m._id, m.project_name, m.vertical, m.focus, m.start_date, m.project_code, m.entity, r.completed, r.fy_timerange, r.progress
)

SELECT * from temp1 where row = 1






, LISTAGG(CAST(fy_timerange_r.end AS date),',') AS update_date_1, LISTAGG(prog.name,',') AS progress_2, LISTAGG(compl.name,',') AS complete_2,

CASE when compl.name = 'Yes' THEN CAST(fy_timerange_r.end AS date) when compl.name IS NULL Then CAST('2030-01-01' AS date) END AS end_date, CASE when end_date IS NULL Then CAST('2030-01-01' AS date) ELSE end_date END AS end_date_new,


left join ds_mysql_prod_tagelement as prog
  on r.progress = prog.id

left join ds_mysql_prod_tagelement as compl
  on r.completed = compl.id

, compl.name, end_date, end_date_new

ORDER BY m.project_code ASC, update_date_1 ASC
*/