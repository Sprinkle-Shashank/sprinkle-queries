SELECT m.projectId, m._id, m.project_name, m.vertical, m.focus, m.start_date, m.project_code, m.entity,
r.completed, r.fy_timerange AS fy_timerange_r, r.progress, LISTAGG(CAST(fy_timerange_r.end AS date),',') AS update_date_1, LISTAGG(prog.name AS progress_1,',') AS progress_2, LISTAGG(compl.name AS complete_1,',') AS complete_2
FROM profile_62881 AS m

LEFT JOIN profile_55471 AS r ON m.project_code = r.project_code

left join ds_mysql_prod_tagelement as prog
  on r.progress = prog.id

left join ds_mysql_prod_tagelement as compl
  on r.completed = compl.id

Group by m.projectId, m._id, m.project_name, m.vertical, m.focus, m.start_date, m.project_code, m.entity, r.completed, r.fy_timerange, r.progress

ORDER BY m.project_code ASC, update_date ASC
