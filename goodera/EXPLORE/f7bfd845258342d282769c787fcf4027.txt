select p1.time_timerange as fy_timerange, t1.name as country, t2.name as prod_brand, t3.name as focus_area, extract(year from cast(p1.time_timerange as date)) as year_check, sum(p1.amt_leveraged) 
from profile_32441 p1
left join profile_63775 p2 on p2._id = p1.program_name
left join ds_mysql_prod_tagelement t1 on t1.id = p1.country
left join ds_mysql_prod_tagelement t2 on t2.id = p2.product_brand
left join ds_mysql_prod_tagelement t3 on t3.id = p2.foc_area
where p1.amt_leveraged is not null
group by p1.time_timerange, t1.name, t2.name, t3.name, year_check