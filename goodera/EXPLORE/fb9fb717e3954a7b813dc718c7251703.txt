--Genpact Communications Gallery
WITH SUB1 AS (
  SELECT P1.pic,
  P1.month_timerange AS fy_timerange,
  P1.title AS title1,
  P1.projectId AS ProjectID3,
  P2.name AS project,
  CAST(P1.month_timerange.start AS date) AS start,
  p3.name as  projectid1, p4.name as projectid2,
  EXTRACT(MONTH FROM start) AS month,
  EXTRACT(YEAR FROM start) AS year,
  
  CASE
  	WHEN month = 1 THEN 'Jan'
  	WHEN month = 2 THEN 'Feb'
  	WHEN month = 3 THEN 'Mar'
  	WHEN month = 4 THEN 'Apr'
  	WHEN month = 5 THEN 'May'
	WHEN month = 6 THEN 'Jun'
	WHEN month = 7 THEN 'July'
	WHEN month = 8 THEN 'Aug'
	WHEN month = 9 THEN 'Sep'
	WHEN month = 10 THEN 'Oct'
	WHEN month = 11 THEN 'Nov'
	WHEN month = 12 THEN 'Dec'
	--ELSE 'No Data Entry'
  	END AS month1,

  
  case 
when p3.name  = 'SCCD'
then 'SCCD' 
else p4.name 
end as projectname
  

  FROM profile_55828 AS P1

 LEFT JOIN ds_mysql_prod_project AS P2
 ON P2.id = P1.projectId
 left join ds_mysql_prod_project p3
on p3.id = p1.projectId
left join ds_mysql_prod_project p4
on p4.id = p3.parent
left join ds_mysql_prod_project p5
on p5.id = p4.parent
  
  ORDER BY fy_timerange DESC
)

SELECT SUB1.*,
project || ' - ' || month1 || ' (' || year || ')' || ' - ' || title1  AS title

FROM SUB1