select pro.name as projectid ,fy_timerange,sum(amount),q.states from profile_77073 p 
left join ds_mysql_prod_project pro 
on p.projectId = pro.id
group by pro.name,fy_timerange

left join profile_46742 q
on p.porjectid = q.projectid