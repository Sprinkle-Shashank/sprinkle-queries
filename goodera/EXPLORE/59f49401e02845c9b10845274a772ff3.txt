with table1 as(select pro.name as projectid ,p.fy_timerange,amount from profile_77073 p 
left join ds_mysql_prod_project pro 
on p.projectId = pro.id

),

table2 as(select projectid,fy_timerange,amount  from table1 t1 )

select projectid,fy_timerange,sum(amount/10^7) as amount  from table2 t2


left join ds_mysql_prod_tagelement sta 
on t2.state = sta.id
group by projectid,fy_timerange

--select * from table1

