with s1 as (
  Select * from profile_77527
  )
Select t.name as projectid, s1._id,
 s1.name,s1.fy_timerange,ss.school_name as school_name,ss1.batch_name as batch_name ,s1.roll_no ,s1.student_name ,s1.guardian_name ,s1.student_age ,s1.student_class ,s1.student_phone,s1.student_photo,s1.student_certificate,s1.student_score,count(*) as Count from s1
left join profile_77524 ss
  on s1.school_name=ss._id
  left join profile_77526 ss1
  on s1.batch_name=ss1._id
  left join ds_mysql_prod_project t
  on s1.projectid=t.id
group by
t.name, s1._id,
 s1.name,s1.fy_timerange,ss.school_name ,ss1.batch_name ,s1.roll_no ,s1.student_name ,s1.guardian_name ,s1.student_age ,s1.student_class ,s1.student_phone,s1.student_photo,s1.student_certificate,s1.student_score