with s1 as(
select p.fy_timerange,name_1, listagg(DISTINCT t.batch_course) finally_shortlisted_for, count(*) from profile_79375 p
left join profile_79374 t
on p.finally_shortlisted_for = t._id
group by 1,2),

with s2 as(
select s1.*,fsf
from s1 as s3,s3.finally_shortlisted_for as fsf)

select s2.*
from s2