--profiles = 12743,16297
--Project title	Schedule VII	local_area	target_geog	target_geog	start_date, end_date
with base1 as(
select grantproposalid,name,schedule_seven,local_area,value.state,value.district,datediff(month,start_date,end_date) as duration from profile_12743 p1,unpivot p1.target_geog as value at target_geog
union all
select grantproposalid,name,schedule_seven,local_area,value.state,value.district,datediff(month,start_date,end_date) as duration from profile_16297 p1,unpivot p1.target_geog as value at target_geog
),base2 as(
select grantproposalid,appr_amount_2 from profile_14579
),base3 as(
select grantproposalid,name as impname,csr_no from profile_12104
)
select name,schedule_seven,local_area,state,district,duration,b2.appr_amount_2,b3.impname,b3.csr_no from base1 b1
left join base2 b2
on b1.grantproposalid = b2.grantproposalid
left join base3 b3
on b1.grantproposalid = b3.grantproposalid