with table1 
(
  select * , cou.name as country_1 , fac_c_i.name as fac_c_i_1 , vendor_n_i.name as vendor_n_i_1 from profile_52810 as p
  
  left join ds_mysql_prod_tagelement cou on 
  p.country = cou.id 
  
  left join ds_mysql_prod_tagelement fac_c_i 
  p.fac_cl_vpid = fac_c_i.id
  
  left join ds_mysql_prod_tagelement vendor_n_i
  p.vendor_ngo_id = vendor_n_i.id 
  
  ),
  
  table2 as 
  (
	select p.* , fac.name as factory_name, ven.name as vendor, pr10.country , pr10.fac_cl_vpid , pr10.vendor_ngo_id , pr10.primary_category from profile_64075 p

left join ds_mysql_prod_project fac
on  p.projectid = fac.id

left join ds_mysql_prod_project ven
on fac.parent = ven.id

left join ds_mysql_prod_project cou
on ven.parent = cou.id

left join profile_52810 pr10 on 
p.projectid = pr10.projectid 

where (p.projectId <> 31303 and p.projectId <> 46455 and p.projectId <> 54832 and p.projectId <> 31299) and p.projectId ilike'%%'

group by  p.projectId, remarks, p.name, training_id, project_name, trainer_org, date_1, date, num_female, num_male, prospect_female, total_supervisors, total_other_participants, prospect_total, prospect_male, vendor, pr10.country , pr10.fac_cl_vpid , pr10.vendor_ngo_id , pr10.primary_category , p._id , fac.name , ven.name
	)
	
	select * from table1

/*
 projectId, remarks, name, training_id, project_name, trainer_org, date_1, date, num_female, num_male, prospect_female, total_supervisors, total_other_participants, prospect_total, prospect_male, vendor, country, fac_cl_vpid, vendor_ngo_id, primary_category, id
 
 
 , cou.name as country , pr10.country as country_10, pr10.fac_cl_vpid as fac_cl_vpid_10, pr10.vendor_ngo_id as vendor_ngo_id_10, pr10.primary_category as primary_category_10 
 
 
country, fac_cl_vpid, vendor_ngo_id, primary_category
*/