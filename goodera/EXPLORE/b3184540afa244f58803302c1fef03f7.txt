with lookup as (select task.approvallog, p.subcat_output, task.status, split_part(split_part(prod.name,'|',1),'.',1) as ProjectCode,f.name as fy_timerange,m.name as Month,concat(ProjectCode,fy_timerange) as CODE,split_part(prod.name,'|',3) as census, p._id, case when p.subcat_output is not NULL and p.flag_deviation_delay='1' then 1 else 0 end  as devreported, case when ((task.status='SUBMITTED' and task.approvallog is not NULL) or (task.status='PENDING_APPROVAL')) then 0 else 1 end  as datacheck from profile_54963 p
left join ds_mongo_taskresponse task on
task.profileinstanceid=p._id

/*select p.profileinstanceid, p.status, p.data, approval, submission from taskresp_54963 p, p.approvallog approval, p.submissionlog submission
left join profile_54963 p1 on
p.profileinstanceid=p1.id*/