with sub1 as(
  select p1.name, p1.fy_timerange, p1.startdate, unwind.scope_1_figure
from sus_56551 p1, unpivot p1.datatablebase unwind at row
where keyword = 'gri_scope_1_emission')

select s1.fy_timerange, sum(s1.scope_1_figure) as values, 
extract(year from cast(s1.startdate as date)) as year, 'Scope 1 Emission' as emission_type,

case s1.name
	when 'TCML - Magadi, Kenya' then 'TCML'
	when 'TCNA - Wyoming, USA' then 'TCNA'
	when 'Mithapur, India' then 'Mithapur'
	when 'TCE - (WN, LS, CHP)' then 'TCE'
	when 'Mambattu' then 'Mambattu'
	else 'Cuddalore'
end as projectid

from sub1 s1
group by s1.fy_timerange, s1.name, s1.startdate