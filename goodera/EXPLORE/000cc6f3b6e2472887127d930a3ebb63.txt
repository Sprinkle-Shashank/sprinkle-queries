with table1 as (select projectid,diagnosis1,sel_camp from profile_58474
group by  projectid,diagnosis1,sel_camp),

table2 as (select projectid,diagnosis2,sel_camp from profile_58474
group by  projectid,diagnosis2,sel_camp),

table3 as ( select * from table1 union select * from table2)

select nvl2(SUBSTRING(diagnosis.name, 1, POSITION(' -' in diagnosis.name)), SUBSTRING(diagnosis.name, 1, POSITION(' -' in diagnosis.name)),diagnosis.name) as disease  from table3 t

left join ds_mysql_prod_tagelement diagnosis
on t.diagnosis1 = diagnosis.id