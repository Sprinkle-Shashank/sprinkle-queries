with table1 as (select projectid,diagnosis1,sel_camp,patient from profile_58474
group by  projectid,diagnosis1,sel_camp,patient),

table2 as (select t.* , diagnosis from table1 t ,t.diagnosis1 as diagnosis),

table3 as (select projectid,diagnosis2,sel_camp,patient from profile_58474
group by  projectid,diagnosis2,sel_camp,patient),

table4 as (select t.* , diagnosis from table3 t ,t.diagnosis2 as diagnosis),

table5 as ( select * from table2 union select * from table4)
--select * from table5

select nvl2(SUBSTRING(diagnosis.name, 1, POSITION(' -' in diagnosis.name)), SUBSTRING(diagnosis.name, 1, POSITION(' -' in diagnosis.name)),diagnosis.name) as disease ,   -- diease
cast(DATEPART(YEAR,p1.createddate) as varchar) as created_year ,cast(DATEPART(YEAR,current_date) as varchar) as current_year, --year
(current_year - created_year)+ p1.age as current_age,

((cast(DATEPART(YEAR,current_date) as varchar)) - (cast(DATEPART(YEAR,p1.createddate) as varchar)))+ p1.age as year,
1 as count from table5 t

left join ds_mysql_prod_tagelement diagnosis
on t.diagnosis = diagnosis.id
left join profile_58473 p1
on t.patient = p1._id

where t.projectid is not null
group by diagnosis.name ,p1.createddate ,p1.age