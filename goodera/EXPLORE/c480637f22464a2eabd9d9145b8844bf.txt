select distinct projectid ,prod_method, case when efficiency is not null then 1 else 0 end as count from profile_4227 as pr_27

where efficiency is not null and prod_method = 334156
