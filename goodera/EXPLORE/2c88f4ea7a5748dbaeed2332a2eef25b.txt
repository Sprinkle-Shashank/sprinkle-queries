
with
t3 as
(SELECT * 
FROM
(Select   projectId,  class,  eh_beginner from profile_65267 p
)
UNPIVOT (
    val FOR dim IN (eh_beginner))

)
,
t4 as (
select projectId, class,sum(val) as val,dim from t3 as p


where val is not null

Group By p.projectId,  dim
  ),
  t5 as (select t1.*,clas from t4 t1 , t1.class as clas)
  
  select projectId,  clas   , val,dim from t5 as p

