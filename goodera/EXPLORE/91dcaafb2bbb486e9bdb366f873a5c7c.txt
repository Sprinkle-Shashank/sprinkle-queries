with sub1 as(
  select xprojectid, fy_timerange, keyword, 'Scope 1' as scope,

sum(
  case
  	when keyword = 'generator_consump' then datanumbase * 0.00259411
	else datanumbase * 0.001
end) as col 

from sus_9539

where keyword in ('generator_consump', 'co2_refilled', 'dry_powder_refilled') 
and datanumbase is not null and datanumbase != 0

group by xprojectid, fy_timerange, keyword)

select xprojectid, fy_timerange, keyword, 1 as scope, datatablebase 
from sus_9539
where keyword = 'refrigerant_type_amount'