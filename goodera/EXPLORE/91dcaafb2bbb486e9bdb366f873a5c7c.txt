with sub1 as(
  select xprojectid, fy_timerange, keyword, 'Scope 1' as scope,

sum(
  case
  	when keyword = 'generator_consump' then datanumbase * 0.00259411
	else datanumbase * 0.001
end) as col 

from sus_9539

where keyword in ('generator_consump', 'co2_refilled', 'dry_powder_refilled') 
and datanumbase is not null and datanumbase != 0

group by xprojectid, fy_timerange, keyword),

sub2 as(
  select s1.xprojectid, s1.fy_timerange, s1.keyword, 'Scope 1' as scope, s1.datatablebase, table1.refrigerant_type, table1.refrigerant_amount

from sus_9539 s1, UNPIVOT s1.datatablebase as table1
where keyword = 'refrigerant_type_amount' and s1.datatablebase is not NULL)

select s2.xprojectid, s2.fy_timerange, s2.keyword, s2.scope, refrigerant_type_unwind, s2.refrigerant_amount
from sub2 s2, s2.refrigerant_type refrigerant_type_unwind