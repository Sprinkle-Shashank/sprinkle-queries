with tab1 as (select t.name as fy,total_cost_yearly as direct_cost,q.name as project_code,village_name from profile_29973 p
left join ds_mysql_prod_tagelement t on
p.fy=t.id
left join profile_27396 q on
p.prj_code=q._id),
tab2 as (select t.name as fy,p1.cost_yearly as Indirect_cost,q1.name as project_code,p1.village_name from profile_29976 p1
left join ds_mysql_prod_tagelement t on
p1.fy=t.id
left join profile_27396 q1 on
p1.prj_code=q1._id)
select t1.direct_cost,t2.Indirect_cost,sum(t1.direct_cost+t2.Indirect_cost) as total,t1.fy,t1.village_name,t1.project_code from tab1 t1 
left join tab2 t2 on
t1.project_code=t2.project_code
group by t1.direct_cost,t2.Indirect_cost,t1.fy,t1.village_name,t1.project_code
