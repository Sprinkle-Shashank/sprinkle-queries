select p5.id as event_id, p6.created as start_date, p6.created as end_date, 
(cast(p6.timetaken as float)/60) as duration, cast(NULL as varchar) as country, p7.created as participation_date, p5.opportunityType, test2.partnername as orgpartnerid--, test3.text
from ds_mysql_prod_empOpportunity p5
LEFT JOIN ds_mysql_prod_empMicroOpportunity p6 ON p6.empOpportunityId = p5.id
LEFT JOIN ds_mysql_prod_empMicroContributor p7 ON p7.empMicroOpportunityId = p6.id
LEFT JOIN ds_mysql_prod_orgpartner test2 on test2.id = p5.orgpartnerid
LEFT JOIN ds_mysql_prod_empopportunityorganizer test3 on test3.empopportunityid = p6.empopportunityid
where UPPER(p5.opportunityType) = 'MIC' and p5.securityContextId = 1615 and p5.active = 1 and p7.active = 1 and p6.timetaken is not null and p6.timetaken != 0-- and nvl(test3.active,100) != 0