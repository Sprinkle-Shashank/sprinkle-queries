with sub1 as(
  select p1._id, p3.name as projectid, p4.name as profile_name p2.taskid, p2.status, p2.approvallog 
from profile_36901 p1

left join ds_mongo_taskresponse p2 on p2._id = p1.taskresponseid

left join ds_mysql_prod_project p3 on p3.id = p1.projectid

left join ds_mysql_prod_profile p4 on p4.id = p2.profileid)

select s1.*, log, 
cast(log."approvalStatus" as VARCHAR) as approval_status, 
cast(log."approverEmail" as VARCHAR) as approver_email, 
cast(log."approverName" as VARCHAR) as approver_name,
cast(log."approverComments" as VARCHAR) as approver_comments,
cast(log."timestamp" as DATE) as approval_date
from sub1 s1, s1.approvallog log