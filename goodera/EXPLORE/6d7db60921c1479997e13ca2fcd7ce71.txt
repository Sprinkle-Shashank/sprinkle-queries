select p1._id as id, p1.fy_timerange, extract(year from cast(p1.fy_timerange.start as date)) as year, p1.cdms_id, p1.num_females, p2.region, p2.source_div, p2.timeperiod_timerange,

row_number() over(partition by p1._id order by p2.timeperiod_timerange.start desc) as row

from profile_62972 p1
left join profile_60928 p2 on p2.factory_id = p1.cdms_id