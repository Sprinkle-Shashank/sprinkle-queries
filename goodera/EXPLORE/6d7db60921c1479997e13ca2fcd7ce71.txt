with sub1 as(
  select vendor_name, vendor_vms_id, vendor_region, factory_name, factory_cdms_id, fy_timerange, extract(year from cast(fy_timerange.start as date)) as year,
dense_rank() over(partition by year order by fy_timerange.start desc) as row
from profile_66533)

select * from sub1