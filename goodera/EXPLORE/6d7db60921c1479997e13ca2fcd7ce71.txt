with sub1 as(
  select factory_vms_id,
 extract(year from cast(quarter_timerange.start as date)) as year,
dense_rank() over(partition by year order by quarter_timerange.start desc) as row
from profile_66533
where factory_vms_id is not null)

select * from sub1