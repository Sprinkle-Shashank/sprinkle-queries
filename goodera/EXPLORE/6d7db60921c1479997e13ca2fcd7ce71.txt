with sub1 as(
  select CAST(data.quarter_timerange as SUPER) as fy_timerange, cast(data.cdms_id as int), cast(data.democratically_elected as int), cast(data.cap_democratically_elected as varchar) 
from ds_mongo_profileinstance 
where profileid = 66533 and active = 't')

select fy_timerange, cdms_id, t1.name as democratically_elected, cap_democratically_elected,
case
	when t1.name = 'Yes' or t1.name = 'NA' or ((t1.name = 'Partial' or t1.name = 'No') and len(cap_democratically_elected)) > 10 then 1 
	else 0
end as test

from sub1
left join ds_mysql_prod_tagelement t1 on t1.id = democratically_elected
where t1.name is not null