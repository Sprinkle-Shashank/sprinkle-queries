with sub1 as(
  select p1._id as id, p1.submissionlog, p1.taskuserid, p1.status, p1.approvallog, p1.active, p1.profileid

from ds_mongo_taskresponse p1

where status = 'REJECTED' and profileid = 145 and active = 't'

union all

select p2._id as id, p2.submissionlog, p2.taskuserid, p2.status, p2.approvallog, p2.active, p2.profileid

from ds_mongo_taskresponse p2

where status = 'REJECTED' and profileid = 36901 and active = 't')

select s1.id, t3.sectionid, s1.submissionlog, s1.status, s1.approvallog, s1.active, s1.profileid

from sub1 s1

left join ds_mysql_prod_taskuser t1 on t1.id = s1.taskuserid
left join ds_mysql_prod_task t2 on t2.id = t1.taskid
left join ds_mysql_prod_flowtask t3 on t3.id = t2.flowtaskid