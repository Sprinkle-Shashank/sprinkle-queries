with sub1 as(
  select p1.*,
case
	when IS_ARRAY(p1.sched7) = false or GET_ARRAY_LENGTH(p1.sched7) = 0 then ARRAY(p1.sched7)
	else p1.sched7
end as sched7_new,
case
	when IS_ARRAY(p1.focus_area) = false or GET_ARRAY_LENGTH(p1.focus_area) = 0 then ARRAY(p1.focus_area)
	else p1.focus_area
end as focus_area_new

from profile_41363 p1),

sub2 as(
  elect s1.*, sched7_unwind, focus_area_unwind
from sub1 s1, s1.sched7_new sched7_unwind, s1.focus_area_new focus_area_unwind)

select * from sub2
