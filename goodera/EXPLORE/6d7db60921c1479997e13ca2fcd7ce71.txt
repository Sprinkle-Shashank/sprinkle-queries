with sub1 as(
  select p2.name as projectid, p1._id as id, t1.name as fy_timerange, 
split_part(split_part(p1.name, '|', 1), '.', 1) as project_code, 
split_part(p1.name, '|', 2) as region

from profile_60787 p1

left join ds_mysql_prod_tagelement t1 on t1.id = p1.fy
left join ds_mysql_prod_project p2 on p2.id = p1.projectid),

sub2 as(
  select s1.projectid, s1.id, s1.fy_timerange, s1.project_code, s1.region, 
t2.name as core_area, t3.name as project_manager

from sub1 s1 

left join profile_27396 p2 on p2.name = s1.project_code

left join ds_mysql_prod_tagelement t2 on t2.id = p2.focus_area
left join ds_mysql_prod_tagelement t3 on t3.id = p2.project_manager)

select p4.name as projectid, p3._id as id, p3.name as project_code, t4.name as fy_timerange, 
p3.focus_area as core_area, t5.name as project_manager

from profile_27420 p3

left join ds_mysql_prod_project p4 on p4.id = p3.projectid
left join profile_27396 p5 on p5._id = p3.project_code

left join ds_mysql_prod_tagelement t4 on t4.id = p3.fy
left join ds_mysql_prod_tagelement t5 on t5.id = p5.project_Manager