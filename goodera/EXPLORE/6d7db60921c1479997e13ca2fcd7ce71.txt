with sub1 as(
  select p1.id as event_id, p2.startdate as start_date, nvl(p2.enddate, p2.startdate) as end_date, INITCAP(p2.countryname) as country, p4.created as participation_date, cast(p4.duration as float) as duration, p1.opportunityType, test1.partnername as orgpartnerid, test2.text, test2.active
from ds_mysql_prod_empOpportunity p1
LEFT JOIN ds_mysql_prod_empVolunteeringOpportunity p2 ON p2.empOpportunityId = p1.id
LEFT JOIN ds_mysql_prod_empVolunteeringApplication p3 ON p3.empVolunteeringOpportunityId = p2.id
LEFT JOIN ds_mysql_prod_empVolunteeringParticipation p4 ON p4.empVolunteeringApplicationId = p3.id
LEFT JOIN ds_mysql_prod_orgpartner test1 on test1.id = p1.orgpartnerid
LEFT JOIN ds_mysql_prod_empopportunityorganizer test2 on test2.empopportunityid = p1.id
where UPPER(p1.opportunityType) = 'VOL' and p1.securityContextId = 1615 and p4.active = 1 and p1.active = 1 and p4.duration != 0 and p4.duration is not null)

select * from sub1