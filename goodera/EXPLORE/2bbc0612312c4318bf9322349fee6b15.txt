select p.fy_timerange,p2.name as van,p3.name as partner,p.name,p.bene_age,p.bene_gender as gender, count(*), 1 as unique_count,p4.name as patient,
case 
  		when count(patient) = 1
  			then 'Once'
		when count(patient) = 2
			  then 'Twice'
  		when (count(patient) > 2 and count(patient)< 6)
  			then '3-5'
  		when (count(patient)> 5 and count(patient)< 11)
  			then '6-10'
		when (count(patient)> 10 and count(patient)< 51)
  			then '11-50'
  		else 0
  	end as pcount

--case when 

from profile_83301 p

left join ds_mysql_prod_project p2 on p2.id=p.projectid 
left join ds_mysql_prod_project p3 on p3.id=p2.parent
left join profile_83300 p4 on p4._id = p.patient

where p.projectid like '%%'

group by p.fy_timerange,p2.name, p3.name, p.name,p.bene_age,p.bene_gender,p4.name