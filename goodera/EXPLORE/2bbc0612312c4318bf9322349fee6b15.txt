select p.fy_timerange,p2.name as van,p3.name as partner,p.name,p.bene_age,p.bene_gender as gender, count(*), 1 as unique_count,p.patient,
case 
  		when count(p.patient)=1
  			then 'Once'
  		when (count(p.patient)>=2 and count(patient)< 6)
  			then '2-6'
  		when (count(p.patient)>=6 and count(patient)<10)
  			then '6-10'
  		else 'Others'
  	end as pcount

--case when 

from profile_83301 p

left join ds_mysql_prod_project p2 on p2.id=p.projectid 
left join ds_mysql_prod_project p3 on p3.id=p2.parent


where p.projectid like '%%'

group by p.fy_timerange,p2.name, p3.name, p.name,p.bene_age,p.bene_gender,p.patinet