with sub1 as(select p1.name as projectid,p1.year_timerange as Timerange,p1.personal_vehicle ,p1.other_mileage,p1.bicycle_mileage,p1.walk_mileage,p1.metro_mileage,p1.motorbike_mileage,p1.bus_mileage,p1.train_mileage, (p1.personal_vehicle + p1.other_mileage+p1.bicycle_mileage+p1.walk_mileage+p1.metro_mileage+p1.motorbike_mileage+p1.bus_mileage+p1.train_mileage) as commute 
from profile_64637 p1)

select projectid,Timerange, sum(commute) as commute_distance from sub1
where commute is not null
group by projectid,Timerange