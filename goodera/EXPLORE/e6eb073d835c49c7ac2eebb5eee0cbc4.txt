with sub1 as(select p1.name as projectid,p1.fy_timerange as Timerange,
Sum(CASE 
             WHEN keyword = 'personal_vehicle' THEN datanumBase
             ELSE 0 
           END)  as personal_vehicle,
			 Sum(CASE 
             WHEN keyword = 'motorbike_mileage' THEN datanumBase
             ELSE 0 
           END)  as motorbike_mileage,
			 Sum(CASE 
             WHEN keyword = 'bus_mileage' THEN datanumBase
             ELSE 0 
           END)  as bus_mileage,
			 Sum(CASE 
             WHEN keyword = 'train_mileage' THEN datanumBase
             ELSE 0 
           END)  as train_mileage,
			 Sum(CASE 
             WHEN keyword = 'metro_mileage' THEN datanumBase
             ELSE 0 
           END)  as metro_mileage,
			 Sum(CASE 
             WHEN keyword = 'walk_mileage' THEN datanumBase
             ELSE 0 
           END)  as walk_mileage,
			 Sum(CASE 
             WHEN keyword = 'bicycle_mileage' THEN datanumBase
             ELSE 0 
           END)  as bicycle_mileage,
			 Sum(CASE 
             WHEN keyword = 'other_mileage' THEN datanumBase
             ELSE 0 
           END)  as other_mileage
			 
from sus_64637 p1
where p1.keyword in ('personal_vehicle', 'motorbike_mileage', 'bus_mileage', 'train_mileage', 'metro_mileage', 'walk_mileage', 'bicycle_mileage', 'other_mileage') and p1.datanumbase is not null
			),

sub2 as(select projectid,Timerange,sum(personal_vehicle,other_mileage,bicycle_mileage,walk_mileage,metro_mileage,motorbike_mileage,bus_mileage,train_mileage) as commute
from sub1
)

select projectid,Timerange,sum(commute) as commute_distance
from sub2
group by projectid,Timerange