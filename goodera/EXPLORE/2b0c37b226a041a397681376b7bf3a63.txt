select 
case 
	when p1.reg_date_yn = 28005
		then p1.date_y
	else p1.createddate
end as date
,1 as count
from profile_58474 p
left join profile_58473 p1
on p.patient = p1._id
where sug_test is not null