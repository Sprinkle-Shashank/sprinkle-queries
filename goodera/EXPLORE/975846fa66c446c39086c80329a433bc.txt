with t1 as (select p1._id, p1.projectId, p1.recognized_union, p1.workers_production_units, p1.male_female, p1.female_representation, p1.decision_making_attendance, p1.decision_making,p1.meetings_held,p1.members_present_meetings, p1.active_members_list, p1.peers_reachout, p1.retaliation, p1.alternative_tradeunion, p1.issues_addressed, p1.follow_up,p1.assessment_review, p1.members_duty_released, p1.training_type, p1.year, p2.country, p2.vendor, p2.cycle, p2.product_category, p2.consultant
from profile_62306 p1
left join profile_64362 p2
on p1.projectId= p2.projectId),


item as 
(
select 'recognized_union' as c
union all
select 'workers_production_units' as c
union all
select 'male_female' as c
union all
select 'female_representation' as c
union all
select 'decision_making_attendance' as c
union all
  select 'decision_making' as c
union all
  select 'meetings_held' as c
union all
  select 'members_present_meetings' as c
union all
  select 'active_members_list' as c
union all
  select 'peers_reachout' as c
union all
  select 'retaliation' as c
union all
  select 'alternative_tradeunion' as c
union all
  select 'issues_addressed' as c
union all
  select 'follow_up' as c
union all
  select 'asessment_review' as c
union all
  select 'members_duty_released' as c
 
),


t2 as 
(select projectId, training_type,country,vendor,consultant,cycle,product_category,year,Questions,Answers,id2,
 case c
 when 'recognized_union' then t1.recognized_union
 when 'workers_production_units' then t1.workers_production_units
 when 'male_female' then t1.male_female
 when 'female_representation' then t1.female_representation
 when 'decision_making_attendance' then t1. decision_making_attendance
 when 'decision_making' then t1.decision_making
 when 'meetings_held' then t1.meetings_held
 when 'members_present_meetings' then t1.members_present_meetings
 when 'active_members_list' then t1.active_members_list
 when 'peers_reachout' then t1.peers_reachout
 when 'retaliation' then t1.retaliation
 when 'alternative_tradeunion' then t1.alternative_tradeunion
 when 'issues_addressed' then t1.issues_addressed
 when 'follow_up' then t1.follow_up
 when 'assessment_review' then t1.assessment_review
 when 'members_duty_released' then t1.members_duty_released
 else null
 end as Answers, item.c as Questions
 from t1 cross join item ),
 --group by projectId, fy_timerange, school_name, project_name, imp_partner, bu, theme, location, session_type, item.c, no_sessions, no_hours, no_volunteers),
 
 t3 as( select projectId, training_type,country,vendor,consultant,cycle,product_category,year,Questions,Answers,id2
	   from t2)
	   
	   select * from t3