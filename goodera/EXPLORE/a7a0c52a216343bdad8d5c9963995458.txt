
with table1 as 
(
   select p.projectid , p._id , sourcing_yn , p2.pace_status , p4.name_factory , row_number() over (partition by p.projectid order by p._id desc) as row from profile_52713 p
  
  left join profile_54267 p2 on 
  p.projectid = p2.projectid
  
  left join profile_54646 p4 on 
  p.projectid = p4.projectid
  
  where sourcing_yn=57472 and p2.pace_status=845114  
 ),
 
 table11 as 
 (
   select p.projectid , p._id , p4.name_factory from profile_52713 p
   
  left join profile_54646 p4 on 
  p.projectid = p4.projectid
   
   where sourcing_yn=57473 and ( pace_status_2=845114 or p4.name_factory is null)
 ),
 
 
 table2 as 
 (
   select * from profile_54267 p
 ),
 
 
 table3 as 
 (
   select * from profile_52713 p
 ),
 
 table4 as 
 (
   select * from profile_54646 p
 )
  
 select p.projectid , name_factory from table11 as p 