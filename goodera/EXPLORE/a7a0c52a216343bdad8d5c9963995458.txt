with table1 as 
(
  select p.projectid , p.name , fac.name as factory, ven.name as vendor , cou.name as country from profile_61572 as p 
  
 left join ds_mysql_prod_project fac 
on p.projectId = fac.id

 left join ds_mysql_prod_project ven 
on fac.parent = ven.id

 left join ds_mysql_prod_project cou 
on ven.parent = cou.id
 ),
 
 table2 as 
 (
   select p.projectid , p._id , fac_cl_vpid , vendor_ngo_id , row_number() over 
(partition by projectid
 order by _id desc) as row from profile_52810 as p ), 
 
 table3 as 
 (
    select * from table2 where row=1 ),
	
table4 as 
( select p.projectid , p._id , pri.name as primary_category from profile_52810 as p
 
left join ds_mysql_prod_tagelement pri
on  p.primary_category = pri.id
 )
  
  select * from table1
  
  