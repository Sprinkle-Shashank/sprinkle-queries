
with table11 as 
(
   select p.projectid , p._id , sourcing_yn , p2.pace_status , p4.name_factory , row_number() over (partition by p.projectid order by p._id desc) as row from profile_52713 p
  
  left join profile_54267 p2 on 
  p.projectid = p2.projectid
  
  left join profile_54646 p4 on 
  p.projectid = p4.projectid
  
  where sourcing_yn=57472 and p2.pace_status=845114  
 ),
 
 table111 as 
 ( select p.projectid, name_factory from table11 as p where row=1 ),
   
 
 table12 as 
 (
   select p.projectid , p._id , p4.name_factory from profile_52713 p
   
  left join profile_54646 p4 on 
  p.projectid = p4.projectid
   
   where sourcing_yn=57473 and ( pace_status_2=845114 or p4.name_factory is null)
 ),
 
 table122 as 
 ( select p.projectid , name_factory from table12 as p ),
 
 
 table13 as 
 (
    select p.projectid , p._id , p4.name_factory from profile_52713 p
   
  left join profile_54646 p4 on 
  p.projectid = p4.projectid
   
  left join profile_4948 p5 on 
  p.projectid = p5.projectid
   
   where p5.pace_status=182398
  ),
  
 table133 as 
 ( select p.projectid , name_factory from table13 as p ),
  
  table144 as 
  (
  select p.projectid , name_factory from table111 as p
  union all
  select p.projectid , name_factory from table122 as p
  union all
  select p.projectid , name_factory from table133 as p
  ), 
  
  table155 as 
  (  select * from table144 ),
  
  table1 as 
  ( select p.projectid , fac_vpid , p2.cp_location_id , t1.name_factory from profile_54267 as p 
  
  left join profile_4948 p2 on 
  p.projectid = p2.projectid
  
  left join table155 t1 on 
  p.projectid = t1.projectid)
  
  
  select * from table155
  
  
  /*
 table2 as 
 (
   select * from profile_54267 p
 ),
 
 
 table3 as 
 (
   select * from profile_52713 p
 ),
 
 table4 as 
 (
   select * from profile_54646 p
 ),
 
 
 table5 as 
 (
   select * from profile_4948 as p
  )
  
 select * from table12 as p 
 */