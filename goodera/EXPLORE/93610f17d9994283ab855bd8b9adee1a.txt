with x as (
   SELECT grantproposalid,CAST(summary_18 as super) as dir
 from profile_29301)

select DISTINCT(value.comp) as comp, SUM(value.mandated) as mandated, SUM(value.planned_old) as planned_old,SUM(value.planned_new) as planned_new,SUM(value.till_date) as till_date,SUM(value.planned_residual) as planned_residual,SUM(value.next) as next 
from x as t, unpivot t.dir as value at dir
group by 1;