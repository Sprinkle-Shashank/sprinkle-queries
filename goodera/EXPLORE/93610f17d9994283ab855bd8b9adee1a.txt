with x as (
   SELECT grantproposalid,CAST(summary_18 as super) as dir
 from profile_29301)

select DISTINCT(value.comp) as comp, COUNT(value.mandated), count(value.planned_old),count(value.planned_new),count(value.till_date),count(value.planned_residual),count(value.next) 
from x as t, unpivot t.dir as value at dir
group by 1;