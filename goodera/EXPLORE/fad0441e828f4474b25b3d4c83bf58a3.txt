with x as (select xprojectid,finperiod,fy_timerange,keyword,name,datatablebase From sus_21557 as p where keyword ='heads_and_above_staff'),

y as (select xprojectid,finperiod,fy_timerange,keyword,name,datatablebase From sus_21557 as p where keyword = 'executives_number'),

z as (select xprojectid,finperiod,fy_timerange,keyword,name,datatablebase From sus_21557 as p where keyword = 'asst_managers_and_above'),

a as (select xprojectid,finperiod,fy_timerange,keyword,name,datatablebase From sus_21557 as p where keyword = 'non_executives_number'),

b as (select xprojectid,keyword,fy_timerange,finperiod,cast(coun.male as varchar),case when is_array (coun.female) = false or get_array_length(coun.female) = 0 then array(coun.female) else coun.female end as h From x as p, unpivot p.datatablebase as coun at abc),

c as (select xprojectid,keyword,fy_timerange,finperiod,cast(coun.male as varchar),case when is_array (coun.female) = false or get_array_length(coun.female) = 0 then array(coun.female) else coun.female end as ex From y as p, unpivot p.datatablebase as coun at abc),

d as (select xprojectid,keyword,fy_timerange,finperiod,cast(coun.male as varchar),case when is_array (coun.female) = false or get_array_length(coun.female) = 0 then array(coun.female) else coun.female end as ass From z as p, unpivot p.datatablebase as coun at abc),

e as (select xprojectid,keyword,fy_timerange,finperiod,cast(coun.male as varchar),case when is_array (coun.female) = false or get_array_length(coun.female) = 0 then array(coun.female) else coun.female end as non From a as p, unpivot p.datatablebase as coun at abc)

select * from e

/*left join sus_46830 t2
on t.xprojectid = t2.xprojectid
--left join tagElement_6664 t3 on t3.id = t2.dataselect 
left join project_6664 t4 on t4.id = t.xprojectid
left join project_6664 t5 on t5.id = t4.parent
left join tagElement_6664 t6 on t6.id = t.t
where t2.keyword = 'company_category'*/