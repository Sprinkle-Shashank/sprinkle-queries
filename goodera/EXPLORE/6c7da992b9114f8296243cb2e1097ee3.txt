 with temp as (
   select 'male_indirect_beneficiaries' as col
   union all
   select 'neither_gender_indirect_beneficiaries' as col
   union all
   select 'male_direct_beneficiaries' as col
   union all
   select 'female_indirect_beneficiaries' as col
   union all
   select 'neither_gender_direct_beneficiaries' as col
   union all
   select 'no_gender_disclosure_indirect_beneficiaries' as col
   union all
   select 'no_gender_disclosure_direct_beneficiaries' as col 
   union all
   select 'female_direct_beneficiaries' as col
  )

Select sq._id, sq.fy_timerange, sq.program_name, sq.male_indirect_beneficiaries as Male_indirect, sq.neither_gender_indirect_beneficiaries as Other_indirect, sq.male_direct_beneficiaries as Male_direct, sq.female_indirect_beneficiaries as Female_indirect, sq.neither_gender_direct_beneficiaries as Other_direct, sq.no_gender_disclosure_indirect_beneficiaries as Gender_not_disclosed_indirect, sq.no_gender_disclosure_direct_beneficiaries as Gender_not_disclosed_direct, sq.female_direct_beneficiaries as Female_direct, sq.projectId, pd.end_date, t2.name as Partner,t3.name as Country,t4.name as Region, t5.name as Partner_name,
case 
  when (extract(month from pd.end_date) <=2) then ('FY' || (extract(year from pd.end_date)-2000))
  when (extract(month from pd.end_date) >2) then ('FY'|| (extract(year from pd.end_date)+1-2000))
end as FY,

(sq.Male_direct_beneficiaries  + sq.Male_indirect_beneficiaries + sq.Female_direct_beneficiaries + sq.Female_indirect_beneficiaries + sq.neither_gender_direct_beneficiaries + sq.neither_gender_indirect_beneficiaries + sq.no_gender_disclosure_direct_beneficiaries + sq.no_gender_disclosure_indirect_beneficiaries
) as Total_benefeiciaries

FROM dell_profile_67395 sq
left join dell_profile_62886 pd 
on sq.program_name=pd._id

left join ds_mysql_prod_project as t 
  on sq.projectId = t.id
  left join ds_mysql_prod_project as t2
  on t.parent=t2.id
  left join ds_mysql_prod_project as t3
  on t2.parent=t3.id 
  left join ds_mysql_prod_project as t4
  on t3.Parent=t4.id 
    left join ds_mysql_prod_project as t5
  on t.Parent=t5.id
   
group by sq._id, sq.fy_timerange, sq.Region, Partner_name,pd.end_date, sq.program_name