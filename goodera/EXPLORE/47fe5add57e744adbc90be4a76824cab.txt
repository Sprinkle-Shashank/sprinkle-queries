with table1 as( 
  select p._id, p.projectid, p.year_timerange, cast(d1 as varchar) as d1_update  
from profile_76755 as p, p.impact_wcp_arr as d1
),

table2 as(
  select p1.absenteeism_rate  , p1.labor_disputes , p1.person_days_lost , p1.bc_meetings,

((nvl(cast(p1.last_day_workers as FLOAT),0) + nvl(cast(p1.day_1_workers as FLOAT),0)) / 2) as d2,

nvl(((nvl(p1.workers_exited, 0)/ nullif(d2,0))  * 100), 0) as inside, 

extract(year from cast(p.year_timerange.start as DATE)) as start_year,
extract(month from cast(p.year_timerange.start as DATE)) as start_month,

case start_month
	when 1 then 'January'
	when 2 then 'February'
	when 3 then 'March'
	when 4 then 'April'
	when 5 then 'May'
	when 6 then 'June'
	when 7 then 'July'
	when 8 then 'August'
	when 9 then 'September'
	when 10 then 'October'
	when 11 then 'November'
	else 'December'
end as month,

case
	when month in ('February','March','April') then 'Q1'
    when month in ('May','June','July') then 'Q2'
	when month in ('August','September','October') then 'Q3'
	when month in ('November','December','January') then 'Q4'
end as quarter,

(quarter || ', ' || month) as quarter_new

from table1 p

left join profile_76928 p1 on p1._id = p.d1_update
where start_year is not null)

select quarter, quarter_new, (cast(quarter as VARCHAR) || ', ' || start_year) as t from table2