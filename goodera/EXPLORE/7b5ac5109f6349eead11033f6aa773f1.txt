

with temp as (
  select 'state_name' as C
  Union all 
  select 'village_names' as C
  Union all 
  select 'num_kits' as C
  Union all 
  select 'num_family_reach' as C
  Union all 
  select 'num_kits_broke' as C
), 

select  projectid,fy_timerange,
SUM(Case C
	When 'state_name' then profile_79924.locations
	When 'village_names' then profile_79924.villages
	When 'num_kits' then profile_79924.num_kits
	When 'num_family_reach' then profile_79924.num_family_reach
	When 'num_kits_broke' then profile_79924.num_kits_broke
	Else Null
END) as values,
temp.C as dimensions
from profile_79924 

left join ds_mysql_prod_tagelement vil on
p.village = vil.id 

left join ds_mysql_prod_tagelement state on
vil.parent = state.id 

cross join temp
group by fy_timerange,projectid,temp.C

/*
  select p.*, state.name as state_name , vil.name as village_names , village_names , num_family_reach , num_kits , num_kits_broke from profile_79924 p

left join ds_mysql_prod_tagelement vil on
p.village = vil.id 

left join ds_mysql_prod_tagelement state on
vil.parent = state.id 
*/

  

