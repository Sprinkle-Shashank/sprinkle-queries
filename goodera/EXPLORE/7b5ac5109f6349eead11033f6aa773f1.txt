

with temp as (
  select 'state_name' as C
  Union all 
  select 'village_names' as C
  Union all 
  select 'num_kits' as C
  Union all 
  select 'num_family_reach' as C
  Union all 
  select 'num_kits_broke' as C
) 

select p.projectid,fy_timerange,
SUM(Case C
	When 'state_name' then state.name
	When 'village_names' then vil.name 
	When 'num_kits' then cast(p.num_kits as varchar)
	When 'num_family_reach' then cast(p.num_family_reach as varchar)
	When 'num_kits_broke' then cast(p.num_kits_broke as varchar)
	Else Null
END) as values,
temp.C as dimensions
from profile_79924 p

left join ds_mysql_prod_tagelement vil on
p.village = vil.id 

left join ds_mysql_prod_tagelement state on
vil.parent = state.id 

cross join temp
group by fy_timerange,p.projectid, temp.C

/*

  select p.*, state.name as state_name , vil.name as village_names , village_names , num_family_reach , num_kits , num_kits_broke from profile_79924 p

left join ds_mysql_prod_tagelement vil on
p.village = vil.id 

left join ds_mysql_prod_tagelement state on
vil.parent = state.id 

*/