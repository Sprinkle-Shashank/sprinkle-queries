select p.projectid , p._id ,p.name, p.vendor_vpid, p.facility_vpid, p.factory_name, p.participant_type, p.num_participants, p.num_participants_2, p.male_trained, p.female_trained, p.male_certified,
cou.name as country,
ven.name as vendor,
fac.name as factory,
extract (year from createddate) as year,
(p.male_trained+p.female_trained) as total_trained, 
(p.male_certified+p.female_certified) as total_certified ,
CASE when cou.name is null then fac.name else cou.name end as temp1
from profile_61483 p

left join ds_mysql_prod_project fac
on  p.projectid = fac.id
left join ds_mysql_prod_project ven
on fac.parent = ven.id
left join ds_mysql_prod_project cou
on ven.parent = cou.id
left join profile_61693
on p._id = profile_61693._id
 
 group by p.projectId, p.name, p.vendor_vpid, p.facility_vpid, p.factory_name, p.participant_type, p.num_participants, p.num_participants_2, p.male_trained, p.female_trained, p.male_certified, p.female_certified, cou.name, total_trained, total_certified,year,p._id,ven.name,fac.name
 