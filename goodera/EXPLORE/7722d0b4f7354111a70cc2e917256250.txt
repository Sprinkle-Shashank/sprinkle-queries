select fac.projectid , p._id ,  name, vandor_vpid,
facility_vpid, 
factory_name,
participant_type,
ven.name as vendor,
num_participant,
num_participant2,
cou.name as country2,
case when country2!='Null' then projectId end as country,
male_trained,female_trained,
(p.male_trained+p.female_trained) as total_trained, 
male_certified,female_certified,
(p.male_certified+p.female_certified) as total_certified
from profile_61483 p

left join ds_mysql_prod_project fac
on  p.projectid = fac.id
left join ds_mysql_prod_project ven
on fac.parent = ven.id
left join ds_mysql_prod_project cou
on ven.parent = cou.id
 
 group by ven.name,cou.name,country,total_trained, total_certified 