select p.projectid , p._id ,
cou.name as country,
ven.name as vendor,
fac.name as factory,
/*case when country2 is Null then projectId else country2 end as country,*/
(p.male_trained+p.female_trained) as total_trained, 
(p.male_certified+p.female_certified) as total_certified 
/*case when cou.name ='' then fac.name else cou.name end as temp*/
CASE when cou.name = '' then fac.name else cou.name end as temp1
from profile_61483 p

left join ds_mysql_prod_project fac
on  p.projectid = fac.id
left join ds_mysql_prod_project ven
on fac.parent = ven.id
left join ds_mysql_prod_project cou
on ven.parent = cou.id
 
 group by p.projectid,p._id, fac.name ,ven.name,cou.name,
 --country,
 total_trained, total_certified  