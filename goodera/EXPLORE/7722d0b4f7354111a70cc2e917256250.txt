select p.projectid , p._id ,
cou.name as country2,
ven.name as vendor,
case when country2 is Null then projectId else country2 end as country,
(p.male_trained+p.female_trained) as total_trained, 
(p.male_certified+p.female_certified) as total_certified  
from profile_61483 p

left join ds_mysql_prod_project fac
on  p.projectid = fac.id
left join ds_mysql_prod_project ven
on fac.parent = ven.id
left join ds_mysql_prod_project cou
on ven.parent = cou.id
 
 group by p.projectid,p._id, ven.name,cou.name,country,total_trained, total_certified  