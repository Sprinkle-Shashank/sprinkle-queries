with table1 as (select projectid,name, comfort , function , 
				mr_wr , quality_relationship , resolution , 
				satisfaction , suggestions , usefulness 
				from profile_18224 p),

table2 as (
select fac_vpid,child_vendor_vpid as vpid,goodera_facility_name_text as factory, ROW_NUMBER () OVER
(
 PARTITION BY goodera_facility_name_text
 ORDER BY _id asc 
) as row  from profile_68161 ),

table3 as (select projectid,date_enrollment,date_completion,ROW_NUMBER () OVER
(
 PARTITION BY projectid
 ORDER BY _id asc 
) as row1 from profile_16619),
table4 as (select * from table2
		  where row = 1),
table5 as (select * from table3
		  where row1 = 1)		  

select t1.projectid,t1.name, comfort , function , 
				mr_wr , quality_relationship , resolution , 
				satisfaction , suggestions , usefulness ,t4.fac_vpid,
case 
     when wcp.date_enrollment is not null and wcp.date_completion is null then 'Ongoing'
	 when wcp.date_enrollment is not null and wcp.date_completion is not null then 'Completed'
	 else null end as status, t4.vpid
from table1 t1

/*left join profile_4722 faci on
t1.projectid = faci.projectid*/

left join table5 wcp on
t1.projectid = wcp.projectid

left join project_1137 pro
on t1.projectid = pro.id

left join table4 t4 on
pro.name = t4.factory
