select * from(select Project_Manager,ProjectCode,focusarea,fy_timerange,
Asset_Category,Asset_sub_Category,count(Asset_sub_category) as Number  from(select m.name as Project_Manager,split_part(ProjectCode,'/',1) as ProjectCode,focusarea,fy_timerange,Asset_Category,Asset_sub_Category  from
(select split_part(ProjectCode,'.',1) as ProjectCode, focusarea,fy_timerange,Asset_Category,Asset_sub_Category  from 
(select  split_part(prod.name,'|',1) as ProjectCode, t.name as fy_timerange, p.focus_area as focusarea,p.asset_cat as Asset_Category,s.name as Asset_sub_Category
 from profile_59426 p 
left join ds_mysql_prod_project prod on
prod.id=p.projectid
left join ds_mysql_prod_tagelement t on
p.fy=t.id
left join ds_mysql_prod_tagelement s on
p.cat=s.id))
left join profile_27396 n on
ProjectCode=n.name
left join ds_mysql_prod_tagelement m on
n.project_manager=m.id)
group by Project_Manager,ProjectCode ,focusarea ,fy_timerange,Asset_Category,Asset_sub_Category) where Project_Manager="Shyamlika Krishna"

