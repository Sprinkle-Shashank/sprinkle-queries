with Base1 as(select split_part(prod.name,'|',1) as ProjectCode ,fy,select_quarter,new_villages as New_added,case when _id is not null then 'New Beneficiaries Covered' end as type from profile_60787
left join ds_mysql_prod_project prod on
prod.id=projectid
union all
select split_part(prod.name,'|',1) as ProjectCode ,fy,select_quarter,new_schools,case when _id is not null then 'New Beneficiaries Covered' end as type  from profile_60787
left join ds_mysql_prod_project prod on
prod.id=projectid
union all
select split_part(prod.name,'|',1) as ProjectCode ,fy,select_quarter,new_students,case when _id is not null then 'New Beneficiaries Covered' end as type  from profile_60787
left join ds_mysql_prod_project prod on
prod.id=projectid
union all
select split_part(prod.name,'|',1) as ProjectCode ,fy,select_quarter,new_youth,case when _id is not null then 'New Beneficiaries Covered' end as type  from profile_60787
left join ds_mysql_prod_project prod on
prod.id=projectid
union all
select split_part(prod.name,'|',1) as ProjectCode ,fy,select_quarter,new_teachers,case when _id is not null then 'New Beneficiaries Covered' end as type  from profile_60787
left join ds_mysql_prod_project prod on
prod.id=projectid
union all
select split_part(prod.name,'|',1) as ProjectCode ,fy,select_quarter,new_fellows,case when _id is not null then 'New Beneficiaries Covered' end as type  from profile_60787
left join ds_mysql_prod_project prod on
prod.id=projectid
union all
select split_part(prod.name,'|',1) as ProjectCode ,fy,select_quarter,new_farmers,case when _id is not null then 'New Beneficiaries Covered' end as type  from profile_60787
left join ds_mysql_prod_project prod on
prod.id=projectid
union all
select split_part(prod.name,'|',1) as ProjectCode ,fy,select_quarter,new_women,case when _id is not null then 'New Beneficiaries Covered' end as type  from profile_60787
left join ds_mysql_prod_project prod on
prod.id=projectid
union all
select split_part(prod.name,'|',1) as ProjectCode ,fy,select_quarter,new_other,case when _id is not null then 'New Beneficiaries Covered' end as type from profile_60787
left join ds_mysql_prod_project prod on
prod.id=projectid
union all 
select split_part(prod.name,'|',1) as ProjectCode ,fy,select_quarter,total_villages,case when _id is not null then 'Total Beneficiaries Covered' end as type from profile_60787
left join ds_mysql_prod_project prod on
prod.id=projectid
union all
select split_part(prod.name,'|',1) as ProjectCode ,fy,select_quarter,total_schools,case when _id is not null then 'Total Beneficiaries Covered' end as type  from profile_60787
left join ds_mysql_prod_project prod on
prod.id=projectid
union all
select split_part(prod.name,'|',1) as ProjectCode ,fy,select_quarter,total_students,case when _id is not null then 'Total Beneficiaries Covered' end as type  from profile_60787
left join ds_mysql_prod_project prod on
prod.id=projectid
union all
select split_part(prod.name,'|',1) as ProjectCode ,fy,select_quarter,total_youth,case when _id is not null then 'Total Beneficiaries Covered' end as type  from profile_60787
left join ds_mysql_prod_project prod on
prod.id=projectid
union all
select split_part(prod.name,'|',1) as ProjectCode ,fy,select_quarter,total_teachers,case when _id is not null then 'Total Beneficiaries Covered' end as type  from profile_60787
left join ds_mysql_prod_project prod on
prod.id=projectid
union all
select split_part(prod.name,'|',1) as ProjectCode ,fy,select_quarter,total_fellows,case when _id is not null then 'Total Beneficiaries Covered' end as type  from profile_60787
left join ds_mysql_prod_project prod on
prod.id=projectid
union all
select split_part(prod.name,'|',1) as ProjectCode ,fy,select_quarter,total_farmers,case when _id is not null then 'Total Beneficiaries Covered' end as type  from profile_60787
left join ds_mysql_prod_project prod on
prod.id=projectid
union all
select split_part(prod.name,'|',1) as ProjectCode ,fy,select_quarter,total_women,case when _id is not null then 'Total Beneficiaries Covered' end as type  from profile_60787
left join ds_mysql_prod_project prod on
prod.id=projectid
union all
select split_part(prod.name,'|',1) as ProjectCode ,fy,select_quarter,total_other,case when _id is not null then 'Total Beneficiaries Covered' end as type from profile_60787
left join ds_mysql_prod_project prod on
prod.id=projectid),
Base2 as(
select split_part(prod.name,'|',1) as ProjectCode ,fy,case when _id is not null then 'Year' end as type1,new_villages as new_added2,case when _id is not null then 'New Beneficiaries Covered' end as type from profile_60787
left join ds_mysql_prod_project prod on
prod.id=projectid
union all
select split_part(prod.name,'|',1) as ProjectCode ,fy,case when _id is not null then 'Year' end as type1,new_schools,case when _id is not null then 'New Beneficiaries Covered' end as type  from profile_60787
left join ds_mysql_prod_project prod on
prod.id=projectid
union all
select split_part(prod.name,'|',1) as ProjectCode ,fy,case when _id is not null then 'Year' end as type1,new_students,case when _id is not null then 'New Beneficiaries Covered' end as type  from profile_60787
left join ds_mysql_prod_project prod on
prod.id=projectid
union all
select split_part(prod.name,'|',1) as ProjectCode ,fy,case when _id is not null then 'Year' end as type1,new_youth,case when _id is not null then 'New Beneficiaries Covered' end as type  from profile_60787
left join ds_mysql_prod_project prod on
prod.id=projectid
union all
select split_part(prod.name,'|',1) as ProjectCode ,fy,case when _id is not null then 'Year' end as type1,new_teachers,case when _id is not null then 'New Beneficiaries Covered' end as type  from profile_60787
left join ds_mysql_prod_project prod on
prod.id=projectid
union all
select split_part(prod.name,'|',1) as ProjectCode ,fy,case when _id is not null then 'Year' end as type1,new_fellows,case when _id is not null then 'New Beneficiaries Covered' end as type  from profile_60787
left join ds_mysql_prod_project prod on
prod.id=projectid
union all
select split_part(prod.name,'|',1) as ProjectCode ,fy,case when _id is not null then 'Year' end as type1,new_farmers,case when _id is not null then 'New Beneficiaries Covered' end as type  from profile_60787
left join ds_mysql_prod_project prod on
prod.id=projectid
union all
select split_part(prod.name,'|',1) as ProjectCode ,fy,case when _id is not null then 'Year' end as type1,new_women,case when _id is not null then 'New Beneficiaries Covered' end as type  from profile_60787
left join ds_mysql_prod_project prod on
prod.id=projectid
union all
select split_part(prod.name,'|',1) as ProjectCode ,fy,case when _id is not null then 'Year' end as type1,new_other,case when _id is not null then 'New Beneficiaries Covered' end as type from profile_60787
left join ds_mysql_prod_project prod on
prod.id=projectid),Base3 as(select ProjectCode,fy,New_added,type,q.name from Base1 left join  ds_mysql_prod_tagelement q on select_quarter=q.id),Base4 as(

select ProjectCode,fy,name,New_added,type from Base3
union all
select ProjectCode,fy,type1,new_added2,type from Base2)
select ProjectCode,fy,name,sum(new_added),type from Base4 group by fy, name,type,ProjectCode
