with s as (Select fy_timerange ,t.name as kpi_name ,gri_topic,  sasb_topic ,  sdg_name , sdg_logo ,description ,company_policy from profile_80391
left join ds_mysql_prod_tagelement t
on kpi_name=t.id

),
s2 as(
Select fy_timerange ,kpi_name ,gri_topic,sasb_topic ,sdg_name ,cast(sdg_log as INT) as sdg_log ,description ,company_policy
from s as p,p.sdg_logo sdg_log),
s3 as (
Select fy_timerange ,kpi_name ,cast(gri_top as INT) as gri_top,sasb_topic ,sdg_name ,sdg_log as sdg_logo ,description ,company_policy
from s2  as q,q.gri_topic gri_top
),
s4 as (
Select fy_timerange ,kpi_name , gri_top as gri_topic,cast(sasb_top as INT) as sasb_top ,sdg_name ,sdg_logo ,description ,company_policy
from s3 as r ,r.sasb_topic as sasb_top
),
s5 as (
Select fy_timerange ,kpi_name ,  gri_topic, sasb_top as sasb_topic ,cast(sdg_nam as INT) as sdg_nam ,sdg_logo ,description ,company_policy
from s4 as t,t.sdg_name as sdg_nam
)
Select fy_timerange ,kpi_name ,  gri_topic, sasb_topic , sdg_nam as sdg_name,sdg_logo ,description ,company_policy
from s5