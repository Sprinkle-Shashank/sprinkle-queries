with sub1 as(
select projectId, fy_timerange, p_d, p_d_attendance, academics, academics_attendance, lifeskills, lifeskills_attendance, (p_d+academics+lifeskills) as total_sessions from profile_52389),
select projectId, fy_timerange, p_d, p_d_attendance, academics, academics_attendance, lifeskills, lifeskills_attendance, total_sessions, count(*) from sub1 group by projectId, fy_timerange, p_d, p_d_attendance, academics, academics_attendance, lifeskills, lifeskills_attendance, total_sessions