

Select projectid , fy_timerange ,financial_year,  t1.name as loc_1 , t2.name as loc_2 , t3.name as loc_3 ,


CASE WHEN loc_3 is NOT NULL
then loc_3
else loc_2
END AS state ,



LEFT JOIN ds_mysql_prod_tagelement t1 on
  p.location = t1.id 
 LEFT JOIN ds_mysql_prod_tagelement t2 on
  t1.parent = t2.id 
  
  LEFT JOIN ds_mysql_prod_tagelement t3 on
  t2.parent = t3.id 