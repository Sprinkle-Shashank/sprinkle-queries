with sub1 as(
  select p2.name as projectid, p1.desc, p1.display_pic, p1.proj_term, p1.location, p1.name_partner, p1.manager, p1.program_name, t1.name as country, t2.name as product_brand, t3.name as focus_area, p1.sdg_picture
from profile_63775 p1
left join ds_mysql_prod_project p2 on p2.id = p1.projectid
left join ds_mysql_prod_tagelement t1 on t1.id = p1.country_new
left join ds_mysql_prod_tagelement t2 on t2.id = p1.product_brand
left join ds_mysql_prod_tagelement t3 on t3.id = p1.focus_area),

sub2 as(
  select s1.*, cast(sdgs as varchar) from sub1 s1, s1.sdg_picture sdgs)
  
select s2.projectid, s2.program_name, s2.country, s2.product_brand, s2.focus_area, s2.desc, s2.display_pic, s2.proj_term, s2.location, s2.name_partner, s2.manager, listagg(sdgs,', ') as sdg_icons
from sub2 s2
group by s2.projectid, s2.program_name, s2.country, s2.product_brand, s2.focus_area, s2.desc, s2.display_pic, s2.proj_term, s2.location, s2.name_partner, s2.manager