select a.fy_timerange,p1.name as projectid,p2.name as donor, a.bene_name, t1.name as gender, a.id_number, b.comm_name as community, a.school_name, t2.name as ration_kits_received, a.ration_kit_num_of_times, a.dependencies, count(*) as count,
case
	when (p1.name) like '%School Transformation' then 'School Transformation'
	when (p1.name) like '%Random act of kindness' then 'Random act of kindness'
	when (p1.name) like '%Health & Nutrition' then 'Health & Nutrition'
	when (p1.name) like '%Unstoppable Vaccination Drive' then 'Unstoppable Vaccination Drive'
	when (p1.name) like '%Remote Learning' then 'Remote Learning'
	when (p1.name) like '%Educational Scholarships' then 'Educational Scholarships'
	else NULL
	end as project_type

from profile_80538 a

left join ds_mysql_prod_project p1 on p1.id = a.projectid
left join ds_mysql_prod_project p2 on p2.id = p1.parent
left join ds_mysql_prod_tagelement t1 on t1.id = a.bene_gender
left join ds_mysql_prod_tagelement t2 on t2.id = a.ration_kit_yn
left join profile_80583 b on b._id = a.bene_community
where a.projectid like '%%'
and ration_kits_received = 'Yes',

alter table profile_80538
add project_type varchar(255)
group by a.fy_timerange,p1.name ,p2.name , a.bene_name, t1.name, a.id_number, b.comm_name, a.school_name, t2.name, a.ration_kit_num_of_times,a.dependencies