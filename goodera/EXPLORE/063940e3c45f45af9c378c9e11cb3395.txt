
select distinct t2.name as projectid, timerange.name as time_timerange, 
'Scope 1' as scope ,'Fuels' as type,
case 
when keyword='generator_consump' then datanumbase*0.00259411
end as Multiplicationfactor_Generator , 
case 
when keyword='fuel_refill' then datanumbase*0.00220904 
end as Multiplicationfactor_Refill, 
sum(datanumbase) as TotalConsumption,
/*(case Multiplicationfactor_Generator when null then 0.00 else Multiplicationfactor_Generator end) as addend1,

(case  Multiplicationfactor_Refill when null then 0.00 else Multiplicationfactor_Refill end) as addend2,*/
Multiplicationfactor_Generator+Multiplicationfactor_Refill/*(addend1+addend2)*/ as Emissions

from  sus_9539 

left join ds_mysql_prod_project t1
on t1.id=sus_9539.xprojectid
left join ds_mysql_prod_project t2
on t2.id=t1.parent/*projectid*/

left join ds_mysql_prod_tagelement quarter
on quarter.id=sus_9539.financialPeriod
left join ds_mysql_prod_tagelement half
on half.id=quarter.parent
left join ds_mysql_prod_tagelement fy
on fy.id=half.parent
left join ds_mysql_prod_tagelement timerange
on timerange.id=fy.parent/*time_timerange*/
where KEYWORD IN ('generator_consump','fuel_refill') 
group by t2.name,timerange.name,scope,type,Multiplicationfactor_Generator,
Multiplicationfactor_Refill,emissions
--addend1,addend2





/*select * from sus_9539*/
