Select p.name as projectid,p1.name as pmilestone,a.fy_timerange,t1.name as status, a.comm, t2.name as month, a.date, a.actual_start_date, a.actual_end_date,
p1.milestone as milestone,p1.start, p1.end, p1.name,
case
--when t1.name = 'Completed' then 'Completed'
when (t1.name = 'In Progress' and a.date > p1.end) OR (t1.name = 'Yet to Start' and a.date > p1.start) then 'Delayed'
--when t1.name = 'Yet to Start' and a.date <= p1.start then 'Yet to Start'
else NULL

end as new_status
--, max(date) 
from profile_58278 a

left join ds_mysql_prod_project p on p.id = a.projectid
left join profile_58277 p1 on p1._id= a.milestone


left join ds_mysql_prod_tagelement t1 on t1.id=a.status
left join ds_mysql_prod_tagelement t2 on t2.id=a.month
--group by p.name, p1.name,a.fy_timerange,a.milestone