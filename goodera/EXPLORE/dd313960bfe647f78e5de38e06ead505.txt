select  projectid, fac.name as factory name, prod_method , p_met.name as prod_method , avg(efficiency) as efficiency from profile_4227 as pr_27

left join ds_mysql_prod_tagelement p_met
on pr_27.prod_method = p_met.id

left join ds_mysql_prod_project fac 
on pr_27.projectId = fac.id

where p_met.name= 'Increases in output'

group by factory_yn , pr_27.prod_method , p_met.name , efficiency

/*
 left join ds_mysql_prod_project fac 
on p.projectId = fac.id

 left join ds_mysql_prod_project ven 
on fac.parent = ven.id
*/