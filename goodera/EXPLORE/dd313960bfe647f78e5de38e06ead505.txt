

select distinct fac.name as factory_name ,  nvl2(SUBSTRING(factory_name, 1, POSITION('Factory' in factory_name)), SUBSTRING(factory_name, 1, POSITION('P' in factory_name)), factory_name) as factory_new_name , pr_27.projectid  , p_met.name as prod_method from profile_4227 as pr_27

left join ds_mysql_prod_tagelement p_met
on pr_27.prod_method = p_met.id

left join ds_mysql_prod_project fac 
on pr_27.projectId = fac.id

where p_met.name= 'Increases in output'

/*

 left join ds_mysql_prod_project fac 
on p.projectId = fac.id

 left join ds_mysql_prod_project ven 
on fac.parent = ven.id
*/