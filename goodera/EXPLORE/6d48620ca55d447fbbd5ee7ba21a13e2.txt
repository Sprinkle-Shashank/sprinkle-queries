select p.projectId,p.facility_name,p.strategic_yn,p.year_timerange,p.country,director_region,p.female_workers, p.male_workers, p.female_supervisors, p.male_supervisors,ven.name as Vendor,
female_workers*100 AS f,
(female_workers+male_workers) AS t,
CAST (f AS FLOAT) as fw,
CAST (t as FLOAT) as tw,


fw/tw AS worker,

female_supervisors*100 AS f1,
(male_supervisors+female_supervisors) AS t1,
CAST (f1 AS FLOAT) as fs,
CAST (t1 as FLOAT) as ts,
fs/ts AS supervisor,
case 
	when 1=1
	then 1
	else 0
	end
	as count,

CASE WHEN (supervisor >= worker) THEN 'YES'
ELSE
'NO'
END as result
from profile_76755 p
left join ds_mysql_prod_project fac
on p.projectId = fac.id
left join ds_mysql_prod_project ven
on fac.parent = ven.id
 
WHERE p.strategic_yn ='Yes' 
group by p.projectId, p.facility_name, p.year_timerange, p.country, director_region,p.strategic_yn,  result, ven.name,p.female_workers, p.male_workers, p.female_supervisors, p.male_supervisors

