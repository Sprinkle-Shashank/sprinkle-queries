

select p.projectid , p._id , beneficiary_name ,count(beneficiary_name) as d , gen.name as gender_updated, case when age<10 then 'less than 10' when age>10 and age<20 then 'btween' when age>20 then 'above 20' end as age_bucket from profile_66034 as p

left join ds_mysql_prod_tagelement gen
on p.gender = gen.id

group by p.projectid,p._id , beneficiary_name , gen.name , p.age

/*
1 query which can be used in the folowing 
a. card showing total beneficiaries 
b. Pie chart which shows gender breakup
c. bar chart that shows beneficiaries by age buckets (less than 10, 10 to 20 and above 20)
*/
