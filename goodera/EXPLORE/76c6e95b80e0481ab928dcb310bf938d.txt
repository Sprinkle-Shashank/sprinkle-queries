select p2.name as projectId, p3.name as partner,p1.end_date, p1.name, p1.clinic_type, p1.fy_timerange, p1.plant, count(*)

case 
	when end_date is null then 'active' 
	else 'inactive'
end as clinic_status

from profile_73658 p1
left join ds_mysql_prod_project p2 on p2.id = p1.projectid
left join ds_mysql_prod_tagelement t1 on t1.id=p1.location
left join ds_mysql_prod_tagelement t2 on t2.id = t1.parent
left join ds_mysql_prod_tagelement t3 on t3.id = t2.parent
left join ds_mysql_prod_project p3 on p3.id= p2.parent

group by s1.name, s1.clinic_type, s1.fy_timerange, s1.plant, s1.state, s1.partner, s1.clinic_status, 
