select tag1.name as projectId, p1.select_student, p1.fy_timerange, tag2.name as select_course, avg(p1.overall_percent) as final, p2.name
from profile_64051 p1
left join ds_mysql_prod_project tag1
on p1.projectId = tag1.id
left join ds_mysql_prod_tagelement tag2
on p1.select_course = tag2.id
left join profile_64048 p2
on p1.select_student = p2._id

group by tag1.name, p1.select_student, p1.fy_timerange, tag2.name, p2.name