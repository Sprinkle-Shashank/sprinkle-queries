select projectid,name,fy_timerange,keyword,datanum,datanumbase,
lag(datanum,1) over (order by name, fy_timerange) as prev_qty,
(prev_qty-datanum)*100.0/prev_qty as per 

from sus_80478

where keyword = 'total_energy_auto' 

order by fy_timerange asc