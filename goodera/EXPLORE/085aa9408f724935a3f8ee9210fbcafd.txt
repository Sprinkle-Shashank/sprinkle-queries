with sub1  as(
  select b.*,unwind_state
  from profile_55495 b , b.state as unwind_state
  )





Select a.fy_timerange,p1.name as implementation_partner,p.name as projectd, count(p1.name),
t.name as state


from sub1 a 

left join ds_mysql_prod_project p on p.id = a.projectid
left join ds_mysql_prod_project p1 on p1.id = p.parent
left join ds_mysql_prod_tagelement t on t.id=a.state




group by a.fy_timerange, p.name,a.name, p1.name,t.name
