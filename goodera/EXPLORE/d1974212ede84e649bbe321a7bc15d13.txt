
with table1 as
( select p.projectid , p._id , row_number() over 
(partition by p.projectid
 order by p._id desc) as row  from profile_31726 as p ),

table2 as
( select p.projectid , p._id , sta.name as status_update from profile_16619 as p

left join ds_mysql_prod_tagelement sta
on p.status = sta.id),

table3 as
(
  select * from table1 where row=1 
),

table4 as
( select p.* , t2.status_update from table3 as p 
 
  left join table2 t2 
  on p.projectid = t2.projectid 
 )

select * from table4