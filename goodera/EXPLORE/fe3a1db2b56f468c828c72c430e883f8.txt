with table1 as 
(
 select s1.*,c from profile_68161 as s1, s1.programs_run c  
)
, table2 as
(
select facility_status, p_cat.name as primary_category , cou_name.name as country_name , p_ven_name.name as vendor_name, pro_run.name as programs_run from table1 as tab1

left join ds_mysql_prod_tagelement pro_run 
on tab1.c = pro_run.id
  
left join ds_mysql_prod_tagelement cou_name 
on tab1.country_name = cou_name.id
  
left join ds_mysql_prod_tagelement p_ven_name 
on tab1.parent_vendor_name = p_ven_name.id
  
left join ds_mysql_prod_tagelement p_cat 
on tab1.primary_category = p_cat.id
  )
  select facility_status, programs_run , primary_category , country_name , vendor_name   from table2
  
  group by facility_status , primary_category , country_name , vendor_name , taable2.programs_run
  
--   projectId, name, month, fy, facility_name, child_vendor_name, parent_vendor_name, facility_status, facility_rating, country_code, pace_status, pace_status_detail, assessor, last_assessment_date, sustainability_contact, payment_method, last_assessment_name, last_assessment_type, date_latest, pace, wcp, sst, wep, gbv, goodera_facility_name, goodera_facility_name_text, fac_vpid, child_vendor_vpid, parent_vendor_vpid, facility_score, open_issues, total_workers, female_workers, male_workers, vendor_name, primary_category, country_name, fac_id
