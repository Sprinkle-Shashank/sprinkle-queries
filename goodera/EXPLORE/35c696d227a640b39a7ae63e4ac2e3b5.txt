with t1 as 
(select tag1.name as projectid, tag2.name as donor, fy_timerange, count(distinct school_name) as school_count, fy_timerange.start as start_date, fy_timerange.end as end_date
from profile_80587 p1
left join ds_mysql_prod_project tag1
on tag1.id = p1.projectid
left join ds_mysql_prod_project tag2
on tag2.id = tag1.parent
group by 
tag1.name, tag2.name, fy_timerange, school_name),

t2 as 
(select projectid, donor, fy_timerange, school_count, start_date:: date as start_1, end_date:: date as end_1
from t1)

select projectid, donor, fy_timerange, school_count, to_char(start_1, 'DD-MM-YYYY') as start_year, to_char(end_1, 'DD-MM-YYYY') as end_year
from t2

order by start_1 ASC
--order by end_1 ASC







