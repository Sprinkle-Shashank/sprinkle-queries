with t1 as 
(select tag1.name as projectid, fy_timerange, tag2.name as final_selection, 
case tag2.name when 'Yes' then 'Final Selection' else 'Not Selected' end as selection, count (*)
from profile_83188 p1
left join ds_mysql_prod_project tag1
on p1.projectid = tag1.id
left join ds_mysql_prod_tagelement tag2
on p1.final_selection = tag2.id
group by 
tag1.name, fy_timerange, tag2.name),

t2 as
(select count (*) as total selection 
from 83188),

t1 
union all
t2

