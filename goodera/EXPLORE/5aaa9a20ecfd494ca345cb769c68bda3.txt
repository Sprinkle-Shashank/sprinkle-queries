with t1 as 
(select tag1.name as projectid, fy_timerange, tag2.name as final_selection, 
case tag2.name when 'Yes' then 'Final Selection' else 'Not Selected' end as selection, count (*) as final_selection
from profile_83188 p1
left join ds_mysql_prod_project tag1
on p1.projectid = tag1.id
left join ds_mysql_prod_tagelement tag2
on p1.final_selection = tag2.id
where tag2.name = 'Yes'
group by 
tag1.name, fy_timerange, tag2.name),

t2 as 
(select tag1.name as projectid, fy_timerange, tag2.name as final_selection, 
case tag2.name when 'Yes' then 'Final Selection' else 'Not Selected' end as selection, count (*) as Total_applicants
from profile_83188 p1
left join ds_mysql_prod_project tag1
on p1.projectid = tag1.id
left join ds_mysql_prod_tagelement tag2
on p1.final_selection = tag2.id
where tag2.name = 'No'
group by 
tag1.name, fy_timerange, tag2.name)

select * from t1
union all
select * from t2



