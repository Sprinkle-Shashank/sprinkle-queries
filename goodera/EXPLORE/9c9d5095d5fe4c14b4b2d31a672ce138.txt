with temp1 as
(select projectId.name as projectId, fy_timerange, school_name, lat, long, Sum(n.no_of_students) as Number_of_Students, Sum(n.no_of_interschool_comps) as Number_of_inter_school_comps, Sum(n.no_of_classroom_sessions) as Number_of_classroom_sessions , Sum(n.no_of_actionplans) as Number_of_action_plans, Count(n.school_list) as Number_of_Schools, 'Environment' as theme, 'Green Me' as program,
 
CASE
WHEN school_list = ''  THEN '0' ELSE Download end as m
 
 from profile_64384 as n 
 
left join ds_mysql_prod_project projectId
 on n.projectId = projectId.id 
 
 
 group by projectId.name, fy_timerange, school_name, lat, long)
 
 select * from temp1
 

 