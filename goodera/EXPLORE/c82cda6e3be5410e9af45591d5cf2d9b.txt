with temp1 as
(select state_parent.name as state, projectId, state_district, fy_timerange, count(*) from profile_46325 as m 

left join ds_mysql_prod_tagelement as state
on m.state_district = state.id
 
left join ds_mysql_prod_tagelement as state_parent
on state.parent = state_parent.id

WHERE state_district = '' OR state_district IS not NULL
group by projectId, fy_timerange, state_district),

temp2 as
(select projectId, state_district, fy_timerange, state from temp1
 )
 select * from temp2
