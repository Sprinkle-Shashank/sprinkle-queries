select projectId, state_district, fy_timerange, count(*) from profile_46325 as m


left join ds_mysql_prod_tagelement as state
on m.state_district = state.id
 
left join ds_mysql_prod_tagelement as state_parent
on state.parent = state_parent.id

case 
when state_district.name IS NULL AND state.name IS NOT NULL THEN state.name
else state_district.name 
END AS state


WHERE state_district = '' OR state_district IS not NULL
group by projectId, fy_timerange, state_district
