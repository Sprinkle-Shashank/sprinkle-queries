with tab1 as (select cast((split_part(prod.name,'|',1)) as varchar) as prj1,cast((split_part(split_part(prod.name,'|',1),'.',1)) as varchar) as prj2,prj_code from profile_54963
left join ds_mysql_prod_project prod
on projectid=prod.id),
tab2 as (select distinct(prj1) as p1 from tab1),
tab3 as (select q.prj2 as prj3 from tab1 q left join profile_27396 p 
		 on p._id=q.prj_code)
select tab2.p1,tab3.prj3
		

 