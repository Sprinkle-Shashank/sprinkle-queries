with tab1 as (select cast((split_part(prod.name,'|',1)) as varchar) as prj1,cast((split_part(split_part(prod.name,'|',1),'.',1)) as varchar) as prj2 from profile_54963
left join ds_mysql_prod_project prod
on projectid=prod.id),
tab2 as (select distinct(prj1) as p1,distinct(prj2) as p2 from tab1)
select tab2.p1,tab2.p2 from tab2
--tab3 as (select name,state from profile_27396 q
		-- left join profile_54963 p on
		 --p.prj_code=q.id
		 

 