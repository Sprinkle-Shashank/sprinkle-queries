with tab1 as (select cast((split_part(prod.name,'|',1)) as varchar) as prj1,cast((split_part(split_part(prod.name,'|',1),'.',1)) as varchar) as prj2,prj_code,f.name as fy_timerange from profile_54963 p
left join ds_mysql_prod_project prod
on p.projectid=prod.id
left join ds_mysql_prod_tagelement f on
p.fy=f.id),
tab3 as (select q.prj2 as prj3,count(q.prj1) as c,q.fy_timerange from tab1 q 
		 left join profile_27396 p 
		 on p._id=q.prj_code)
select tab3.prj3,tab3.prj1,tab3.fy_timerange from tab3
		

 