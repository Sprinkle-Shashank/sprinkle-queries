with sub1 as(
select metric, fy, brand, region, tier, source_div, energy_type, type, flag, sum(attainment) as attainment
from profile_62632
group by metric, fy, brand, region, tier, source_div, energy_type, type, flag),
sub2 as(
  select metric, fy2, t.name as fy, brand, region, tier, source_div, energy_type, type, flag, attainment
  from sub1
  left join ds_mysql_prod_tagelement t
  on t.id=fy2)
  select * from sub2