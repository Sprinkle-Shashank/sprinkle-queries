 with table1 as (select add_factory.projectid,pace_mapping.name_factory as factory,pace_mapping.name_vendor_filter as vendor,pace_mapping.name_country as country,    pace_mapping.name_country , pace_mapping.name_vendor , pace_mapping.name_rp , pace_mapping.name_factory, factory_vpid_1 as community_id, child_vendor_vpid as vp_id from profile_52713 add_factory

left join profile_54646 pace_mapping 
on add_factory.projectid = pace_mapping.projectid ) ,


table2 as
( 
 select projectid, _id ,  cast(concat('FY ' ,start_year) as varchar) as start_year , end_date, end_date_2, cast(start_year as varchar) as start_year_1 , num_females,num_females_graduated,concat(projectid,start_date) as unique from profile_4227 p
),


table3 as 
(
  select projectid, _id , to_char(start_date,'YYYY-MM-DD') , concat(projectid,start_date) as unique from profile_4227 p
  where end_date_2 is not null 
)

select t2.* , t3.start_date  from table2 t2

left join table3 t3 on 
t2._id = t3._id

/*
table9 as 
(  
select t1.projectid ,factory, vendor, country, community_id, vp_id, to_char(t2.start_date,'YYYY'), t3.start_date, t2.end_date_2,  t2.num_females, t2.num_females, t2.num_females_graduated , t2.unique  	 

from table1 t1

left join table2 t2 on
t1.projectid = t2.projectid

left join table3 t3 on
t1.projectid = t3.projectid

left join table4 t4 on
t1.projectid = t4.projectid
)

select * from table9
*/
