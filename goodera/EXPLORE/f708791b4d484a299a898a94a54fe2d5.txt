--applicant reaches
--Desk review for Bajaj csr  ( task id = 817 )
--Proposal recommendation by Admin for green channel ( task id = 4496 )
--condition(action is [completed or rejected] )

with base1 as (select 
gpr.completedon,gpr.action
,count(*) over (partition by gpr.grantflowtaskid,gpr.grantproposalid) as row_count
from ds_mysql_prod_grantflowtaskgrantproposalrecord gpr
where (gpr.grantflowtaskid = '817' or gpr.grantflowtaskid = '4496') and gpr.action = 'COMPLETED')

select * from base1
--where row_count = 1
