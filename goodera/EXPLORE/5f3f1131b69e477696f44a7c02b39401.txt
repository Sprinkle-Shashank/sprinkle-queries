select count(distinct(upper(code.Village))) as No_of_Villages from (select SUBSTRING(PROPOS,charindex('|',PROPOS)+1,6) as censuscode from
(select SUBSTRING(ProjName,charindex('|',ProjName)+1,100) as PROPOS from (select  prod.name as ProjName from
profile_59426 p 
left join 
ds_mysql_prod_project prod on
prod.id=p.projectid)))
left join Village_census_code_profile_27489 code on
code.name=censuscode