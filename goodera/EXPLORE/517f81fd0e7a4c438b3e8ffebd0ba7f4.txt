with t1 as
 (select projectid.name as projectid, fy_timerange, num_students_pre_primary,num_students_primary, num_students_secondary, num_students_senior_secondary
  from profile_83513 as p
  ),
  t2 as
  (select * from
   (select projectid, fy_timerange, sum(num_students_pre_primary) as PrePrimary, sum(num_students_primary) as Primary, sum(num_students_secondary) as Secondary, sum(num_students_senior_secondary) as SeniorSecondary from t1
	group by projectid, fy_timerange
	)
   UNPIVOT
   (Val FOR Dim IN(PrePrimary,Primary,Secondary,SeniorSecondary))
   )
   select projectid, fy_timerange, val from t2