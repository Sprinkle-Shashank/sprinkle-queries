SELECT household_no,household_closed,fy_timerange,projectid,
(household_no-household_closed) AS intermediate_active_household,
sum(household_no) over(order by fy_timerange rows between unbounded PRECEDING and current row) AS active_household,
lag(active_household, 1) over (order by fy_timerange asc) as next_month
from profile_59871
ORDER BY fy_timerange asc
group by 
