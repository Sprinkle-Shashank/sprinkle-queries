select  p.placed, p.fy_timerange, h.donor, h.donor_commitment ,t2.name as project , sum(case when h.end > current_Date then 1 else 0 end) as count from profile_36901 p

left join profile_36904 h on
p.batch_id=h._id

LEFT JOIN ds_mysql_prod_project t on p.projectId=t.id
LEFT JOIN ds_mysql_prod_project t1 on t.parent=t1.id      
LEFT JOIN ds_mysql_prod_project t2 on t1.parent=t2.id


where h.donor is not null

group by donor, donor_commitment, p.fy_timerange,p.placed,t2.name