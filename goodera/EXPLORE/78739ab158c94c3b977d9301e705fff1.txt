with sub1 as(
SELECT sq.projectId as partner, sq.proj_name, 
	EXTRACT(Year FROM(CAST(sq.proj_start_date AS datetime))) as start_year,
  	EXTRACT(Year FROM(CAST(sq.proj_end_date AS datetime))) as end_year,t1.name as projectId, pd.ia_sel_ngop as impl_agency, sq._id as id1, SUM(mr.allocated) as budget 
  from profile_65552 sq
left join ds_mysql_prod_project t
on t.id=sq.projectId
left join ds_mysql_prod_project t1
on t.parent=t1.id
left join profile_65576 pd
on sq.impl_agency=pd.ia_sel_ngop
left join profile_65557 mr
on mr.project_name=sq._id
  
group by sq.proj_name, start_year, end_year, t1.name, pd.ia_sel_ngop, sq._id, sq.projectId),

  select * from sub1