--GSK_Consumer_Number_OPD


wit table1 as
( select p1.projectid , p1._id , p1.name , sta.name as state_update , dis.name as district_update , reg_date , ben_name , ben_id , age , gender , con_details , address  from profile_82797 as p1
 
left join ds_mysql_prod_tagelement dis
on p1.state_dist = dis.id

left join ds_mysql_prod_tagelement sta
on dis.parent = sta.id
 
 )
 
 select * from table1 as p
/*
with table1 as
( select p.* , sta.name as state_update , dis.name as district_update
 from profile_82798 as p 

 left join profile_82797 p1
on p.benef = p1._id
 
left join ds_mysql_prod_tagelement dis
on p1.state_dist = dis.id

left join ds_mysql_prod_tagelement sta
on dis.parent = sta.id
 
 ),
 
 table2 as
 ( select p.projectid , p._id , state_update , district_update , fy_timerange , height , weight , bmi_value , rapid_test , medical_issue , hospital_name , p.name , remarks ,  count(p._id) as count_value from table1 as p
 
 group by  p.projectid , p._id , state_update , district_update , fy_timerange , height , weight , bmi_value , rapid_test , medical_issue , hospital_name , p.name , remarks 
 )
 
 
 select * from table2
 
 */