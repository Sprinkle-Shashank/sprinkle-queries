with table1 as (select  p.projectid,target_2014,target_2015,target_2016,target_2017,target_2018,target_2019,target_2020,target_2021,target_2022,pace_mapping.name_vendor_filter, case when start_quarter=1 then '1st (Feb-Apr)'
 when start_quarter=2 then '2nd (May-Jul)'
  when start_quarter=3 then '3rd (Aug-Oct)'
   when start_quarter=4 then '4th (Nov-Jan)'
   else null end as start_quarter,  num_females, lg_status, pace_mapping.name_vendor,pace_mapping.name_country,
  type_program as select_modules, pace_mapping.name_rp as regional_partner,         pace_mapping.projcode_factory as codes, pace_mapping.name_factory as locations, pace_mapping.partner_type
from profile_4579  p
			   
	left join profile_54646 pace_mapping on
p.partner_name = pace_mapping.name_vendor	
				
LEFT JOIN profile_4227 ON
pace_mapping.projectId = profile_4227.projectId
				
	group by partner_name,p.projectid,target_2014,target_2015,target_2016,target_2017,target_2018,target_2019,target_2020,target_2021,target_2022, num_females,lg_status, select_modules, name_vendor, name_country, name_vendor_filter, start_quarter, regional_partner,codes, locations, temp.C, partner_type	),

temp as (
  select 'FY 2014' as C
  Union all
  select 'FY 2015' as C
  Union all
  select 'FY 2016' as C
  Union all
  select 'FY 2017' as C
  Union all 
  select 'FY 2018' as C
  Union all
  select 'FY 2019' as C
  Union all
  select 'FY 2020' as C
  Union all
  select 'FY 2021' as C
  Union all
  select 'FY 2022' as C )
  
 select pro.name as projectid, num_females,lg_status, select_modules, name_vendor, name_country, name_vendor_filter, start_quarter, 
 sum( Case C
	When 'FY 2014' then p.target_2014
	When 'FY 2015' then p.target_2015
	 When 'FY 2016' then p.target_2016
	 When 'FY 2017' then p.target_2017
     When 'FY 2018' then p.target_2018
	 When 'FY 2019' then p.target_2019
	 When 'FY 2020' then p.target_2020
	 When 'FY 2021' then p.target_2021
	 When 'FY 2022' then p.target_2022
	 
	 else null end) as value, temp.c as start_year, regional_partner,codes, locations,partner_type from table1 p
cross join temp 	 
left join ds_mysql_prod_project as pro
  on p.projectid = pro.id


group by pro.name,name_vendor_filter, temp.c,  num_females,lg_status, select_modules, name_vendor, name_country, name_vendor_filter, start_quarter, regional_partner,codes, locations,partner_type

--select * from table1

