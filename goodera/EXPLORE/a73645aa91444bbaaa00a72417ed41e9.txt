

with table1 as 
(
select p.projectid , p.name , p.name_vendor , p2.vendor from profile_54646 p

left join profile_52162 p2 on 
p.name_vendor = p2.vendor

),

table2 as 
(
   select p.* , len(ngo_name) as length_of_ngo , concat('NG: ', ngo_name) as update_ngo_name from profile_5997 p
  ),
  
  
  table3 as
  (
	 select p.projectid , p2.name from profile_54646 p
	
left join table2 p2 on 
p.name_vendor = p2.update_ngo_name
	)
  select * from table2