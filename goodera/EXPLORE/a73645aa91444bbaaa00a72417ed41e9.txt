
with table2 as 
(
   select p.* , len(ngo_name) as length_of_ngo , concat('NG: ', ngo_name) as update_ngo_name , pace_value.name as pace_update from profile_5997 p
  
  left join ds_mysql_prod_tagelement pace_value on 
  p.pace_status = pace_value.id
  ),
  
  table5 as 
  (
	 select p.* from profile_52162 p
	),
	
  
  table3 as
  (
	
select p.projectid , p._id , p.name , name_country , name_vendor , name_vendor_filter , name_rp , name_vendor_filter as Partner_name , substring(Partner_name ,0,2) as First_Value, case when First_Value='V' then 'Vendor Partner' else 'Community Partner' end as Partner_type , case when First_Value='V' and t3.sourcing_yn=57472 then cast(t3.vpid_1 as varchar) when First_Value='V' and t3.sourcing_yn=57473 then cast(t3.vpid_2 as varchar) when First_Value='V' then cast(t3.child_vpid_autocal as varchar) else p2.cp_id end as Vendor_partner_ID from profile_54646 p

left join table5 t3 on 
p.name_vendor = t3.vendor

left join table2 p2 on 
p.name_vendor = p2.update_ngo_name
	)
  select * from table2
  
  /*
  
   ,  case when First_Value='V' then t3.pace_status else p2.pace_status end as current_pace_stauts
   
   */