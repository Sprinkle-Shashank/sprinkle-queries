select p.uid_ref as UID,concat(p.first_name,concat(' ',p.last_name)) as Name,p2.name as Gender,p.age as Age,to_char(date_y,'DD-MM-YYYY') as date1,SUBSTRING(reg_date,1,10) as date2,decode(date1,null,date2,date1) as Date_of_Registration,count(p3.patient) as consultation,' ' as Address, SUBSTRING(Decode(p4.date_n,null,p4.createddate,p4.date_n),1,10) as Last_consultations
--concat(loc.name,concat('-',sta.name)) as Address
 from profile_58473 p
left join ds_mysql_prod_tagelement p2
on p.gender=p2.id
left join profile_58474 p3
on p._id=p3.patient
left join profile_58511 p4
on p3.sel_camp=p4._id
group by p.uid_ref,p.first_name,p.last_name,p2.name,p.age,p.date_y,p.reg_date,p3.patient,p4.date2,p4.date_n,p4.createddate
/*left join ds_mysql_prod_tagelement loc
on p.location=loc.id
left join ds_mysql_prod_tagelement sta
on loc.parent=sta.id*/
