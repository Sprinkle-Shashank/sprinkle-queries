select p.fy_timerange,p2.name as van,p3.name as partner,p.name,p.bene_age,p.bene_gender as gender,t1.name as dis1,t2.name as dis2,count(*) count(dis1+dis2) as dis_count, 1 as unique_count,

--case when 

from profile_83301 p

left join ds_mysql_prod_project p2 on p2.id=p.projectid 
left join ds_mysql_prod_project p3 on p3.id=p2.parent
left join tagElement_10099 t1 on p.sys_affected1 = t1.id
left join tagElement_10099 t2 on p.sys_affected2 = t2.id

where p.projectid like '%%' 
--and p2.name <> 'Chennai - TN 10 AS 5135'
--and t2.name <> 'No Referral'

group by p.fy_timerange,p2.name, p3.name, p.name,p.bene_age,p.bene_gender,t1.name, t2.name,t3.name