select p1.region_parent as region, p1.curr_cr_rating, p1.timeperiod_timerange, p1.factory_id, is_array(p1.source_div) as source_div_array_check,
case
	when source_div_array_check is false or GET_ARRAY_LENGTH(p1.source_div) = 0 then array(p1.source_div)
	else p1.source_div
end as source_div_new
from profile_60928 p1
where p1.curr_cr_rating = 957780 and nvl(cr_tier, 0) not in (957759, 957760)