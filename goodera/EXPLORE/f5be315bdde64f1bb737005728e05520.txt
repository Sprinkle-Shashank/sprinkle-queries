
with Lookup as
(select cast((split_part(split_part(prod.name,'|',1),'.',1)) as varchar) as ProjectCode,f.name as fy_timerange,p.focus_area as Focusarea,p.bennum as No_of_Beneficiaries,CONCAT(ProjectCode,fy_timerange) as CODE
from profile_59426 p 
left join ds_mysql_prod_project prod on
prod.id=p.projectid
left join ds_mysql_prod_tagelement f on
p.fy=f.id
)

select * from Lookup