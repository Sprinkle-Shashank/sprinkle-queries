
with tab1 as
(
Select p1.fy_timerange,t1.name as category,p2.name as head,p1.name,p1.amount as amt1,sum(amt1) as amt,
CAST(p1.fy_timerange.start AS date) AS start
from profile_55699 p1
left join profile_55698 p2
on p2.head = p1._id
left join ds_mysql_prod_tagelement t1
on t1.id = p1.category
where p1.projectid = '44834'
group by 1,2,3,4,5,7)

Select fy_timerange,EXTRACT(YEAR FROM start) AS year,category, head,name,amt1,amt
from tab1
 -- cast(split_part(prod.name,'|',1) as varchar) as ProjectCode