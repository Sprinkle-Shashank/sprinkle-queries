with s as (Select 
data.name,data.ngo_partner,data.project_manager,data.focus_area,data.intervention_type,data.start_date,data.end_date,
submissionlog.timestamp,approvallog,
case
	 when profileinstanceid is null then _id
	 else profileinstanceid
	end as profileinstanceid
from ds_mongo_taskresponse 	
where profileId=27396
),s2 as(
Select name,ngo_partner,project_manager,focus_area,intervention_type,start_date,end_date,profileinstanceid,al,al.approvalstatus as status2,timestamp
from s as p,p.approvallog al
)
Select name,ngo_partner,project_manager,focus_area,intervention_type,start_date,end_date,profileinstanceid,al, status2,timestamp
from s2
left join profile_28235 ss
on ss._id=s2.intervention_type
	
	