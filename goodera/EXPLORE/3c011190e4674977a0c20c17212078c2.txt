

with table1 as
(
  select p.projectid , country , cou.name as country_update from profile_52162 p
  
  left join ds_mysql_prod_tagelement cou on 
  p.country = cou.id
),

table2 as 
( select p.projectid , country from profile_5997 p

),

table3 as
(
select t2.*, cast(f1 as varchar) from table2 t2, t2.country as f1
),

table4 as
( select t3.*,cou.name as country_update from table3 t3
 
  left join ds_mysql_prod_tagelement cou on 
  t3.f1 = cou.id
 ),
 
 table5 as
 ( select p.projectid , name_vendor_filter, case when name_vendor_filter ilike '%Factory%' then name_vendor_filter when name_vendor_filter ilike '%CP%' then name_vendor_filter else name_vendor_filter end as name_vendor_filter from profile_54646 p),
 
  table7 as
  (select p.projectid , pace_status , pace.name as pace_update, cp_id from profile_5997 p
   
  left join ds_mysql_prod_tagelement pace on 
  p.pace_status = pace.id
   ),
 
 table6 as
 ( select p.projectid , case when sourcing_yn=57472 then cast(vpid_1 as varchar) when sourcing_yn=57473 or child_vpid_autocal is not null then cast(vpid_2 as varchar)  else t7.cp_id end as vendor_partner_id , case when pace_162.name is not null then pace_162.name else t7.pace_update end as pace_Status_update from profile_52162 p
  
  left join table7 t7
  on p.projectid = t7.projectid
  
  left join ds_mysql_prod_tagelement pace_162 on 
  p.pace_status = pace_162.id
  )
 select * from table6
 