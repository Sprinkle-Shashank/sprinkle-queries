
with table5 as
( select p._id , p.projectid,p.name, cast(concat('FY ' ,start_year) as varchar) as start_year,to_char(start_date,'YYYY') as start_date , case when end_date_2 is not null then to_char(start_date,'YYYY-MM-DD') end as start_date_update ,to_char(end_date_2,'YYYY-MM-DD') as end_date_2,num_females,num_females_graduated from profile_4227 p),

table6 as
( select p._id , p.projectid , p.name , to_char(start_date , 'YYYY-MM-DD') as start_date from profile_4227 p
 where end_date_2 is not null)
 
 
 select p._id , p.projectid , p.name , t6._id , t6.projectid , t6.name from table5 p
 
 left join table6 t6 on 
 p.projectid = t6.projectid
 