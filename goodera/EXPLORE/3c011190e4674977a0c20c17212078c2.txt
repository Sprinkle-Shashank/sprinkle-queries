

with table1 as
(
  select p.projectid , country , cou.name as country_update from profile_52162 p
  
  left join ds_mysql_prod_tagelement cou on 
  p.country = cou.id
),

table2 as 
( select p.projectid , country from profile_5997 p

),

table3 as
(
select t2.*, cast(f1 as varchar) from table2 t2, t2.country as f1
),

table4 as
( select t3.*,cou.name as country_update from table3 t3
 
  left join ds_mysql_prod_tagelement cou on 
  t3.f1 = cou.id
 ),
 
 table5 as
 ( select p.projectid , name_vendor_filter, case when name_vendor_filter ilike '%Factory%' then name_vendor_filter when name_vendor_filter ilike '%CP%' then name_vendor_filter end as name_vendor_filter from profile_54646 p),
 
 table6 as
 ( select p.projectid , p._id , case when sourcing_yn=57472 then vp_1 when sourcing_yn=57473 or child_vpid_autocal is not null then vp_2 else cp_id end as vendor_partner_id from profile_52162 p
  
  left join profile_5997 p9
  on p.projectid = p9.projectid
  )
 
 select * from table6
 