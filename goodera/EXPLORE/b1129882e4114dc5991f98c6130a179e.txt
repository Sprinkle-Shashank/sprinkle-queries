with t1 as 
(select p1._id, t2.name as project_name, p1.projectid, tag1.name as financial_year, to_char(p1.date_of_reg, 'YYYY-MM-DD') as date_of_reg, p1.reg_no, p1.trainee_name, to_char(p1.dob, 'YYYY-MM-DD'), tag2.name as gender, p1.addr, tag3.name as district, tag4.name as state, p1.email, tag6.name as edu_qual, tag7.name as occu, tag8.name as marriage, p1.fam_head, p1.fam_head, p1.fam_occ, p1.comments, p1.nps_feedback_q, p1.suggestions, tag10.name as placed, p1.date_of_placement, p1.emp_name_new, tag11.name as role_after_placement, p1.job_loc, tag12.name as type, tag13.name as city_of_job, p1.dropout, p1.employment_status, p1.story, tag5.name as state_and_city, tag9.name as city_preference_1, p1.fy_timerange, p1.location_pref_1, p1.city_preference_2, p1.type_of_dis, p1.zone_db, p1.partner_db, p1.center_name_db, p1.batch_id_db, to_char(p1.batch_start_db, 'YYYY-MM-DD') as start_1, to_char(p1.batch_end_db, 'YYYY-MM-DD') as end_1, p1.age, p1.mobile_no, p1.mobile_number_2, p1.fam_size, p1.fam_income, p1.salary, p1.lvl_of_dis, p1.pincode, p1.uid
from profile_36901 p1
left join ds_mysql_prod_project t
on p1.projectId=t.id
left join ds_mysql_prod_project t1
on t.parent=t1.id
left join ds_mysql_prod_project t2 
on t1.parent=t2.id

left join ds_mysql_prod_tagelement tag1
on p1.financial_year = tag1.id
left join ds_mysql_prod_tagelement tag2
on p1.gender = tag2.id
left join ds_mysql_prod_tagelement tag3
on p1.district = tag3.id
left join ds_mysql_prod_tagelement tag4
on p1.state = tag4.id
left join ds_mysql_prod_tagelement tag5
on p1.state_and_city = tag5.id
left join ds_mysql_prod_tagelement tag6
on p1.edu_qual = tag6.id
left join ds_mysql_prod_tagelement tag7
on p1.occu = tag7.id
left join ds_mysql_prod_tagelement tag8
on p1.marriage = tag8.id
left join ds_mysql_prod_tagelement tag9
on p1.city_preference_1 = tag9.id
left join ds_mysql_prod_tagelement tag10
on p1.placed = tag10.id
left join ds_mysql_prod_tagelement tag11
on p1.role_after_placement = tag11.id
left join ds_mysql_prod_tagelement tag12
on p1.type = tag12.id
left join ds_mysql_prod_tagelement tag13
on p1.city_of_job = tag13.id

union

select p2._id, t2.name as project_name, p2.projectid, tag1.name as financial_year, to_char(p2.date_of_reg, 'YYYY-MM-DD') as date_of_reg, p2.reg_no, p2.trainee_name, to_char(p2.dob, 'YYYY-MM-DD'), tag2.name as gender, p2.addr, tag3.name as district, tag4.name as state, p2.email, tag6.name as edu_qual, tag7.name as occu, tag8.name as marriage, p2.fam_head, p2.fam_head, p2.fam_occ, p2.comments, p2.nps_feedback_q, p2.suggestions, tag10.name as placed, p2.date_of_placement, p2.emp_name_new, tag11.name as role_after_placement, p2.job_loc, tag12.name as type, tag13.name as city_of_job, p2.dropout, p2.employment_status, p2.story, tag5.name as state_and_city, tag9.name as city_preference_1, p2.fy_timerange, p2.location_pref_1, p2.city_preference_2, p2.type_of_dis, p2.zone_db, p2.partner_db, p2.center_name_db, p2.batch_id_db, to_char(p2.batch_start_db, 'YYYY-MM-DD') as start_1, to_char(p2.batch_end_db, 'YYYY-MM-DD') as end_1, p2.age, p2.mobile_no, p2.mobile_number_2, p2.fam_size, p2.fam_income, p2.salary, p2.lvl_of_dis, p2.pincode, p2.uid
from profile_145 p2
left join ds_mysql_prod_project t
on p2.projectId=t.id
left join ds_mysql_prod_project t1
on t.parent=t1.id
left join ds_mysql_prod_project t2 
on t1.parent=t2.id

left join ds_mysql_prod_tagelement tag1
on p2.financial_year = tag1.id
left join ds_mysql_prod_tagelement tag2
on p2.gender = tag2.id
left join ds_mysql_prod_tagelement tag3
on p2.district = tag3.id
left join ds_mysql_prod_tagelement tag4
on p2.state = tag4.id
left join ds_mysql_prod_tagelement tag5
on p2.state_and_city = tag5.id
left join ds_mysql_prod_tagelement tag6
on p2.edu_qual = tag6.id
left join ds_mysql_prod_tagelement tag7
on p2.occu = tag7.id
left join ds_mysql_prod_tagelement tag8
on p2.marriage = tag8.id
left join ds_mysql_prod_tagelement tag9
on p2.city_preference_1 = tag9.id
left join ds_mysql_prod_tagelement tag10
on p2.placed = tag10.id
left join ds_mysql_prod_tagelement tag11
on p2.role_after_placement = tag11.id
left join ds_mysql_prod_tagelement tag12
on p2.type = tag12.id
left join ds_mysql_prod_tagelement tag13
on p2.city_of_job = tag13.id
)

select project_name, financial_year, SUBSTRING(date_of_reg,9,10) as reg_date
from t1










		  
		  
