with sub1 as(
  select a.*, projects_unwind from profile_76630 a, a.projects projects_unwind),
  
sub2 as(select extract(year from cast(s1.timerange_timerange.start as date)) as year,listagg(distinct t1.name,', ') as projects,s1.target from sub1 s1
left join ds_mysql_prod_tagelement t1 on t1.id=s1.projects_unwind
group by year,target,projects)

select s2.year,s2.target,s2.projects, len(s2.projects) as achieved from sub2 s2