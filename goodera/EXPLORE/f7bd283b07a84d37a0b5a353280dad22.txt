with sub1 as(
Select t.name as proj_location, sq.fy_timerange, sq.headline, sq.brief, sq.source, sq.date, sq.photo, sq.url,t2.name as partner,t3.name as projectId
  FROM profile_65561 sq
  left join ds_mysql_prod_project as t 
  on sq.projectId = t.id
  left join ds_mysql_prod_project as t2
  on t.parent=t2.id
  left join ds_mysql_prod_project as t3
  on t2.parent=t3.id 
  
  ),
sub2 as(
  Select s1.proj_location, s1.fy_timerange, s1.headline, s1.brief, source1, s1.date, s1.photo, s1.url,substring(date,1,10) ,'Click Here' as Click
  from sub1 s1, s1.source source1
  ),
  sub3 as(
	Select s1.proj_location, s1.fy_timerange, s1.headline, s1.brief, source1, s1.date, s1.photo, s1.url,substring(date,1,10) ,Click, pd.impl_agency as imp_partner,qw.location
	case
		when s1.proj_location=53580 then 'Barola'
		when s1.proj_location=53412 then 'Sardarpur'
		when s1.proj_location=53528 then 'Thane'
		when s1.proj_location=Thane then 'Navi Mumbai'
	end as center
	from sub2
	left join profile_65552 pd
	ON pd.impl_agency=sub2.projectId
	left join profile_65603 qw
	ON qw.projectId=sub2.proj_location
	ORDER BY fy_timerange desc
  )
  select * from sub3