--with Base1 as(select  count(*)  as Activities_to_be_done,case when p._id is not NULL then 'Number of Activities to be done' end  as type  from profile_54963 p group by p._id),Base2 as(select sum(Activities_to_be_done)as Number,type from Base1 group by type ),Base3 as(select count(*)as Number,case when p.subcat_output is not null then 'Activities Approved' end as type from profile_54963 p where p.subcat_output is not NULL group by p.subcat_output)
--,Base4 as(select 
--select * from Base2
-----------------------------------------------------------
with lookup as (select split_part(split_part(prod.name,'|',1),'.',1) as ProjectCode,f.name as fy_timerange,concat(ProjectCode,fy_timerange) as CODE,split_part(prod.name,'|',3) as census,case when p._id is not NULL then 'Number of Activities to be done' end  as type  from profile_54963 p
left join ds_mysql_prod_project prod on
prod.id=p.projectid
left join ds_mysql_prod_tagelement f on
p.fy=f.id)