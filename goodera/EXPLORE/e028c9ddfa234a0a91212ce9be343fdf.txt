with s as 
(Select name as site,('FY '||EXTRACT(YEAR FROM(CAST(startdate AS datetime)))||'-'||substring(EXTRACT(YEAR FROM(CAST(startdate AS datetime)))+1,3,2) )as year,fy_timerange,datatablebase,tablesettings,questiontext
from sus_64073
where keyword= 'emission_factor_fuel_type'
)
,
s2 as(
Select site,year,fy_timerange,questiontext, cast(tablesettings."em_coal"."unit_em_factor" as varchar) coal_unit,cast(tablesettings."em_natural_gas"."unit_em_factor" as varchar) ng_unit ,cast(tablesettings."em_petcoke"."unit_em_factor" as varchar) pc_unit,cast(tablesettings."em_petrol"."unit_em_factor" as varchar) petr_unit ,cast(tablesettings."em_diesel"."unit_em_factor" as varchar)  dies_unit,cast(tablesettings."em_fo"."unit_em_factor" as varchar) fo_unit ,cast(tablesettings."em_sacoal"."unit_em_factor" as varchar) sacoal_unit ,cast(tablesettings."em_anthra"."unit_em_factor" as varchar) anthra_unit ,cast(tablesettings."em_lubes"."unit_em_factor" as varchar) lubes_unit,cast(tablesettings."em_plastics"."unit_em_factor" as varchar) plast_unit ,cast(tablesettings."em_indocoal"."unit_em_factor" as varchar) indo_unit,
   
 /*coun."em_natural_gas" ng,coun."em_petcoke" pc,coun."em_petrol"petr,coun."em_diesel"."emission_factor" dies,coun."em_fo"."emission_factor" fo,coun."em_sacoal"."emission_factor" sacoal,coun."em_anthra"."emission_factor" anthra,coun."em_lubes"."emission_factor" lubes,coun."em_plastics"."emission_factor" plast,coun."em_indocoal"."emission_factor" indo
  */
  from s
),
s3 as (
Select 'Coal' as col
 union all
Select 'Natural Gas' as col
  union all
Select 'Pet Coke' as col
  union all
Select 'Petrol' as col
   union all
Select 'Diesel' as col
   union all
Select 'FO' as col
   union all
Select 'South African Coal' as col
   union all
Select 'Anthracite Coal' as col
   union all
Select 'Lubricants' as col
  union all
Select 'Plastics' as col
  union all
Select 'Indonesian Coal' as col
  
  
)
select * from s3
--Select *, coun.emission_factor from s2 as s, unpivot s.datatablebase as coun at var;