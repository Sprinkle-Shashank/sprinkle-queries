 with t1 as(select projectId, fy_timerange, nat_festival,  no_of_children_exp_hrtge as Children_exposed_to_rich_heritage_of_arts_and_craft, no_of_children_idf_talents as
Children_identified_for_artistic_talents,p2.center_name
			
from profile_77346 p1
			left join ds_mysql_prod_project p2
on p2.id = p1.projectId
left join ds_mysql_prod_project p3
on p3.id = p2.parent
left join ds_mysql_prod_project p4
on p4.id = p3.parent
left join ds_mysql_prod_project tag2
on p1.center_name  = tag2.id),
 
item as 
(
select 'Children_exposed_to_rich_heritage_of_arts_and_craf' as c
union all
select 'Children_identified_for_artistic_talents' as c
)

select   tag1.name as projectId,fy_timerange,nat_festival,center_name,
case c
when 'Children_exposed_to_rich_heritage_of_arts_and_craf' then t1.Children_exposed_to_rich_heritage_of_arts_and_craft
when 'Children_identified_for_artistic_talents' then t1.Children_identified_for_artistic_talents

else null
end as value,item.c as dimension

from t1 cross join item
left join ds_mysql_prod_project tag1
on t1.projectId = tag1.id
--left join ds_mysql_prod_project tag2
--on t1.center_name  = tag2.id
