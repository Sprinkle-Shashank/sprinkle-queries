SELECT region_parent as region, count(*) as useless_count from profile_60928
where region_parent!='Community Program' and region_parent is not null and cr_tier!=957759
group by region_parent
/*
with sub1 as (
select case when get_array_length(sq.source_div) = 0 then array(0)
  else COALESCE(sq.source_div,array(0)) end new_source,cr_tier from profile_60928 sq
),
sub2 as(
SELECT source,cr_tier from sub1 sq,sq.new_source source)
select t.name as source_div, count(*) as UselesCount from sub2
left join ds_mysql_prod_tagelement t
on t.id=source
where t.name!='Community Program' and t.name is not null and COALESCE(cr_tier, 0)!=957759
group by t.name
*/
