with s1 as 
(select *
from profile_83767 as a,
a.photo_before as unwind_photo_before, a.photo_after as unwind_photo_after)

select tag1.name as projectid, project_name, fy_timerange, budget_approved, budget_spent, beneficiaries, location, listagg(cast(s1.unwind_photo_before as varchar),',') AS photo_before_Unwind, 
listagg(cast(s1.unwind_photo_after as varchar),',') AS photo_after_Unwind, 
to_char(fy_timerange.start :: date, 'YYYY') as start_year, to_char(fy_timerange.end :: date , 'YYYY') as end_year, remarks, 'FY' || '(' || start_year || ' - ' || end_year || ')' as Financial_year, docs, partner
from s1
left join ds_mysql_prod_project tag1 
on s1.projectid = tag1.id
group by 
tag1.name, project_name, fy_timerange, budget_approved, budget_spent, beneficiaries, location, remarks, docs, partner

