with listprop as (
select dp.grantapplicationid, ds.id, ds.grantpartnerid, dp.name
from ds_mysql_prod_grantproposal ds
left join ds_mysql_prod_grantpartner dp on 
ds.grantpartnerid = dp.id
where dp.grantapplicationid = 526 and ds.active = true
),
plan as (
 select * from planamount where disb <> 'aggregatedRow
'),
inst1 as (
select grantproposalid,cast(data.amount as int)
from ds_mongo_profileinstance where profileId='31125' and active = 't' and securitycontextid is not null )
,
inst2 as (
select grantproposalid,cast(data.amount as int)
from ds_mongo_profileinstance where profileId='31104' and active = 't' and securitycontextid is not null )
,
inst3 as (
select grantproposalid,cast(data.amount as int)
from ds_mongo_profileinstance where profileId='31113' and active = 't' and securitycontextid is not null )
,
inst1 as (
select grantproposalid,cast(data.amount as int)
from ds_mongo_profileinstance where profileId='31114' and active = 't' and securitycontextid is not null )
select * from plan


