with temp as(
  select 'Program head appointed' as col
  union all
  select 'Program managers appointed' as col
  union all
  select 'Project manager appointed' as col
  union all
  select 'Field Operation coordinators appointed' as col
  union all
  select 'Gardeners appointed' as col
  )
 
s as(
  Select * from profile_78853
  )
  Select s.name,s.fy_timerange,s.program_head,s.program_managers,s.project_manager,s.op_coordinators,s.gardeners,s.sample_testing,s.samples_sent ,s.biomass,s.species_plantation,s.species_plantation2,t.name as ProjectID,count(*), temp.col,
  sum(case col
	when 'Program head appointed' then s.program_head
	when 'Program managers appointed' then s.program_managers
	when 'Project manager appointed' then s.project_manager
	when 'Field Operation coordinators appointed' then s.op_coordinators 
	when 'Gardeners appointed' then s.gardeners
	else null
end) as Value 
  from s
  left join ds_mysql_prod_project t
  on t.id=s.projectId
  
  group by s.name,s.fy_timerange,s.program_head,s.program_managers,s.project_manager,s.op_coordinators,s.gardeners,s.sample_testing,s.samples_sent ,s.biomass,s.species_plantation,s.species_plantation2,t.name,s._id