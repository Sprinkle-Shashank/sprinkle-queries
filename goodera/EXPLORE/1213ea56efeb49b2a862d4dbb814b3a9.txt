with sub1 as(
select projectId, sched7, spoc_name, location, project_duration, logo_image, project_descrip, project_name, spoc_email, project_status, fy_timerange, budget_approved, bene_num, spoc_number, name from profile_41363),
sub2 as(
  select projectId, sched7, spoc_name, location1, project_duration1, logo_image, project_descrip, project_name, spoc_email, project_status, fy_timerange, budget_approved, bene_num, spoc_number, name from sub1 s1, s1.location location1, s1.project_duration project_duration1),
  sub3 as(
  select t2.name as projectId, sched7, spoc_name, t.name as location, t1.name as project_duration, logo_image, project_descrip, project_name, spoc_email, project_status, fy_timerange, budget_approved, bene_num, spoc_number, a.name from sub2 a
  left join ds_mysql_prod_tagelement t on t.id=a.location1
  left join ds_mysql_prod_tagelement t1 on t1.id=a.project_duration1
  left join ds_mysql_prod_tagelement t2 on t2.id=a.projectId)
  select projectId, sched7, spoc_name, location, name, project_duration, logo_image, project_descrip, project_name, spoc_email, project_status, fy_timerange, budget_approved, bene_num, spoc_number, count(*) from sub3 group by projectId, sched7, spoc_name, location, name, project_duration, logo_image, project_descrip, project_name, spoc_email, project_status, fy_timerange, budget_approved, bene_num, spoc_number