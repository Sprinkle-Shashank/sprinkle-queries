with s1 as (
Select t.name as proj_location, t1.name as partner, t2.name as projectId,ss.location school_location,pl.location,po.impl_agency as imp_partner,ss.fy_timerange,ss.medium, ss.type_school, ss.model_normal, ss.smc_yn, ss.website_yn, ss.school_name
from profile_1616 ss
left join ds_mysql_prod_project t
on ss.projectid=t.id
left join ds_mysql_prod_project t1
on t.parent=t1.id
left join ds_mysql_prod_project t2
on t1.parent=t2.id
left join profile_65603 pl
on pl.projectid=ss.projectid
left join profile_65552 po
on t.parent=po.projectid
)

Select s1.proj_location, s1.fy_timerange, s1.school_location, s1.medium, s1.type_school, s1.model_normal, s1.smc_yn, s1.website_yn, s1.partner, s1.projectId, s1.location, s1.imp_partner, s1.school_name,count(*) schools
from s1
group by s1.proj_location, s1.fy_timerange, s1.school_location, s1.medium, s1.type_school, s1.model_normal, s1.smc_yn, s1.website_yn, s1.partner, s1.projectId, s1.location, s1.imp_partner, s1.school_name