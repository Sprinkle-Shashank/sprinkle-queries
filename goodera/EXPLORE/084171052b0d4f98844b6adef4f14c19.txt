with temp1 AS
(select m._id, m.projectId, m.name AS project_code_new, m.fy_timerange, m.vertical, m.focus, m.description, m.state, m.start_date, m.direct_or_partner, m.partner, m.place, m.district, m.project_code, m.entity, vert.name AS vertical2, vert_1.name AS vertical1,

case when vert.name IS NULL AND vert_1.name IS NOT NULL THEN vert.name 
when vert_1.name IS NULL AND vert.name IS NOT NULL THEN vert_1.name
end AS verticals

from profile_62881 AS m

left join ds_mysql_prod_tagelement as vert
  on m.vertical = vert.id

left join ds_mysql_prod_tagelement as vert_1
  on vert.parent = vert_1.id),
  
  
temp2 as 
( select p.*, q1 from temp1 as p, p.vertical as q1)

Select p._id, p.projectId, p.project_code_new, p.fy_timerange, p.vertical, p.focus, p.description, p.state, p.start_date, p.direct_or_partner, p.partner, p.place, p.district, p.project_code, p.entity, p.vertical2, p.vertical1, new_2.name AS verticals From temp2
AS p

left join ds_mysql_prod_tagelement as new_1
  on p.q1 = new_1.id
  
left join ds_mysql_prod_tagelement as new_2
  on new_1.parent = new_2.id