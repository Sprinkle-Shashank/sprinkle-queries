
with sub1 as (select a.*, unwind_product_category from profile_73974 as a, a.product_category as unwind_product_category)
--,
--t1 as
--(
  select  p1.name as projectId, vendor, factory_id, tag5.name as consultant, training_type, year,p1.factory, tag1.name as country , tag4.name as unwind_product_category, tag3.name as cycle from sub1 p1
left join ds_mysql_prod_tagelement tag1
on p1.country = tag1.id
left join ds_mysql_prod_tagelement tag3
on p1.cycle  = tag3.id
left join ds_mysql_prod_tagelement tag4
on p1.unwind_product_category = tag4.id
left join ds_mysql_prod_project tag2
on p1.factory= tag2.id
 left join ds_mysql_prod_tagelement tag5
on p1.consultant = tag5.id
--) 
--select t1.projectId, vendor, factory_id, consultant, training_type, year, factory
--from t1
