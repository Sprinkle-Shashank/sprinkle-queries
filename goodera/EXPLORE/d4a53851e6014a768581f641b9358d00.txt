with t1 as 
( select   p1._id,p3.name as projectId,p4.factory, p2.vendor, p1.factory_id,tag4.name as consultant ,tag1.name as training_type, tag2.name as  year,   tag3.name as country, p2.cycle, p2.product_category from profile_61613 as p1
 
left join profile_64362 as p2
on p1.projectId = p2.projectId
 left join ds_mysql_prod_project p3
on p1.projectId= p3.id
 left join profile_64170 as p4
on p1.factory = p4._id
left join ds_mysql_prod_tagelement tag1
on p1.training_type = tag1.id
left join ds_mysql_prod_tagelement tag2
on p1.year = tag2.id
left join ds_mysql_prod_tagelement tag3
on p2.country = tag3.id
left join ds_mysql_prod_tagelement tag4
on p2.consultant_tag = tag4.id

 ),

 sub1  as(select a.*, unwind_cycle from t1 a,a.cycle as unwind_cycle),

t2 as( 
  select  c.projectId,c.factory, c.vendor, c.factory_id,c.consultant , c.training_type,  c.year,   c.country,  c.product_category, tag5.name as cycle
	  from sub1 c
left join ds_mysql_prod_tagelement tag5
on c.unwind_cycle = tag5.id ),
sub2 as ( Select b.*,unwind_product_category from t2 b , b.product_category as unwind_product_category
		  )
		  --,
		 --t3 as
		 --(
		   select f.projectId,f.factory, f.vendor, f.factory_id,f.consultant , f.training_type,  f.year,   f.country,  f.product_category, f.cycle,tag6.name as product_category
		 from sub2 f
		 left join ds_mysql_prod_tagelement tag6 on tag6.id = f.unwind_product_category
		 --),

