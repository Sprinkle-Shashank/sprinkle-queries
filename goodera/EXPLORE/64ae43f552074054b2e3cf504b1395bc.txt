with table1 as(
select mgmt_rep , worker_rep , 
--p.mgmt_rep_dropped_2 , p.worker_rep_dropped_2 , p.mgmt_rep_dropped_3 , p.worker_rep_dropped_3 , p.mgmt_rep_dropped_4 , p.worker_rep_dropped_4 , p.mgmt_rep_dropped_5 , p.worker_rep_dropped_5 , p.mgmt_rep_dropped_6 , p.worker_rep_dropped_6 , p.mgmt_rep_dropped_7 , p.worker_rep_dropped_7 , p.mgmt_rep_dropped_8 , p.worker_rep_dropped_8 ,
case when p.mgmt_rep_dropped_2 is null then  0 else p.mgmt_rep_dropped_2 end as mgmt_rep_dropped_2,
case when p.mgmt_rep_dropped_3 is null then  0 else p.mgmt_rep_dropped_3 end as mgmt_rep_dropped_3,
case when p.mgmt_rep_dropped_4 is null then  0 else p.mgmt_rep_dropped_4 end as mgmt_rep_dropped_4,
case when p.mgmt_rep_dropped_5 is null then  0 else p.mgmt_rep_dropped_5 end as mgmt_rep_dropped_5,
case when p.mgmt_rep_dropped_6 is null then  0 else p.mgmt_rep_dropped_6 end as mgmt_rep_dropped_6,
case when p.mgmt_rep_dropped_7 is null then  0 else p.mgmt_rep_dropped_7 end as mgmt_rep_dropped_7,
case when p.mgmt_rep_dropped_8 is null then  0 else p.mgmt_rep_dropped_8 end as mgmt_rep_dropped_8,
case when p.worker_rep_dropped_2 is null then 0 else p.worker_rep_dropped_2 end as worker_rep_dropped_2,
case when p.worker_rep_dropped_3 is null then 0 else p.worker_rep_dropped_3 end as worker_rep_dropped_3,
case when p.worker_rep_dropped_4 is null then 0 else p.worker_rep_dropped_4 end as worker_rep_dropped_4,
case when p.worker_rep_dropped_5 is null then 0 else p.worker_rep_dropped_5 end as worker_rep_dropped_5,
case when p.worker_rep_dropped_6 is null then 0 else p.worker_rep_dropped_6 end as worker_rep_dropped_6,
case when p.worker_rep_dropped_7 is null then 0 else p.worker_rep_dropped_7 end as worker_rep_dropped_7,
case when p.worker_rep_dropped_8 is null then 0 else p.worker_rep_dropped_8 end as worker_rep_dropped_8


from profile_16619 p

where p.status = 1400365 or p.status is null

group by p.mgmt_rep , p.worker_rep , p.mgmt_rep_dropped_2 , p.worker_rep_dropped_2 , p.mgmt_rep_dropped_3 , p.worker_rep_dropped_3 , p.mgmt_rep_dropped_4 , p.worker_rep_dropped_4 , p.mgmt_rep_dropped_5 , p.worker_rep_dropped_5 , p.mgmt_rep_dropped_6 , p.worker_rep_dropped_6 , p.mgmt_rep_dropped_7 , p.worker_rep_dropped_7 , p.mgmt_rep_dropped_8 , p.worker_rep_dropped_8 
  
  )
 select p.*, sum(mgmt_rep_dropped_2 + mgmt_rep_dropped_3 + mgmt_rep_dropped_4 + mgmt_rep_dropped_5 + mgmt_rep_dropped_6 + mgmt_rep_dropped_7 + mgmt_rep_dropped_8) as s1 , 
 sum(worker_rep_dropped_2 + worker_rep_dropped_3 + worker_rep_dropped_4 + worker_rep_dropped_5 + worker_rep_dropped_6 + worker_rep_dropped_7 + worker_rep_dropped_8) as s2 , mgmt_rep , worker_rep from table1 p
 
  group by  mgmt_rep , worker_rep