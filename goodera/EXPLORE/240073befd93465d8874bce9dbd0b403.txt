
with table1 as
(
select  p._id , projectId, p.name, ven.name as vendor, cou.name as country, nvl2(SUBSTRING(ven.name, 1, POSITION(' (' in ven.name)), SUBSTRING(ven.name, 1, POSITION(' (' in ven.name)), ven.name) as vendor_name, 
  case when vendor_name='' then vendor else vendor_name end as vendor_first_update, gen.name as gender , ag.name as age, work.name as working, mart_sta.name as marital_status, under.name as understand, post.name as poster_document, trai.name as training, vic.name as victim, wit.name as witness, p.opinions_harassment
from profile_65902 as p

left join ds_mysql_prod_tagelement ag 
on p.age = ag.id

left join ds_mysql_prod_tagelement gen 
on p.gender = gen.id

left join ds_mysql_prod_tagelement work 
on p.working = work.id

left join ds_mysql_prod_tagelement mart_sta 
on p.marital_status = mart_sta.id

left join ds_mysql_prod_tagelement under 
on p.understand = under.id

left join ds_mysql_prod_tagelement post 
on p.poster_document = post.id

left join ds_mysql_prod_tagelement trai 
on p.training = trai.id

left join ds_mysql_prod_tagelement vic 
on p.victim = vic.id

left join ds_mysql_prod_tagelement wit 
on p.witness = wit.id
  
left join ds_mysql_prod_project fac 
on p.projectId = fac.id

left join ds_mysql_prod_project ven 
on fac.parent = ven.id

left join ds_mysql_prod_project cou 
on ven.parent = cou.id
)
select * from table1