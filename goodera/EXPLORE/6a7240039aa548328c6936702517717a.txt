with t1 as
(
  select fy_timerange, services, projectid
  from profile_54243 as p
  ),
  t as
  (
	select t.*, ser from t1 t, t.services as ser
	),
  t2 as
  (
	select fy_timerange, count(*) as count_up, serv.name as services_updated, 
	proj.name as proj_up from t
	
	left join ds_mysql_prod_project as proj
	on projectid = proj.id
	
	left join ds_mysql_prod_tagelement as serv
	on t.ser = serv.id
	
	group by proj.name, services_updated, fy_timerange
	)
  select proj_up, services_updated, fy_timerange, count_up from t2

/*with t1 as
(
  select _id, projectId, fy_timerange, photo, remarks 
  from profile_74731 as p
  ),
  t as
  (
	select t.*, pho from t1 t, t.photo as pho
	),
	t2 as
	(select _id, fy_timerange, remarks, phot.name as photo_updated,
	 proj.name as proj_up from t
	
	left join ds_mysql_prod_project as proj
	on projectid = proj.id
	
	left join ds_mysql_prod_tagelement as phot
	on t.pho = phot.id
	 
	 group by _id, proj.name, photo_updated, fy_timerange, remarks
	 order by fy_timerange DESC
	 )
	 select _id, proj_up, photo_updated, fy_timerange, remarks from t2*/
