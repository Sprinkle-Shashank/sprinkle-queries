with table1 as 
(
select p.projectid , substring(createddate,1,10) as createddate_update_1 from profile_18299 as p ),

table2 as 
(
select p.projectid , substring(createddate,1,10) as createddate_update_2 , cast(createddate_update_2 as date) as g1 , t1.createddate_update_1 , datediff(day ,current_date ,g1) as f1  from profile_18224 as p

  left join table1 t1 on 
  p.projectid = t1.projectid 
)

select * from table2

 
  /*
  , datediff(day, CURRENT_DATE , createddate_update_1) as num 
  */