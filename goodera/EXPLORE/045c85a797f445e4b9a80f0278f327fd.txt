
with table1 as
( select p.projectid , p1.rating , rate.name as rating_average , count(rating_average) as rating_record_count
 from profile_16619 as p

left join profile_16864 p1
on p.projectid = p1.projectid

left join ds_mysql_prod_tagelement rate 
on p1.rating = rate.id

group by  p.projectid , p1.rating , rate.name ),

table2 as
(
  select p.projectid  , rate.name as rating_average  , count(p.projectid) as record_count  
 from profile_16619 as p

left join profile_16864 p1
on p.projectid = p1.projectid

left join ds_mysql_prod_tagelement rate 
on p1.rating = rate.id

group by  p.projectid , rate.name 
  ),
  
  table3 as
(
  select p.projectid , p._id , case when p.date is not null then 8 else 0 end as date_update , case when p.date_7 is not null then 8 else 0  end as date_update_7 , case when p.date_8 is not null then 8 else 0  end as date_update_8 ,  case when p.date_2 is not null then 4 else 0  end as date_update_2 , case when p.date_3 is not null then 4 else 0  end as date_update_3 , case when p.date_4 is not null then 4 else 0  end as date_update_4 , case when p.date_5 is not null then 4 else 0  end as date_update_5 , case when p.date_6 is not null then 4 else 0  end as date_update_6 , sum(date_update+date_update+date_update_2+date_update_3+date_update_4+date_update_5+date_update_6+date_update_7+date_update_8) as  Total_number_of_training_hours_completed
  
  from profile_16619 as p 
  
  group by p.projectid , p._id , date_update ,date_update_2 , date_update_3 , date_update_4 , date_update_5 , date_update_6 , date_update_7 , date_update_8
  ),
  
  table7 as
  ( select p.projectid , p._id , worker_rep , worker_rep_2 , worker_rep_3 , worker_rep_4 , worker_rep_5 , worker_rep_6 , worker_rep_7 , worker_rep_8 , mgmt_rep , mgmt_rep_2 , mgmt_rep_3 , mgmt_rep_4 , mgmt_rep_5 from profile_16619 as p )
  
  

select * from table7 

/*

profile_16619.data.date,   profile_16619.data.date_7,  profile_16619.data.date_8 is 8 and for others is 4. Check which dates are available and add training hours accordingly. Sum of those hours will be training hours


*/


50 + 