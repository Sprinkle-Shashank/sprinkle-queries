 -- profile 18224
with table7 as ( SELECT _id,projectid, mon.modifierid, m.email as memail
				
from ds_mongo_profileinstance mon
left join ds_mysql_prod_user u on
mon.creatorid = u.id
left join ds_mysql_prod_user m  on
mon.modifierid = m.id
where mon.profileId='18224' and mon.active = 't' and mon.securitycontextid is not null
),


table8 as
( select p.projectid , p._id , memail , row_number() over 
(partition by projectid
 order by _id desc) as row
 --, POSITION('@goodera.com' IN memail ) as p1 
 from table7 as p
 
-- where  p1=0
 ),
 
 table9 as 
 ( select * from table8 where row=1),
 
 
 -- profile 18299
 table70 as ( SELECT _id,projectid, mon.modifierid, m.email as memail			
from ds_mongo_profileinstance mon
left join ds_mysql_prod_user u on
mon.creatorid = u.id
left join ds_mysql_prod_user m  on
mon.modifierid = m.id
where mon.profileId='18299' and mon.active = 't' and mon.securitycontextid is not null
),


table80 as
( select p.projectid , p._id , memail , row_number() over 
(partition by projectid
 order by _id desc) as row
 --, POSITION('@goodera.com' IN memail ) as p1 
 from table7 as p
 
-- where  p1=0
 ),
 
 table90 as 
 ( select * from table8 where row=1),
 
 
  -- profile 20703
 table17 as ( SELECT _id,projectid, mon.modifierid, m.email as memail
from ds_mongo_profileinstance mon
left join ds_mysql_prod_user u on
mon.creatorid = u.id
left join ds_mysql_prod_user m  on
mon.modifierid = m.id
where mon.profileId='20703' and mon.active = 't' and mon.securitycontextid is not null
),


table18 as
( select p.projectid , p._id , memail , row_number() over 
(partition by projectid
 order by _id desc) as row
 --, POSITION('@goodera.com' IN memail ) as p1 
 from table7 as p
 
-- where  p1=0
 ),
 
 table19 as 
 ( select * from table8 where row=1),
 
 
  -- profile 20704
 table170 as ( SELECT _id,projectid, mon.modifierid, m.email as memail
from ds_mongo_profileinstance mon
left join ds_mysql_prod_user u on
mon.creatorid = u.id
left join ds_mysql_prod_user m  on
mon.modifierid = m.id
where mon.profileId='20704' and mon.active = 't' and mon.securitycontextid is not null
),


table180 as
( select p.projectid , p._id , memail , row_number() over 
(partition by projectid
 order by _id desc) as row
 --, POSITION('@goodera.com' IN memail ) as p1 
 from table7 as p
 
-- where  p1=0
 ),
 
 table190 as 
 ( select * from table8 where row=1)
 
 select * from table190
 