
with table1 as
( select p.projectid , p1.rating , rate.name as rating_average , count(rating_average) as rating_record_count
 from profile_16619 as p

left join profile_16864 p1
on p.projectid = p1.projectid

left join ds_mysql_prod_tagelement rate 
on p1.rating = rate.id

group by  p.projectid , p1.rating , rate.name ),

table2 as
(
  select p.projectid  , rate.name as rating_average  , count(p.projectid) as record_count
 from profile_16619 as p

left join profile_16864 p1
on p.projectid = p1.projectid

left join ds_mysql_prod_tagelement rate 
on p1.rating = rate.id

group by  p.projectid , rate.name 
  ),
  
  table3 as
(
  select p.projectid , p._id , case when p.date is not null then 8 else 0 end as date_update , case when p.date_7 is not null then 8 else 0  end as date_update_7 , case when p.date_8 is not null then 8 else 0  end as date_update_8 ,  case when p.date_2 is not null then 4 else 0  end as date_update_2 , case when p.date_3 is not null then 4 else 0  end as date_update_3 , case when p.date_4 is not null then 4 else 0  end as date_update_4 , case when p.date_5 is not null then 4 else 0  end as date_update_5 , case when p.date_6 is not null then 4 else 0  end as date_update_6 , sum(date_update+date_update_1+date_update_2+date_update_3+date_update_4+date_update_5+date_update_6+date_update_7+date_update_8) as  Total number of training hours completed
  
  from profile_16619 as p 
  )

select * from table3 

/*

profile_16619.data.date,   profile_16619.data.date_7,  profile_16619.data.date_8 is 8 and for others is 4. Check which dates are available and add training hours accordingly. Sum of those hours will be training hours


*/