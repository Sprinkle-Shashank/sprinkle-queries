with table1 as 
( select p.projectid , p._id , state_district from profile_46325 as p 
 ),
 
 table2 as
 ( select p.projectid , p._id, state_district , state_district_update from table1 as p , p.state_district as state_district_update ),
 
 table3 as 
 (
   select p.projectid , p._id , dis.name as distrcit , case when sta.name is null then dis.name else sta.name end as state_update , state_district_update from table2 as p
   
   left join ds_mysql_prod_tagelement dis
   on p.state_district_update  = dis.id
   
    left join ds_mysql_prod_tagelement sta
   on dis.parent  = sta.id
   )
  
 
 select * from table3