with test1 as(
select fy_timerange, projectid, name as batch_id, donor, donor_commitment from profile_196 where donor_commitment is not null
  union all
select fy_timerange, projectid, name as batch_id, donor, donor_commitment from profile_36904 where donor_commitment is not null
),

test2 as(
select p.fy_timerange, p.projectid, p.batch_id, p.donor, decode(i.name,null,h.name) as donor_commitment, decode(i.start,null,h.start) as start, decode(i.end,null,h.end) as donor_commitment from test1 p

left join profile_14715 i on
p.donor_commitment=i._id

left join profile_36980 h on
p.donor_commitment=h._id
)


select * from test2