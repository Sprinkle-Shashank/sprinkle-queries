with lookup as (select
				JSON_SERIALIZE(table_52810.pace_brands) as pace_brand,
				table_54646.name_country as country_name,
				projectId as project_id,
				table_54646.name as factory_name,
				table_54646.name_vendor_filter as vendor,
				table_54267.id as 54267_id,
				factory_vpid_1 as factory_vpid_1,
				factory_vpid_2 as factory_vpid_2,
				sourcing_yn as sourcing_yn,
				child_vendor_vpid as vendor_vpid
				
				case when pace_brand like '%1151834%' then 1 else 0 end  as brand
				--case when not table_54267 then pace_status_2 else table_54267.pace_status as paceStatus
				case when sourcing_yn is 57472 then factory_vpid_1 else factory_vpid_2 as factory_id
				
				from profile_52713 p
				
left join profile_52810 table_52810 on
table_52810.projectid=p.projectid
				
left join profile_4227 table_4227 on
table_4227.projectid=p.projectid
				
where paceStatus in 845114 or null or ""

left join profile_54267 table_54267 on
table_54267.projectid=p.projectid
											
left join profile_54646 table_54646 on
table_54646.projectid=p.projectid
				
--group by  country_name, table_52810.pace_brands,project_id,factory_name,vendor,54267_id,factory_vpid_1,factory_vpid_2,sourcing_yn,vendor_vpid,paceStatus,factory_id
			   )
select * from lookup p where brand = 1