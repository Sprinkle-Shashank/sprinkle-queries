select LISTAGG(UNIQUE name_rp, ',')  as rpname, (projid_rp) as rpid,
LISTAGG(UNIQUE projid_vendor,',') as vendorid, LISTAGG(projid_country,',') as countryid, LISTAGG(projcode_rp, ',') as rpcode, 		
(LISTAGG(projid_factory, ',')) as factorylist 

from profile_54646

where projid_rp is not null

group by projid_vendor, projid_country, projcode_rp, name_rp, 
--projid_factory,
projid_rp

order by rpname asc



