with t1 as
(select fy_timerange, tag1.name as gender, income_3months, income_12months, income_6months ,
case
when income_12months >0 then 'income_12months'
when income_6months >0 then 'income_6months'
else 'income_3months'
end as final_income
from profile_76022 p1
left join ds_mysql_prod_tagelement as tag1
on p1.gender = tag1.id
where final_income is not null)

select fy_timerange, tag1.name as gender, income_3months, income_12months, income_6months 

