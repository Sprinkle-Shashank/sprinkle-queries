/*with x as*/ Select t5.name as country,t1.xprojectid,t1.fy_timerange,t1.finperiod as financialperiod,t3.name as company_category,t1.keyword
from sus_21557 t1 
left join sus_46830 t2
on t1.xprojectid = t2.xprojectid
left join tagElement_6664 t3 on t3.id = t2.dataselect 
left join project_6664 t4 on t4.id = t1.xprojectid
left join project_6664 t5 on t5.id = t4.parent
where t1.keyword in ('heads_and_above_staff','asst_managers_and_above','executives_number', 'non_executives_number','age_analysis_2','recruitments')
and t1.xprojectid ilike '%%'
group by 1,2,3,4,5,6

/*y as (select xprojectid,finperiod,fy_timerange,keyword,name From sus_21557 as p where keyword='recruitments'),

z as (select xprojectid,keyword,fy_timerange,finperiod,cast(coun.name_employee_recruit as varchar),case when is_array (coun.title_recruit) = false or get_array_length(coun.title_recruit) = 0 then array(coun.title_recruit) else coun.title_recruit end as title_new From y as p, unpivot p.datatablebase as coun at abc)

select*/ 

