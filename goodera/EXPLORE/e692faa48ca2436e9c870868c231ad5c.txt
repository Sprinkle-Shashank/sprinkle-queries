Select tt.name as projectid ,fy_timerange ,(EXTRACT(YEAR FROM(CAST(fy_timerange.start AS datetime)))) as  year, t.name as category_of_waste ,nvl(tt1.name,t.name) as haz_nonhaz,extract(Month from cast(fy_timerange.start as datetime) )as Monthh,
case 
  when monthh=01 then 'January'
  when monthh=02 then 'February'
  when monthh=03 then 'March'
  when monthh=04 then 'April'
  when monthh=05 then 'May'
  when monthh=06 then 'June'
  when monthh=07 then 'July'
  when monthh=08 then 'August'
  when monthh=09 then 'September'
  when monthh=10 then 'October'
  when monthh=11 then 'November'
  when monthh=12 then 'December'
  end as month,
case 
	when tt1.name is null then t.name
	else t.name
	end as waste_type2, nvl(t4.name,t5.name)  as opertn_type,
 t1.name as waste_recovered_disposed ,t3.name as disposal_onsite_offsite, t5.name as recovery_onsite_offsite, sum(additional_cost) as additional_cost
from  profile_79255
left join ds_mysql_prod_project tt
on tt.id=projectid
left join ds_mysql_prod_tagelement t
on t.id=category_of_waste
left join ds_mysql_prod_tagelement tt1
on tt1.id=t.parent
left join ds_mysql_prod_tagelement t1
on t1.id=waste_recovered_disposed
left join ds_mysql_prod_tagelement t2
on t2.id=disposal_operation
left join ds_mysql_prod_tagelement t3
on t3.id=disposal_onsite_offsite

left join  ds_mysql_prod_tagelement t4
on t4.id=recovery_operation

left join ds_mysql_prod_tagelement t5
on t5.id=recovery_onsite_offsite

group by tt.name ,fy_timerange ,t.name ,tt1.name,t4.name,t1.name,t3.name ,t5.name

