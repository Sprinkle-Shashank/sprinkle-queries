with temp1 as
(select projectId, state_district, district, fy_timerange from profile_46325 as m,

m.state_district district),

temp2 as
(select projectId, state_district, district, fy_timerange
 from temp1
 left join ds_mysql_prod_tagelement as state1
on m.state_district = state1.id
 
left join ds_mysql_prod_tagelement as state1_parent
on state1.parent = state1_parent.id
 
WHERE state_district = '' OR state_district IS not NULL
 
 )
select * from temp2