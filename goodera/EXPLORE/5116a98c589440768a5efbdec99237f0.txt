with table1 as
( select p.projectid , fac.name as factory , ven.name as vendor , cou.name as country , p.name as Submission , p2.factory_id as Facility_id , aaditional_comments as add_comment , job.name as job_p , op.name as opport , know.name as knowled , rate.name as rating_update , sta.name as status_update ,
 
 case when status_update is null and p3.date_enrollment is not null and p3.date_completion is null then 'ongoing' when status_update is null and p3.date_enrollment is not null and p3.date_completion is not null then 'completed' else  status_update end as wcp_status
 
 , p4.vpid as vendor_id , sub.name as sub_unit_update
 
 from profile_16864 as p
 
   
left join ds_mysql_prod_project fac
on p.projectid = fac.id
 
left join ds_mysql_prod_project ven
on fac.parent = ven.id
 
left join ds_mysql_prod_project cou
on ven.parent = cou.id
 
left join ds_mysql_prod_tagelement job
on p.job_part = job.id
 
left join ds_mysql_prod_tagelement op
on p.opportunities = op.id
 
left join ds_mysql_prod_tagelement know
on p.knowledge = know.id
 
left join ds_mysql_prod_tagelement rate
on p.rating = rate.id
 
left join profile_4722 p2 
on p.projectid = p2.projectid 
 
left join profile_16619 p3 
on p.projectid = p3.projectid 
 
left join ds_mysql_prod_tagelement sta
on p3.status = sta.id
 
 left join ds_mysql_prod_tagelement sub
on p3.sub_unit = sub.id

left join profile_4718 p4
on p.projectid = p4.projectid 
 
 where cou.id != 13761 
)

select * from table1