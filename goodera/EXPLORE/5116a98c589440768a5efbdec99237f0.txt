select t.*,loc.name as location_name,decode(sta.name,null,loc.name,sta.name) as state_1,reftag.name as code
from profile_55622 t

left join ds_mysql_prod_tagelement loc
on t.location=loc.id

left join ds_mysql_prod_tagelement sta
on loc.parent=sta.id

left join ds_mysql_prod_tagelement reftag
on sta.parent = reftag.id

--where code is not null


