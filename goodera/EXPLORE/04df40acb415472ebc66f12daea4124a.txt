select p2.name as partner,p1.name as projectid, p.fy_timerange,t1.name as district, t2.name as state,p.higher_management,p.process_training,count(*) 
from profile_81361 p

left join ds_mysql_prod_project p1 on p1.id = p.projectid
left join ds_mysql_prod_project p2 on p2.id = p1.parent

left join ds_mysql_prod_tagelement t1 on t1.id=p.state_district
left join ds_mysql_prod_tagelement t2 on t2.id=t1.parent

group by p2.name ,p1.name as , p.fy_timerange,t1.name, t2.name ,p.higher_management,p.process_training