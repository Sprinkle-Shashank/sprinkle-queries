with sub1 as(
select a.projectId, a.photo, a.visit_type, a.destination, a.activity_type, a.awareness_type, a.shelter_home_text, a.number_ben_child, a.days_visit, a.awareness_hours, a.date as fy_timerange, b.location from profile_79960 a
left join profile_79953 b on b.name=a.shelter_home_text )
select a.projectId, a.photo, a.destination, a.activity_type, a.awareness_type, a.shelter_home_text, a.number_ben_child, a.days_visit, a.awareness_hours, a.fy_timerange, a.location, substring(a.fy_timerange,1,10),
case when a.visit_type is NULL then '-' else a.visit_type end as visit_type
from sub1 a