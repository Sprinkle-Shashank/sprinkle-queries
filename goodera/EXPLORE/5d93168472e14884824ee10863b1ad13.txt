select  p2.name as projectId, p1.fy_timerange, max(p1.date) as date,p3.name as partner,
mid(p1.date,9,2) || "-" || mid(p1.date,6,2) ||"-" || mid(p1.date,1,4) as date1 
from profile_74914 p1
left join ds_mysql_prod_project p2
on p2.id = p1.projectId
left join ds_mysql_prod_project p3
on p3.id = p2.parent
left join ds_mysql_prod_project p4
on p4.id = p3.parent
group by fy_timerange, projectId, partner,p2.name