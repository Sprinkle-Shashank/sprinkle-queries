select p._id, age, createddate,SUBSTRING(p3.name,1,CHARINDEX('-',p3.name)),p4.name,  DATEDIFF(year,createddate,GETDATE())+age as final_age from profile_58473 p
left join profile_58474 p2
on p._id=p2.patient
left join ds_mysql_prod_tagelement p3
on p2.diagnosis1=p3.id
left join ds_mysql_prod_tagelement p4
on p2.diagnosis2=p4.id
group by p3.name,p4.name,p.createddate,p._id,p.age


/*select p2.name,p3.name from profile_58474 p
left join ds_mysql_prod_tagelement p2
on p.diagnosis1=p2.id
left join ds_mysql_prod_tagelement p3
on p.diagnosis2=p3.id
LEFT JOIN Profile_*/


