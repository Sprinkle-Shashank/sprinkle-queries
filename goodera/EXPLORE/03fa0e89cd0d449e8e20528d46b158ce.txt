Select s.projectId, s.milestone,any_value(s.date), s.status, any_value(s.comments),any_value(ss.start_date), ss.timerange_timerange, ss.completion_date,
any_value(case
  when s.status=553742 then 'Completed'
  when s.status=553742 then 
    case 
       when s.date>s.completion_date then 'Delayed'
       else 'Ongoing'
    end
  when s.status=553740  then
      case
		  when s.date>s.start_date then 'Delayed'
          else 'Yet_to_Initiate'
      end
 else
 'N/A'
 end )as Status_New

from profile_77917 s

left join profile_77916 ss
on ss._id=s.milestone

group by  s.milestone, ss.timerange_timerange,s.projectId,s.status
order by s.date,ss.timerange_timerange desc



