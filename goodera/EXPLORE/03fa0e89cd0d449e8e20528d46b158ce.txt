Select t.name as projectId, ss.name as milestone ,any_value(s.date) as fy_timerange,t1.name as status, any_value(s.comments) as comments ,any_value(ss.start_date) as start_date, ss.timerange_timerange, ss.completion_date,
any_value(case
  when s.status=553742 then 'Completed'
  when s.status=553741 then 
    case 
       when s.date>s.completion_date then 'Delayed'
       else 'Ongoing'
    end
  when s.status=553740  then
      case
		  when s.date>s.start_date then 'Delayed'
          else 'Yet_to_Initiate'
      end
 else
 'N/A'
 end )as Status_New

from profile_77917 s

left join profile_77916 ss
on ss._id=s.milestone
left join ds_mysql_prod_project t
on t.id=s.projectId
left join ds_mysql_prod_tagelement t1
on t1.id=s.status

group by  ss.name, ss.timerange_timerange,ss.completion_date,s.date,t.name,t1.name
order by s.date,ss.timerange_timerange desc




