select p.projectId, p.batch_id, concat(cast(p.fy_timerange.start as varchar), concat('|', cast(p.fy_timerange.end as varchar))) as fy_timerange1, m.name as placed ,z.name as donor, h.donor_commitment,t2.name as Project, count(*) as count
from profile_36901 p

left join profile_36904 h on
p.batch_id=h._id	

left join ds_mysql_prod_tagelement z on
h.donor=z.id

left join ds_mysql_prod_tagelement m on
p.placed=m.id
	
LEFT JOIN ds_mysql_prod_project t on p.projectId=t.id
LEFT JOIN ds_mysql_prod_project t1 on t.parent=t1.id
LEFT JOIN ds_mysql_prod_project t2 on t1.parent=t2.id
where h.donor is not null

group by m.name, z.name, donor_commitment, fy_timerange1, project,p.projectId,p.batch_id





