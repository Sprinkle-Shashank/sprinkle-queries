select count(uid)as val,b.name as batch_year, start_date as batch_start_date, c.name as course_name,a.fy_timerange,
end_date  as batch_end_date,count(*)

from  profile_79247 a
 left join ds_mysql_prod_tagelement b on a.batch_id=b.id
 left join ds_mysql_prod_tagelement c on a.course_name=c.id
 
 
where a.end_date is not null 
group by cb.name, start_date  ,c.name,a.fy_timerange,
end_date