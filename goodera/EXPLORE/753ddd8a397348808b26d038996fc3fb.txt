select cou.name as country, yr.name as year,
SUBSTRING(ven.name, 1, POSITION(' (' in ven.name)) as vendor_name,
nvl2(vendor_name, vendor_name, ven.name) as vendor
from profile_60670 p


left join ds_mysql_prod_project fac
on p.projectid = fac.id
left join ds_mysql_prod_project ven
on fac.parent = ven.id
left join ds_mysql_prod_project cou
on ven.parent = cou.id

left join ds_mysql_prod_tagelement yr
on p.start_year = yr.id

where p.status = 1159910 and p.survey_yn = 57472
group by projectId, service_provider, status, brand, year_timerange, other_status, features, survey_yn, start_year, notes, contact_gap, other_features, keyword_1, country, year, vendor_name, vendor