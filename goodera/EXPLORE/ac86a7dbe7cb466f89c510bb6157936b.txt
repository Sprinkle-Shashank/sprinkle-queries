with table1 as
( select p.projectid , p._id , p.fy_timerange , start_date , cast(start_date as date) as start_update,  sta.name as state , cen.name as center , p.name , course.name as course_name_update , bat.name as batch_name , concat(concat(course_name_update, ' '), cast(batch_name as varchar)) as batch_value , target_hours , 1 as acheived_hours , 'OJT' as Status , (target_hours/5) as days_to_add from profile_81438 as p

left join ds_mysql_prod_tagelement cen
on p.center_name = cen.id

left join ds_mysql_prod_tagelement course
on p.course_name = course.id

left join ds_mysql_prod_tagelement bat
on p.batch = bat.id

left join profile_81436 p1 
on p.center = p1._id

left join ds_mysql_prod_tagelement sta
on p1.center_loc = sta.id),

table2 as 
( select p.projectid , p1.name , count(date_holiday) as count  from profile_81611 as p

left join profile_81438 p1 
on p.batch = p1._id

group by p.projectid , p1.name),

table3 as 
(
  select p.*, (days_to_add+5) as final_count, dateadd(day,final_count,start_update) as end_1 , datediff(week,start_date,end1) from table1 as p
  ---p1.count 
  
  left join table2 p1
  on p.name = p1.name
  )

select * from table3


---  , dateadd(day,days_to_add,start_update) as end_1