with temp as
(
select fy_timerange, cou.name as country, ben.name as beneficiary,
sum(beneficiary_reach) as ben_reach
from profile_64651 t1
left join ds_mysql_prod_tagelement cou
on t1.country = cou.id
left join ds_mysql_prod_tagelement ben
on t1.beneficiary = ben.id
where ben.name is not null
group by fy_timerange, cou.name, ben.name
)
select fy_timerange,country,t1.target_reach,ben.name as beneficiary
from temp
left join profile_64654 t1
on country = t1.country
left join ds_mysql_prod_tagelement ben
on t1.beneficiary = ben.id