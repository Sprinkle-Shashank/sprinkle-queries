with x as (select datatablebase,fy_timerange,keyword,name From sus_21557 as p where keyword='recruitments'),

y as (select fy_timerange,name,cast(coun.name_employee_recruit as varchar),case when is_array (coun.title_recruit) = false or get_array_length(coun.title_recruit) = 0 then array(coun.title_recruit) else coun.title_recruit end as title_new From x as p, unpivot p.datatablebase as coun at abc)

select t2.*,t from y as t2 ,t2.title_new as t 





