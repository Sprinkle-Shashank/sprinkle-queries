with temp1 AS
(select m._id AS old_id, m.projectId, m.indicator, sdgs.name AS sdgs, m.schedule_vii, m.proj,  m.baseline, m.target, r._id, r.project_name, r.vertical, r.focus, r.direct_or_partner, r.project_code, r.entity, partner.name AS partner_1, q.fy_timerange, q.progress, ben_type.name AS ben_type, state_1.name AS state, int_indi.name AS indicator_1, l.name as name
 
from profile_61044 AS m

left join profile_62881 AS r 
 on m.proj = r._id
 
left join ds_mysql_prod_tagelement as partner
  on r.direct_or_partner = partner.id
  
left join profile_61046 AS q 
 on m._id = q.indicator
 
left join ds_mysql_prod_tagelement as ind
  on m.indicator = ind.id
 
left join ds_mysql_prod_tagelement as int_indi
  on ind.parent = int_indi.id
 
left join ds_mysql_prod_tagelement as ben_type
  on m.ben_type = ben_type.id

left join ds_mysql_prod_tagelement as state_1
  on r.state = state_1.id
 
left join profile_64961 AS l 
 on state_1.name = l.state
 
left join ds_mysql_prod_tagelement as sdgs
  on m.sdgs = sdgs.id
 
where r.direct_or_partner = 1132991 AND m.ben_type = 939857 AND q.fy_timerange IS NOT NULL AND m.sdgs IS NOT NULL),

temp2 as
(select p.*, vertical_new from temp1 as p, p.vertical as vertical_new)

select projectid.name AS projectid, sdgs.name AS sdgs, schedule_vii.name AS schedule_vii, p.project_name, p.baseline, p.target, vertical.name AS vertical, focus.name AS focus, state, entity.name AS entity, p.partner_1, p.fy_timerange, SUM(p.progress) AS beneficiary, p.name ,  case 
when vert1.name IS NULL AND vert.name IS NOT NULL THEN vert.name
else vert1.name 
END AS vertical  from temp2 as p 


left join ds_mysql_prod_tagelement as vert
  on p.vertical_new = vert.id
  
left join ds_mysql_prod_tagelement as vert1
  on vert.parent = vert1.id
  
left join ds_mysql_prod_tagelement as focus
  on p.focus = focus.id

left join ds_mysql_prod_tagelement as entity
  on p.entity = entity.id
  
left join ds_mysql_prod_tagelement as projectid
  on p.projectid = projectid.id
  
left join ds_mysql_prod_tagelement as sdgs
  on p.sdgs = sdgs.id
  
left join ds_mysql_prod_tagelement as schedule_vii
  on p.schedule_vii = schedule_vii.id
  
group by projectid.name, sdgs.name, schedule_vii.name, vertical.name, focus.name, state, p.fy_timerange, entity.name, p.project_name, p.baseline, p.target, p.name, p.partner_1, vert.name , vert1.name 

Order by sdgs.name ASC