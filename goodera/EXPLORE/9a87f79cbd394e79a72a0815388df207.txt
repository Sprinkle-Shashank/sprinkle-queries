with sub3 as(
  select r2.id, t2.name as focus_area, p6.name as country, p6.map_code, 
cast(r2.start_date as date) as participation_date,
(cast(r2.start_date as date)||'|'||cast(r2.start_date as date)) as fy_timerange,
r2.hours as vol_hours, r2.hours*p7.vol_conversion_factor as volunteering_cost,
extract(year from cast(r2.start_date as date)) as year_check,
('FY'||' '||extract(year from cast(r2.start_date as date))) as x_axis2, 
cast('Volunteering' as varchar) as x_axis,
cast('Reckitt Global' as varchar) as prod_brand,
	case
  		when(year_check = extract(year from current_date)) then 'Current year'
  		when(year_check = extract(year from current_date)-1) then 'Previous year'
  	else 'Not Applicable'
  	end as year_status
from rb_loghours r2
left join profile_78929 p5 on UPPER(p5.vol_focus_area_full) = UPPER(r2.focus_area)
left join ds_mysql_prod_tagelement t2 on t2.id = p5.focus_area
left join profile_78788 p6 on p6.vol_country = r2.country
left join profile_78933 p7 on p7.name = extract(year from cast(r2.start_date as date))
where year_check > 2017 and year_check < 2026)

select * from sub3