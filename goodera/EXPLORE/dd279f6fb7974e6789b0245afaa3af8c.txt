select p1._id, p1.end_date_2, extract(year from cast(p1.fy_timerange.start as date)) as start_year, p1.start_date, p2.offset_date, p1.project_name, p3.region, p1.select_modules, p1.program_type, p1.num_females_graduated, p1.num_females
from profile_62491 p1
left join profile_62948 p2 on p2.project_id = p1.project_id
left join profile_60928 p3 on p2.pvh_id = p3.factory_id
where start_year >= 2020  and p2.pvh_id is not NULL and COALESCE(lg_status,0)!=1105812 and p1.start_date>=nvl(p2.offset_date,'2020-02-01T00:00:00.000+00:00')
group by p1._id, p1.end_date_2, start_year, p1.start_date, p2.offset_date, p1.project_name, p1.fy_timerange, p3.region, p1.select_modules, p1.program_type, p1.num_females_graduated, p1.num_females