with sub1 as(
  select p1._id as id, p1.taskuserid, t1.submissionlog, t1.active
from profile_78057 p1
left join ds_mongo_taskResponse t1 on t1.taskuserid = p1.taskuserid
where t1.submissionlog is not null),

sub2 as(
  select s1.*, log from sub1 s1, s1.submissionlog log)
  
select s2.id, s2.taskuserid, cast(s2.log.email as varchar) as email
from sub2 s2
group by s2.id, s2.taskuserid, s2.log.email