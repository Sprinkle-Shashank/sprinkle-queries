with sub1 as(
  select p1._id as p3id, p1.creatorid, t1.submissionlog, p1.fy_timerange, p1.country, p1.product_brand, p1.other_brands_involved, p1.activity, p1.activity_description, p1.partner, p1.business_units, p1.focus_area, p1.focus_area_other, p1.currency, p1.direct_cash, p1.direct_cash_donations, p1.product_donation, p1.value_of_reckitt_products, p1.brand_of_prods_donated, p1.product_description, p1.no_of_reckitt_prods_donated, p1.sold_destroyed, p1.estimate_cost, p1.emp_volunteering, p1.total_amount_donated_payroll, p1.supplier_contribution, p1.no_of_individuals_directly_engaged, p1.people_engaged_explanation, p1.measure_outcome, p1.no_of_individuals_better_knowledge, p1.no_of_individuals_behaviour_changed, p1.no_of_individuals_reporting_improvement, p1.charity_measured_outcome, p1.outcome_evidence, p1.photos_reports, p1.sequence
from profile_78057 p1
left join ds_mongo_taskResponse t1 on t1.creatorid = p1.creatorid),

sub2 as(
  select s1.*, log from sub1 s1, s1.submissionlog log)
  
select s2.p3id, s2.sequence, s2.log.email as user_email, t1.name as country, t2.name as product_brand, s2.other_brands_involved as other_brand, s2.activity, s2.activity_description, s2.partner
extract(month from cast(s2.fy_timerange.start as date)) as start_month, 
extract(year from cast(s2.fy_timerange.start as date)) as start_year, 
extract(month from cast(s2.fy_timerange.end as date)) as end_month, 
extract(year from cast(s2.fy_timerange.end as date)) as end_year, 