select p1._id as id, p1.project_name, t2.name as program_type, p1.fy_timerange, cast(p1.fy_timerange.start as date) as start_date_new, p1.score, 

case
	when t1.name like '%.%' then substring(t1.name, 3, LEN(t1.name)-2)
	else t1.name
end as module_name

from profile_62486 p1
left join ds_mysql_prod_tagelement t1 on t1.id = p1.module_name
left join ds_mysql_prod_tagelement t2 on t2.id = t1.parent

where extract(year from start_date_new) >= 2020 and p1.score is not null