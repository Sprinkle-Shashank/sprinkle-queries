with sub1 as(
  select p1.creatorid, t1.submissionlog, p1.other_brand, is_array(p1.other_brand) as array_check,
case
  when array_check = false then array(p1.other_brand)
  else p1.other_brand
end as other_brand_new
from profile_78057 p1
left join ds_mongo_taskResponse t1 on t1.creatorid = p1.creatorid
where p1.other_brand is not null),

sub2 as(
  select s1.*, log, other_brand_2 from sub1 s1, s1.submissionlog log, s1.other_brand_new other_brand_2)
  
select s2.other_brand_2, s2.log.email from sub2 s2
group by s2.other_brand_2, s2.log.email