select p.year_timerange, p.year, p.num_males , p.num_female ,  p.num_total,
ven.name as vendor, 
p.projectId, 
CASE when cou.name is null then fac.name else cou.name end as country, p.name  
from profile_61693 p

left join ds_mysql_prod_project fac
on  p.projectid = fac.id
left join ds_mysql_prod_project ven
on fac.parent = ven.id
left join ds_mysql_prod_project cou
on ven.parent = cou.id

Group By p.year_timerange, year, p.num_males, p.num_female, p.num_total,ven.name, p.projectId, country,vendors,p.name