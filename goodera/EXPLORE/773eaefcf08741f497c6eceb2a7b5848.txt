with table1 as (Select * from profile_77047),
table2 as(
Select case when table1.projectId is not null
  then 'Estimated number of people empowered to improve their access to drinking water and sanitation'
  else
  'NA' 
  end as "Key Performance Indicators",Sum(prog_target) as "Program Target" 

				
from table1
  
 where indicator = 1520878 or indicator = 1520806
  group by "Key Performance Indicators"
),
table4 as(Select Case when profile_58414.projectId is not null 
		  then 'Estimated number of people empowered to improve their access to drinking water and sanitation'   else 
'NA'
		  end as "Key Performance Indicators",Sum(total_people) as "Progress Till Date"
		  
from profile_58414
group by "Key Performance Indicators"
),
table3 as(Select CASE when profile_26656.projectId is not null
		  then 'Estimated number of people empowered to improve their access to drinking water and sanitation'  else
'NA'
		  end as "Key Performance Indicators",Sum(total_people) as "Progress Till Date"
		  
from profile_26656
group by "Key Performance Indicators"

),
table5 as(Select * from table3
		  Union All
		  select * from table4
		  ),
table6 as(Select "Key Performance Indicators",Sum("Progress Till Date") AS "Progress Till Date" from table5

Group BY "Key Performance Indicators"
		  )
Select * ,t6."Progress Till Date" from table2
/*left join table6 as t6 
on table2."Key Performance Indicators" = t6."Key Performance Indicators"
Select 'Estimated number of people empowered to improve their access to drinking water and sanitation' as "Key Performance Indicators",Sum(total_people) as "Progress Till Date1",table4."Progress Till Date2",Sum("Progress Till Date1","Progress Till Date2") as "Progress Till Date" from table3
left join table4 on
table3."Key Performance Indicators" = table4."Key Performance Indicators"*/	  


