select profile_4227.projectId, name_country, cast(concat('FY ' ,start_year) as varchar) as start_year ,case when start_quarter=1 then '1st (Feb-Apr)'
 when start_quarter=2 then '2nd (May-Jul)'
  when start_quarter=3 then '3rd (Aug-Oct)'
   when start_quarter=4 then '4th (Nov-Jan)'
   else null end as start_quarter, num_females, lg_status, profile_54646.name_vendor, profile_54646.name_vendor_filter, profile_54646.name_rp as regional_partner,profile_54646.name_factory as locations, profile_54646.projcode_factory as codes, mdl_parent.name as module

from profile_4227
   
left join profile_54646 on 
profile_4227.projectId = profile_54646.projectId

left join profile_4228 on 
profile_4228.class= profile_4227._id

left join ds_mysql_prod_tagelement md_nme
on profile_4228.module_name = md_nme.id

left join ds_mysql_prod_tagelement mdl_parent
on md_nme.parent = mdl_parent.id

where coalesce(lg_status, 0) <> 848008 and  codes like 'CP%' and module in ('Academic','Community','Leadership','Vocational School','Younger Girls','Older Girls')
 
 group by profile_4227.projectId, name_country, start_year ,start_quarter, num_females, lg_status, profile_54646.name_vendor, profile_54646.name_vendor_filter, regional_partner, locations, codes, module
 
 --start_quarter is not null and start_year is not null and