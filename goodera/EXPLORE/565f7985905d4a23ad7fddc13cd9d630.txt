Select p.fac_vpid,f_y.name as fy,mth.name as month,p.facility_score,profile_54646.name_country as country,profile_54646.name_vendor as partner,profile_54646.name_vendor_filter as partner_consolidated,
profile_52713.factory_vpid_1,status.name as pace_status,src.name as sourcing_yn,count(*) from profile_54267 p



left join profile_52713 on 
p.projectId= profile_52713.projectId

left join profile_54646 on 
p.projectId= profile_54646.projectId
left join ds_mysql_prod_tagelement f_y
on p.fy = f_y.id
left join ds_mysql_prod_tagelement mth
on p.month = mth.id
left join ds_mysql_prod_tagelement status
on p.pace_status = status.id
left join ds_mysql_prod_tagelement src
on profile_52713.sourcing_yn = src.id

where pace_status = 845114 and sourcing_yn = 57472 and
      fy = (select max(fy) from profile_54267)
 

group by p.fac_vpid,f_y.name ,mth.name ,
profile_52713.factory_vpid_1,status.name ,src.name,p.facility_score,profile_54646.name_country,profile_54646.name_vendor,profile_54646.name_vendor_filter