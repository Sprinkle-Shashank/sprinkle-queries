--GSKConsumer_Common_ActivityTimeline
with t1 as (
Select proj.name as project_name ,p.fy_timerange,act.name as category,act1.name as subcategory,p.plan_start,p.plan_end,p.act_start,p.act_end,milestone_date
from profile_83783 p

left join ds_mysql_prod_project as pro
on p.projectid = pro.id
  
LEFT JOIN ds_mysql_prod_tagelement act
on p.category = act.id

LEFT JOIN ds_mysql_prod_tagelement act1
on p.subcategory = act1.id

LEFT JOIN ds_mysql_prod_project AS proj
on p.projectid = proj.id

  ),
  t2 as (
select *,datediff(day,act_start,act_end) as act_dur,
	datediff(day,plan_start,plan_end) as plan_dur,
	trunc(act_start) as d,trunc(plan_start) as d1
	
	
	
	from t1
	     )
  
select * from t2  