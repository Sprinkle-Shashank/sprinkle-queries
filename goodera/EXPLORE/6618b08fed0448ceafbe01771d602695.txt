with sub1 as(
select ss.projectId as proj_location, p1.name as projectId,activity_title,fy_timerange, activity_pic,activity_type, ss.name, p2.name as partner
from profile_79270 ss
left join ds_mysql_prod_project p
on ss.projectId=p.id
left join ds_mysql_prod_project p1
on p.parent=p1.id
left join ds_mysql_prod_project p2
on p1.parent=p2.id)
,
sub2 as(
  select proj_location, s1.projectId, activity_title,fy_timerange, activity_pic,activity_type, ss.name, p2.name as partner, location
  from sub1 s1 )

  select proj_location, s1.projectId, activity_title,fy_timerange,activity_type, ss.name, p2.name as partner, location, cast(ph as varchar)activity_pic from sub2 s2, s2.activity_pic ph
  --select * from sub1