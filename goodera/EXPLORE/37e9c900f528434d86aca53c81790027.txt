with sub1 as(
  select p1.*, 
  case
		when is_array(p1.upload) = false or get_array_length(p1.upload) = 0 then array(p1.upload)
  		else p1.upload
  end as upload_new
from profile_73151 p1),

sub2 as(
  select s1.*, photos, uploads
  from sub1 s1, s1.photo photos, s1.upload uploads)
  
--select p3.name as partner, p2.name as projectid, (s1.date || '|' || s1.date) as fy_timerange, s1.title, s1.
select * from sub1