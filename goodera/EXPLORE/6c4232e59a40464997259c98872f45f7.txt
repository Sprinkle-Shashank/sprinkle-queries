 with t1 as(select tag1.name as father_occupation, name_of_the_student, tag2.name as mother_occupation, class, financial_year_timerange as fy_timerange ,
case 
when tag2.name  = 'Housewife'  then 0
else 1
end as Mother_earns,
case
when tag1.name = 'Unemployed' then 0
else 1
end as Father_earns
from profile_77353  p1
left join ds_mysql_prod_tagelement tag1
on p1.father_occupation = tag1.id
left join ds_mysql_prod_tagelement tag2
on p1.mother_occupation = tag2.id)

select name_of_the_student,fy_timerange,class,father_occupation,mother_occupation,Mother_earns
,Father_earns,
case
when Father_earns=1 and Mother_earns =1 then 'Both'
when Mother_earns =1 then 'Mother Only'
when Father_earns =1 then 'Father Only'
else 'Neither'
end as No_of_wage_earner
from t1

