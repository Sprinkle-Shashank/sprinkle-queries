with table1 as
(
select diagnosis.name from profile_58474 p
left join ds_mysql_prod_tagelement diagnosis
on p.diagnosis1 = diagnosis.id
 ),
 
 
 table2 as
(
  select diagnosis.name from profile_58474 p
  left join ds_mysql_prod_tagelement diagnosis
  on p.diagnosis2 = diagnosis.id
  
 ),
 table3 as
 (
 select * from table1
 union
 select * from table2
   )
  
   select nvl2(SUBSTRING(t.name, 1, POSITION(' -' in t.name)), SUBSTRING(t.name, 1, POSITION(' -' in t.name)),t.name) as diagnosis, case when diagnosis='' then t.name else diagnosis end as disease from table3 t
  