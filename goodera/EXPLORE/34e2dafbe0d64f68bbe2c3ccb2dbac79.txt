with table1 as(select p.projectId,representative.name as mr_wr,count(mr_wr) as total from profile_18224 p

left join ds_mysql_prod_tagelement representative
on p.mr_wr = representative.id

group by p.projectId,representative.name
),
table2 as(select p.projectId,t1.total as 'MR' from profile_18224 p

left join table1 t1 on
p.projectId = t1.projectId
		  
where  representative.name ilike '%Management Representative%'
)	

Select * from table2





