
with table1 as(SELECT * 
FROM (SELECT projectId,representative.name as mr_wr,count(mr_wr ) as total 
	  
	  from profile_18224 p
	  
	  
left join ds_mysql_prod_tagelement representative
on p.mr_wr = representative.id
	 group by projectId,representative.name)

PIVOT (
    SUM(total) FOR representative.name IN ('Management Representative','Worker Representative','Not Answered' )

  
),
table2 as( select 'Management Representative','Worker Representative','Not Answered', ('Management Representative'+'Worker Representative'+'Not Answered') as total_sum,('Management Representative'/total_sum)*100 as percent_mgmt,('Worker Representative'/total_sum)*100 as percent_worker,('Not Answered'/total_sum)*100 as percent_not_answer from table1
		  )
			   select * from table2










