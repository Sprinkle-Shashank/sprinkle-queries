
with table1 as(SELECT * 
FROM (SELECT projectId,mr_wr,count(mr_wr ) as total 
	  
	  from profile_18224 p
	  
	  

	 group by projectId,mr_wr)

PIVOT (
    SUM(total) FOR mr_wr IN (338513,338514,493548 )
)
),
table2 as(select 338513 as "Management Representative",338514 as "Worker Representative",493548 as "Not Answered", "Management Representative"+"Worker Representative"+"Not Answered" as total_sum/*('Management Representative'/total_sum)*100 as percent_mgmt,('Worker Representative'/total_sum)*100 as percent_worker,('Not Answered'/total_sum)*100 as percent_not_answer*/ from table1
		  )
select * from table2











