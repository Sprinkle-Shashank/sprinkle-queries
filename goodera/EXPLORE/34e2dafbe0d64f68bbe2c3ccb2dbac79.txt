with table1 as(select p.projectId,representative.name as mr_wr from profile_18224 p
			   
			   left join ds_mysql_prod_tagelement representative
on p.mr_wr = representative.id
),
table2 as(SELECT * 
FROM (SELECT projectId,mr_wr,count(mr_wr ) as total 
	  
	  from table1 
	  
	  

	 group by projectId,mr_wr)

PIVOT (
    SUM(total) FOR mr_wr IN ('Management Representative' as m_r,'Worker Representative' as w_r,'Not Answered' as n_a)
)
),
table3 as(select m_r,w_r,decode(n_a,null,0,n_a) as n_a,  n_a as total_sum from table2
		  /*('Management Representative'/total_sum)*100 as percent_mgmt,('Worker Representative'/total_sum)*100 as percent_worker,('Not Answered'/total_sum)*100 as percent_not_answer*/
)	  
select * from table3











