with table1 as(select p.projectId,representative.name as mr_wr,count(mr_wr) as total from profile_18224 p

left join ds_mysql_prod_tagelement representative
on p.mr_wr = representative.id

group by p.projectId,representative.name
),
table2 as(select p.projectId,t1.total as M_R from table1 t1

left join profile_18224 p on
t1.projectId = p.projectId
		  
where  t1.mr_wr ilike '%Management Representative%'
),
table3 as(select p.projectId,t1.total as W_R from table1 t1

left join profile_18224 p on
t1.projectId = p.projectId
		  
where  t1.mr_wr ilike '%Worker Representative%'
),
table4 as(select p.projectId,t1.total as N_A from table1 t1

left join profile_18224 p on
t1.projectId = p.projectId

		  
where  t1.mr_wr ilike '%Not Answered%'
),
table5 as(select t1.projectId,sum(t4.N_A),sum(t3.W_R),sum(t2.M_R),(t4.N_A+t3.W_R+t2.M_R) as total_sum  from table1 t1
		  
left join table2 t2 on
t2.projectId = t1.projectId
left join table3 t3 on
t3.projectId = t1.projectId
left join table4 t4 on
t4.projectId = t1.projectId	
group by t1.projectId
)
select * from table5








