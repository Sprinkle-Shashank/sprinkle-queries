with temp1 as
( select projectId.name as projectId, act1.name as activity_subactivity, planned_start_date :: date, planned_end_date :: date, actual_start_date :: date, actual_end_date :: date, delay_reason, to_char(planned_start_date, 'DD-MM-YYYY') as ps1, to_char(planned_end_date, 'DD-MM-YYYY') as ps2, ps1 || ' to ' || ps2 as proposed_duration, to_char(actual_start_date, 'DD-MM-YYYY') as actual_start_date, to_char(actual_end_date, 'DD-MM-YYYY') as actual_end_date 
 
from profile_77680 as m
 
left join ds_mysql_prod_project as projectId
on m.projectId = projectId.id 
left join ds_mysql_prod_tagelement as act1
on m.activity_subactivity = act1.id
),
temp2 as
(select *,
case
when actual_end_date = '' then 'yet to complete')

 select * from temp2