SELECT prod.name projectId, timerange_timerange, t.name as month,count(*) number_of_batches
FROM profile_3863
left join ds_mysql_prod_project prod
on prod.id=projectId
left join ds_mysql_prod_tagelement t
on t.id=month_end
WHERE t.name IS NOT NULL
GROUP BY prod.name, timerange_timerange,t.name