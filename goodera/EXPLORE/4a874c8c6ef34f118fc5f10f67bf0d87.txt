with t1 as
(select * from
(
  select projectId.name as projectid, planned_doi, planned_doc, planned_signoff, planned_live, fy_timerange, actual_doi, actual_doc, actual_signoff, actual_live,
  
  case when actual_doi IS NULL then 'Not available'
  when planned_doi<=actual_doi then 'Completed'
  when planned_doi>actual_doi then 'Delayed'
  else 'Ongoing'
  end as doi_status,
  
  case when actual_doc IS NULL then 'Not available'
  when planned_doc<=actual_doc then 'Completed'
  when planned_doc>actual_doc then 'Delayed'
  else 'Ongoing'
  end as doc_status,
  
  case when actual_signoff IS NULL then 'Not available'
  when planned_signoff<=actual_signoff then 'Completed'
  when planned_signoff>actual_signoff then 'Delayed'
  else 'Ongoing'
  end as signoff_status,
  
  case when actual_live IS NULL then 'Not available'
  when planned_live<=actual_live then 'Completed'
  when planned_live>actual_live then 'Delayed'
  else 'Ongoing'
  end as live_status
  from profile_55424 as p
  
  left join ds_mysql_prod_project projectid
  on p.projectid = projectid.id
  )
 UNPIVOT (
  date_up for type IN (planned_doi, planned_doc, planned_signoff, planned_live))),
  t2 as
  (
	select * from t1
	)
	select * from t2
	
  