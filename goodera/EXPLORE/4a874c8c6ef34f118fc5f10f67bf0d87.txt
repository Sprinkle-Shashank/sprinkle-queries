with t1 as
(
  select projectId, planned_doi, planned_doc, planned_signoff, planned_live, fy_timerange, actual_doi, actual_doc, actual_signoff, actual_live,
  
  case when actual_doi IS NULL then 'Not available'
  when planned_doi<=actual_doi then 'Completed'
  when planned_doi>actual_doi then 'Delayed'
  else 'Ongoing'
  end as doi_status
  from profile_55424 as p
  )
  t2 as
  (
	select * from t1
	
  