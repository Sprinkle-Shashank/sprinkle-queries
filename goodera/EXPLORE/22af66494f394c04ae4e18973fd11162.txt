with table1 as
(
select _id, p1.name as activity_id, district, staff_name, function, date, state  from profile_76872 as p
left join  ds_mysql_prod_project as p1 
on p.projectid  = p1.id),
table2 as 
  (
select activity_id, district, staff_name, function, date, state,count(*) as new_count  from table1
group by updated_id, state, district, staff_name, function, date)

select * from table2

