Select  a.fy_timerange,p.name as projectid,a.school_name,t.name as location,count(distinct(a.school_name)) as count_of_schools,a.teachers_school as number_of_teachers,count(*)
from profile_79427 a

left join ds_mysql_prod_project p on p.id = a.projectid
left join ds_mysql_prod_tagelement t on t.id=a.location

group by a.fy_timerange,p.name,a.school_name,t.name,a.teachers_school