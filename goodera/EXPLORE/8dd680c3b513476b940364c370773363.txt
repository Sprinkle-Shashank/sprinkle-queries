with temp1 as
(select * from
(select m.projectId, m.fy_timerange, m.theory_sessions, m.practical_sessions, m.average_attendance, m.school_name as school from profile_65888 as m

left join profile_65885 as n 
 on m.school_name = n._id
 left join ds_mysql_prod_project as projectId
  on temp1.projectId = projectId.id
 
 
)
UNPIVOT (
  value for dimension IN ( Theory sessions, Practical sessions, Average attendance )),
 temp2 as
 (select projectId, fy_timerange, school_name,Sum(temp1.value) as value, Dimension
  
 group by projectId, fy_timerange, school_name, Dimension)

select * from temp1