with temp1 as
(select * from
(select m.projectId, m.fy_timerange, m.theory_sessions, m.practical_sessions, m.average_attendance, m.school_name from profile_65888 as m

left join profile_65885 as n 
 on m.school_name = n._id
 left join ds_mysql_prod_project as projectId
  on m.projectId = projectId.id
 
 
)
UNPIVOT (
  value for dimension IN ( theory_sessions, practical_sessions, average_attendance ))),
 
 temp2 as
 (select projectId, fy_timerange, school_name as school,Sum(temp1.value) as value, Dimension from temp1
  
 group by projectId, fy_timerange, school, Dimension)

select * from temp2