select p.projectId, m.name as placed, p.fy_timerange, p.batch_id ,h.start, h.end ,k.name as donor, h.donor_commitment, t2.name as project, current_date, case when h.end < current_date then 1 else 0 end as completed, count(*) as count from profile_145 p
 
left join profile_196 h on
p.batch_id=h._id

left join ds_mysql_prod_tagelement m on
p.placed=m.id

left join ds_mysql_prod_tagelement k on
h.donor=k.id


LEFT JOIN ds_mysql_prod_project t on p.projectId=t.id
LEFT JOIN ds_mysql_prod_project t1 on t.parent=t1.id
LEFT JOIN ds_mysql_prod_project t2 on t1.parent=t2.id

where h.donor is not null and p.placed!=3608

group by k.name, donor_commitment, p.fy_timerange, project, placed,p.projectid,m.name,p.batch_id
 