
with 
test0 as(Select p.* ,(gbv_goals)from  profile_76755 p
, p.gbv_goals_arr gbv_goals union all
 select p.*,NULL as gbv_goals from profile_76755 p where gbv_goals_arr IS NULL
),
test1 as(Select p.* ,(impact_wcp)from  profile_76755 p
, p.impact_wcp_arr impact_wcp union all
 select p.*,NULL as impact_wcp from profile_76755 p where impact_wcp_arr IS NULL
),
test2 as(Select p.* ,(grievances_wcp)from  profile_76755 p
, p.grievances_wcp_arr grievances_wcp union all
 select p.*,NULL as grievances_wcp from profile_76755 p where grievances_wcp_arr IS NULL
),
test3 as(Select p.* ,(sdis)from  profile_76755 p
, p.sdis_arr sdis union all
 select p.*,NULL as sdis from profile_76755 p where sdis_arr IS NULL
),
test4 as(Select p.* ,(sst_goals)from  profile_76755 p
, p.sst_goals_arr sst_goals union all
 select p.*,NULL as sst_goals from profile_76755 p where sst_goals_arr IS NULL
),
test5 as(Select p.* ,(stories)from  profile_76755 p
, p.stories_arr stories union all
 select p.*,NULL as stories from profile_76755 p where stories_arr IS NULL
),
test6 as(Select p.* ,(pace_goals)from  profile_76755 p
, p.pace_goals_arr pace_goals union all
 select p.*,NULL as pace_goals from profile_76755 p where pace_goals_arr IS NULL
),
test7 as ( Select p.projectId,p.name,p.facility_name,p.pace,p.sst,p.wcp,p.bc_present,p.facility_name_2,p.strategic_yn, p.stories, p.year_timerange, p.gbv_goals, p.pace_goals, p.sst_goals, p.grievances_wcp, p.impact_wcp, p.country, p.director_region, p.facility_type, p.female_workers, p.male_workers, p.female_managers, p.male_managers, p.female_reps_worker, p.male_reps_workers, p.female_reps_management, p.male_reps_management, p.female_workforce, p.female_management, p.pace_enrolled, p.female_supervisors, p.male_supervisors, p.gbv,ven.name AS vendor,t1.workers_production_unit, t1.male_female, t1.female_representation, t1.decision_making, t1.decision_making_attendance, t1.meeting_held, t1.members_present_meetings, t1.active_members_list, t1.reps_elected, t1.issues_addressed, t1.follow_up, t1.members_duty_released, t1.peers_reachout, t1.assessment_review, t1.retaliation, t1.alternative_trade_union, t1.grievance_handling, t1.remarks, t1.meeting_minutes, t1.recognized_union,t2.certified_trainers, t2.certified_mts, t2.pace_introduced, t3.saturation, t3.num_supervisors,t4.channels_more,t4.anonymous_channel, t4.third_party_channel, t4.response_provided, t4.issues_resolved, t4.indepth_workers, t4.indepth_managers, t4.internal_trainers, t4.indepth_employees, t4.gbv_policy, t5.method, t5.code, t5.bc_meetings, t5.labor_disputes, t5.day_1_workers, t5.production_efficiency, t5.absenteeism_rate, t5.workers_exited, t5.last_day_workers, t5.person_days_lost, t5.sub_unit,t6.repeated, t6.rights_based, t6.interest_based, t6.bc_members, t6.gbv_issues, t7.stry_title, t7.image, t7.stry_details, t7.program, t7.date,p8.facility_vpid

from test6 p


left join   test0 t0 on
p._id=t0._id

left join   test1 t1 on
p._id=t1._id
left join  test2 t2 on
p._id=t2._id
left join  test3 t3 on
p._id=t3._id
left join  test4 t4 on
p._id=t4._id
left join  test5 t5 on
p._id=t5._id
left join   test6 t6 on
p._id=t6._id


left join profile_76770 p8 on 
p.facility_name = p8._id


left join ds_mysql_prod_project fac
on p.projectId = fac.id
left join ds_mysql_prod_project ven
on fac.parent = ven.id

 

) 
Select * from test7 p 

