
with 
test0 as(Select p._id ,(gbv_goals)from  profile_76755 p
, p.gbv_goals_arr gbv_goals union 
 select p._id,NULL as gbv_goals from profile_76755 p where gbv_goals_arr IS NULL
),
test1 as(Select p._id ,(impact_wcp)from  profile_76755 p
, p.impact_wcp_arr impact_wcp union 
 select p._id,NULL as impact_wcp from profile_76755 p where impact_wcp_arr IS NULL
),
test2 as(Select p._id ,(grievances_wcp)from  profile_76755 p
, p.grievances_wcp_arr grievances_wcp union 
 select p._id,NULL as grievances_wcp from profile_76755 p where grievances_wcp_arr IS NULL
),
test3 as(Select p._id ,(pace_goals)from  profile_76755 p
, p.pace_goals_arr pace_goals union
 select p._id,NULL as pace_goals from profile_76755 p where pace_goals_arr IS NULL
),
test4 as(Select p._id ,(sst_goals)from  profile_76755 p
, p.sst_goals_arr sst_goals union 
 select p._id,NULL as sst_goals from profile_76755 p where sst_goals_arr IS NULL
),
test5 as(Select p._id ,(sdis)from  profile_76755 p
, p.sdis_arr sdis union 
 select p._id,NULL as sdis from profile_76755 p where sdis_arr IS NULL
),
test6 as(Select p._id ,(stories)from  profile_76755 p
, p.stories_arr stories union 
 select p._id,NULL as stories from profile_76755 p where stories_arr IS NULL
),
test7 as(Select p.*,p0.gbv_goals,p1.impact_wcp,p2.grievances_wcp,p3.pace_goals,p4.sst_goals,p5.sdis,p6.stories
from profile_76755 p
		 
left join test0 p0 on
p0._id = p._id
		 
left join test1 p1 on
p1._id = p._id
		 
left join test2 p2 on
p2._id = p._id
		 
left join test3 p3 on
p3._id = p._id
		 
left join test4 p4 on
p4._id = p._id
		 		 
left join test5 p5 on
p5._id = p._id
		 
left join test6 p6 on
p6._id = p._id
		 
left join ds_mysql_prod_project fac
on p.projectId = fac.id
left join ds_mysql_prod_project ven
on fac.parent = ven.id

),

test8 as(Select p7.channels_more,p7.anonymous_channel, p7.third_party_channel, p7.response_provided,p7.issues_resolved, p7.indepth_workers, p7.indepth_managers, p7.internal_trainers, p7.indepth_employees, p7.gbv_policy, p8.method, p8.code, p8.bc_meetings, p8.labor_disputes, p8.day_1_workers, p8.production_efficiency, p8.absenteeism_rate, p8.workers_exited, p8.last_day_workers, p8.person_days_lost, p8.sub_unit,p9.facility_vpid,p10.workers_production_unit, p10.male_female, p10.female_representation, p10.decision_making, p10.decision_making_attendance, p10.meeting_held, p10.members_present_meetings, p10.active_members_list, p10.reps_elected, p10.issues_addressed, p10.follow_up, p10.members_duty_released, p10.peers_reachout, p10.assessment_review, p10.retaliation, p10.alternative_trade_union, p10.grievance_handling, p10.remarks, p10.meeting_minutes,p10.recognized_union,p11.certified_trainers, p11.certified_mts, p11.pace_introduced,p12.saturation, p12.num_supervisors,p13.repeated, p13.rights_based, p13.interest_based, p13.bc_members, p13.gbv_issues,p14.stry_title, p14.image, p14.stry_details, p14.program, p14.date, p.*  from profile_76928 p8,profile_66923 p10,profile_76895 p11,profile_76896 p12,profile_76927 p13,profile_77700 p14, profile_76755 p
		 
	 

left join profile_76770 p9 on 
p.facility_name = p9._id
		 
left join profile_76894 p7 on 
p.gbv_goals = p7._id

)
Select DISTINCT * from test8
	 

 /*
test2 as(Select p.* ,(grievances_wcp)from  profile_76755 p
, p.grievances_wcp_arr grievances_wcp union all
 select p.*,NULL as grievances_wcp from profile_76755 p where grievances_wcp_arr IS NULL
),
test3 as(Select p.* ,(sdis)from  profile_76755 p
, p.sdis_arr sdis union all
 select p.*,NULL as sdis from profile_76755 p where sdis_arr IS NULL
),
test4 as(Select p.* ,(sst_goals)from  profile_76755 p
, p.sst_goals_arr sst_goals union all
 select p.*,NULL as sst_goals from profile_76755 p where sst_goals_arr IS NULL
),
test5 as(Select p.* ,(stories)from  profile_76755 p
, p.stories_arr stories union all
 select p.*,NULL as stories from profile_76755 p where stories_arr IS NULL
),
test6 as(Select p.* ,(pace_goals)from  profile_76755 p
, p.pace_goals_arr pace_goals union all
 select p.*,NULL as pace_goals from profile_76755 p where pace_goals_arr IS NULL
),
test7 as ( Select p.gbv_goals,p.projectId,p.name,p.facility_name,p.pace,p.sst,p.wcp,p.bc_present,p.facility_name_2,p.strategic_yn,  p.year_timerange,  p.country, p.director_region, p.facility_type, p.female_workers, p.male_workers, p.female_managers, p.male_managers, p.female_reps_worker, p.male_reps_workers, p.female_reps_management, p.male_reps_management, p.female_workforce, p.female_management, p.pace_enrolled, p.female_supervisors, p.male_supervisors, p.gbv,ven.name AS vendor,p1.workers_production_unit, p1.male_female, p1.female_representation, p1.decision_making, p1.decision_making_attendance, p1.meeting_held, p1.members_present_meetings, p1.active_members_list, p1.reps_elected, p1.issues_addressed, p1.follow_up, p1.members_duty_released, p1.peers_reachout, p1.assessment_review, p1.retaliation, p1.alternative_trade_union, p1.grievance_handling, p1.remarks, p1.meeting_minutes,p1.recognized_union,p2.certified_trainers, p2.certified_mts, p2.pace_introduced, p3.saturation, p3.num_supervisors,p4.channels_more,p4.anonymous_channel, p4.third_party_channel, p4.response_provided, p4.issues_resolved, p4.indepth_workers, p4.indepth_managers, p4.internal_trainers, t4.indepth_employees, p4.gbv_policy, p5.method, p5.code, p5.bc_meetings, p5.labor_disputes, p5.day_1_workers, p5.production_efficiency, p5.absenteeism_rate, p5.workers_exited, p5.last_day_workers, p5.person_days_lost, p5.sub_unit,p6.repeated, p6.rights_based, p6.interest_based, p6.bc_members, p6.gbv_issues, p7.stry_title, p7.image, p7.stry_details, p7.program, p7.date,p8.facility_vpid

from test p

left join profile_76894 p4 on 
p.gbv_goals = p4._id
		  
left join profile_66923 p1 on
p.sdis = p1._id

left join profile_76895 p2 on 
p.pace_goals = p2._id

left join profile_76896 p3 on 
p.sst_goals = p3._id

left join profile_76894 p4 on 
test0.gbv_goals = p4._id

left join profile_76928 p5 on 
p.impact_wcp = p5._id


left join profile_76927 p6 on 
p.grievances_wcp = p6._id

left join profile_77700 p7 on 
p.stories = p7._id
114
left join profile_77700 p7 on 

left join profile_76770 p8 on 
p.facility_name = p8._id


left join ds_mysql_prod_project fac
on p.projectId = fac.id
left join ds_mysql_prod_project ven
on fac.parent = ven.id

 

) 
Select p.* from test7 p 
*/
