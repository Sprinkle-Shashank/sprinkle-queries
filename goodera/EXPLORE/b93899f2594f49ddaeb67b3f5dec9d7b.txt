

with t1 as
(SELECT * 
FROM
(Select  projectId, fy_timerange, school_name, percent_baseline_score, percent_endline_score, student_class from profile_65291

)
UNPIVOT (
    val FOR dim IN (percent_baseline_score, percent_endline_score))

)

select projectId, fy_timerange, school_name, student_class, avg(val) as val,dim  from t1 as p

Group By projectId, fy_timerange, school_name, student_class, dim
  


