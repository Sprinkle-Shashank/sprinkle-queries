with temp as(
Select 'Cubic Metres' as col
  union all
Select 'Litres' as col
),

t2 as (
Select 'watertype1' as col
  union all
  Select 'watertype2' as col
  union all
  Select 'watertype3' as col
  union all
  Select 'watertype4' as col
  union all
  Select 'watertype5' as col
),
s1 as (
Select t.name as site, t1.name as sub_region,t2.name as region,
sum(datanum) /100 as normalization_factor,
fy_timerange,max(case col
 when 'Cubic Metres' then 'Cubic Metres'
 when 'Litres' then 'Litres'
 else null
 end )as unit

from sus_56999
cross join temp
left join ds_mysql_prod_project t
on xprojectid=t.id
left join ds_mysql_prod_project t1
on t.parent=t1.id
left join ds_mysql_prod_project t2
on t2.parent=t2.id
where keyword = 'total_campus_hours_worked' and xprojectid != '47608'
group by t.name,t1.name,t2.name,fy_timerange
),
s2 as (Select s1.*,
 case
 		when 'watertype1' then 'Ground Water'
		when 'watertype2' then 'Utility Provided'
		when 'watertype3' then 'Surface Water'
		when 'watertype4' then 'NewWater Offsite_Recycled'
		when 'watertype5' then 'Total Water Withdrawal'
		end as Water_Type,t2.col as Watertypes
		
from s1
cross join t2

)
Select * from s2