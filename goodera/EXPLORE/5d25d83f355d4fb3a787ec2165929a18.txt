

Select p2.name as projectId, t1.name as financialPeriod, fy_timerange , 


sum(case datanumbase
   when 'gri_discharge_suspended_solids' then p1.gri_discharge_suspended_solids
   when 'gri_discharge_untreated_effluent' then p1.gri_discharge_untreated_effluent
   when 'gri_discharge_wastewater' then p1.gri_discharge_wastewater 
   when 'gri_discharge_ammonianitrogen' then p1.gri_discharge_ammonianitrogen
   when 'gri_discharge_treated_effluent' then p1.gri_discharge_treated_effluent
   else null
   end) as Discharge
   
  
from sus_56551 as p1 
left join
ds_mysql_prod_project as p2 on p2.id=p1.xprojectid
left join
ds_mysql_prod_tagelement t1 on t1.id = financialperiod where keyword in('gri_discharge_treated_effluent', 'gri_discharge_suspended_solids', 'gri_discharge_untreated_effluent', 'gri_discharge_wastewater', 'gri_discharge_ammonianitrogen')

/*select * from sus_56551 where keyword in('gri_discharge_treated_effluent', 'gri_discharge_suspended_solids', 'gri_discharge_untreated_effluent', 'gri_discharge_wastewater', 'gri_discharge_ammonianitrogen') */