select cast(concat('FY ' ,start_year) as varchar) as start_year, 
extract(month from start_date) as month_new , case when month_new=2 or month_new=3 or month_new=4 then '1st (Feb-Apr)'
 when month_new=5 or month_new=6 or month_new=7 then '2nd (May-Jul)'
  when month_new=8 or month_new=9 or month_new=10 then '3rd (Aug-Oct)'
   when month_new=11 or month_new=12 or month_new=1 then '4th (Nov-Jan)'
   else null end as start_quarter
   ,
   cou.name as country , avg(efficiency - efficiency_1) as value from profile_4227 as pr_27

left join ds_mysql_prod_project fac 
on pr_27.projectId = fac.id

 left join ds_mysql_prod_project ven 
on fac.parent = ven.id

 left join ds_mysql_prod_project cou 
on ven.parent = cou.id

where efficiency_1 is not null and efficiency is not null

group by cou.name , financial_year , month_new , quarter

order by value desc

/*

 left join profile cou 
on ven.parent = cou.id
*/
