with sub1 as(
  select p1.*, annual_reports_ngo_new, audited_financials_new, itr_filed_new,
  
  case
  		when IS_ARRAY(p1.annual_reports_ngo) = FALSE or GET_ARRAY_LENGTH(p1.annual_reports_ngo) = 0 				then ARRAY(p1.annual_reports_ngo)
  		else p1.annual_reports_ngo
  end as annual_reports_ngo_new,
  
  case
  		when IS_ARRAY(p1.audited_financials) = FALSE or GET_ARRAY_LENGTH(p1.audited_financials) = 0 				then ARRAY(p1.audited_financials)
  		else p1.audited_financials
  end as audited_financials_new,
  
  case
  		when IS_ARRAY(p1.itr_filed) = FALSE or GET_ARRAY_LENGTH(p1.itr_filed) = 0 				
  				then ARRAY(p1.itr_filed)
  		else p1.itr_filed
  end as itr_filed_new
  
  from profile_41361 p1)
  
select s1.*, annual_reports_ngo_unwind, audited_financials_unwind, itr_filed_unwind
from sub1 s1, s1.annual_reports_ngo_new annual_reports_ngo_unwind, s1.audited_financials_new audited_financials_unwind, s1.itr_filed_new itr_filed_unwind