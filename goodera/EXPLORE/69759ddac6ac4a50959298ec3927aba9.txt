with table1 as(Select p.projectId,
CAST(time_period_timerange.start as date) as time_period,DATEPART(Month,time_period) as month_value,
Substring(time_period,1,4) as year_axis,
x2.name as ship_city,x21.name as region,x22.name as region_global,x23.name as region_global_parent,
x5.name as sales_org,
p.shlf_life_buckt,p.shelf_life,p.doses_delivered,sum(total_cost) as donation_value,'VALUE' AS value_column,'Yearly' as time_period_level from profile_56340 p


Left join ds_mysql_prod_tagelement x2
on p.ship_city = x2.id

Left join ds_mysql_prod_tagelement x21
on x2.parent = x21.id

Left join ds_mysql_prod_tagelement x22
on x21.parent = x22.id

Left join ds_mysql_prod_tagelement x23
on x22.parent = x23.id

Left join ds_mysql_prod_tagelement x5
on p.sales_org = x5.id

group by p.projectId,
time_period_timerange.start,x2.name,x21.name,x22.name, x23.name,
x5.name,p.shlf_life_buckt,p.shelf_life,p.doses_delivered

order by donation_value desc)
select * from table1
/*
table2 as(Select p.projectId,
CAST(time_period_timerange.start as date) as time_period,DATEPART(time_period,month) as month_value,case when month_value = 1 then 'Jan'
		    case when month_value = 2 then 'Feb'
		    case when month_value = 3 then 'Mar'
		    case when month_value = 4 then 'Apr'
		    case when month_value = 5 then 'May'
		    case when month_value = 6 then 'Jun'
		    case when month_value = 7 then 'Jul'
		    case when month_value = 8 then 'Aug'
		    case when month_value = 9 then 'Sep'
		    case when month_value = 10 then 'Oct'
		    case when month_value = 11 then 'Nov'
		    case when month_value = 12 then 'Dec'
Substring(time_period,1,4) as year_axis,
x2.name as ship_city,x21.name as region,x22.name as region_global,x23.name as region_global_parent,
x5.name as sales_org,
p.shlf_life_buckt,p.shelf_life,p.doses_delivered,sum(total_cost) as donation_value,'VALUE' AS value_column,'Yearly' as time_period_level from profile_56340 p


Left join ds_mysql_prod_tagelement x2
on p.ship_city = x2.id

Left join ds_mysql_prod_tagelement x21
on x2.parent = x21.id

Left join ds_mysql_prod_tagelement x22
on x21.parent = x22.id

Left join ds_mysql_prod_tagelement x23
on x22.parent = x23.id

Left join ds_mysql_prod_tagelement x5
on p.sales_org = x5.id

group by p.projectId,
time_period_timerange.start,x2.name,x21.name,x22.name, x23.name,
x5.name,p.shlf_life_buckt,p.shelf_life,p.doses_delivered

order by donation_value desc*/