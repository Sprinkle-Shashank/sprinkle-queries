with test1 as(
select p.fy_timerange.start as fy_timerange, p.projectid, 'Allied' as f_category, (vision_allied + vision_partner) as total_sum from profile_63885 p
  
union all
  
select p.fy_timerange.start as fy_timerange, p.projectid, 'Trucker' as f_category, vision_truckers as total_sum from profile_63885 p
),

test2 as(
select concat(p.f_reg_date,'T00:00:00.000Z') as fy_timerange, p.projectid, p.f_category, decode(p.vision,1012444,0,null,0,1) as total_sum from profile_59462 p
),

test3 as(
select p.fy_timerange, p.projectid, p.f_category, sum(total_sum) from test1 p group by 1,2,3

union all
  
select p.fy_timerange, p.projectid, p.f_category, sum(total_sum) from test2 p group by 1,2,3
)  

select * from test3