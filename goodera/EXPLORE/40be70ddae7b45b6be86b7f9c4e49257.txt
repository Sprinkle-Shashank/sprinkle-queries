SELECT SA.fy_timerange, SA.marks_obtained, SA.marks_max,
T2.name AS subject,
T1.name AS type,
COUNT(SE.name) AS students,
((SA.marks_obtained * 100) / (SA.marks_max)) AS score,

	CASE
		WHEN score >= 60
		THEN true
		ELSE false
	END AS a

FROM profile_79041 AS SA

LEFT JOIN ds_mysql_prod_tagelement AS T1
ON T1.id = SA.type

LEFT JOIN ds_mysql_prod_tagelement AS T2
ON T2.id = SA.subject

LEFT JOIN profile_79039 AS SE
ON SE._id = SA.student

GROUP BY SA.fy_timerange, SA.marks_obtained, SA.marks_max, T2.name, T1.name, students, score