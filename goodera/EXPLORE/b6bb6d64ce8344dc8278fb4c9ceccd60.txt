
with table1 as(select _id, projectId, state, projects from profile_51028),

table2 as (select t1.*,stat from table1 t1 , t1.state as stat)

select _id,  projectId,  projects, LISTAGG(distinct cast(stat as varchar),',') as stat   from table2
where projects in(794579)
group by  _id,  projectId,  projects