select p2.name as sub_location, count(*) as beneficiaries,
case 
  	when (p.date_yn is not null and p.date_yn = 28005 ) then p.date_n
  	else p.createddate
  	end as date

from profile_58511 p1
left join profile_49219 p2 on p2._id=p1.location

--where sub_location is not null
group by p2.name,