select fac.name as location, count(*), fac2.name as sub_location

from profile_51990 p

left join ds_mysql_prod_project fac
on p.projectid = fac.id
left join ds_mysql_prod_project fac2
on fac.parent = fac2.id
group by location,sub_location