drop table if exists profile_29974;

create table if not exists profile_29974 with (format='ORC') as
select projectid,_id,
case when cast(json_extract((a.data),'$.hdfc_cost_monthly') as varchar) ='null' then 0 else cast(json_extract((a.data),'$.hdfc_cost_monthly') as double) end as hdfc_cost_monthly,

cast(json_extract(json_parse(a.data),'$.prj_code') as varchar) as prj_code,
cast(json_extract(json_parse(a.data),'$.fy') as varchar) as fy

from profileinstance_optimized a  where a.profileId= '29974' and a.active = 'true'