drop table if exists profile_27414;

create table if not exists profile_27414 with (format='ORC') as
select projectid,_id,
cast(json_extract(json_parse(a.data),'$.oc_indic_new') as varchar) as oc_indic_new,
cast(json_extract(json_parse(a.data),'$.fy') as varchar) as fy,
cast(json_extract(json_parse(a.data),'$.planned_s1') as varchar) as planned_s1,
cast(json_extract(json_parse(a.data),'$.planned_s2') as varchar) as planned_s2,
cast(json_extract(json_parse(a.data),'$.progress_s1') as varchar) as progress_s1,
cast(json_extract(json_parse(a.data),'$.progress_s2') as varchar) as progress_s2,
cast(json_extract(json_parse(a.data),'$.prj_code') as varchar) as prj_code

from profileinstance_optimized a  where a.profileId= '27414' and a.active = 'true'