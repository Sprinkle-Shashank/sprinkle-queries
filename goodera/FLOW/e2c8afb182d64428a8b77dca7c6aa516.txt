drop table if exists profile_76755;
 create table profile_76755 as
 with profile as (
   SELECT projectid, _id,
 CAST(data.year_timerange as SUPER),
 CAST(data.facility_name as VARCHAR),
 CAST(data.female_workers as INT),
 CAST(data.male_workers as INT),
 CAST(data.female_supervisors as INT),
 CAST(data.male_supervisors as INT),
 CAST(data.female_managers as INT),
 CAST(data.male_managers as INT),
 CAST(data.female_workforce as INT),
 CAST(data.female_management as INT),
 CAST(data.bc_present as INT),
 CAST(data.female_reps_worker as INT),
 CAST(data.male_reps_workers as INT),
 CAST(data.female_reps_management as INT),
 CAST(data.male_reps_management as INT),
 --CAST(data.sdis as VARCHAR),
 data.sdis as sdis_arr, 
 CAST(data.pace_enrolled as INT),
 data.pace_goals as pace_goals_arr,
 --CAST(data.sst_goals as VARCHAR),
 --CAST(data.gbv_goals as VARCHAR),
  data.sst_goals as sst_goals_arr,  
 data.gbv_goals as gbv_goals_arr,  
 --CAST(data.impact_wcp as VARCHAR),
 --CAST(data.grievances_wcp as VARCHAR),
 data.impact_wcp as impact_wcp_arr,  
 data.grievances_wcp as grievances_wcp_arr, 
 CAST(data.stories as VARCHAR),
 CAST(data.name as VARCHAR),
 CAST(data.pace as VARCHAR),
 CAST(data.sst as VARCHAR),
 CAST(data.gbv as VARCHAR),
 CAST(data.wcp as VARCHAR),
 CAST(data.facility_name_2 as VARCHAR),
 CAST(data.strategic_yn as VARCHAR),
 CAST(data.country as VARCHAR),
 CAST(data.director_region as VARCHAR),
 CAST(data.facility_type as VARCHAR)
from ds_mongo_profileinstance
where profileId='76755' and active = 't' 
   ) 
select  p.*, CAST(pace_goals as VARCHAR),CAST(gbv_goals as VARCHAR),CAST(sdis as VARCHAR),CAST(sst_goals as VARCHAR),CAST(impact_wcp as VARCHAR),CAST(grievances_wcp as VARCHAR) from profile p, p.pace_goals_arr pace_goals, p.gbv_goals_arr gbv_goals,p.sdis_arr sdis,p.sst_goals_arr sst_goals,p.impact_wcp_arr impact_wcp,p.grievances_wcp_arr grievances_wcp