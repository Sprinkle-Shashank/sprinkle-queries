drop table if exists profile_63887;

create table if not exists profile_63887 with (format='ORC') as 
select projectid,
substring(cast(json_extract((a.data),'$.fy_timerange.start') as varchar),1,10) as fy_timerange,
case when cast(json_extract((a.data),'$.tb_pres_screen_s_truckers') as varchar) ='null' then 0 else cast(json_extract((a.data),'$.tb_pres_screen_s_truckers') as bigint) end as tb_pres_screen_s_truckers,
case when cast(json_extract((a.data),'$.tb_pres_screen_x_truckers') as varchar)='null' then 0 else cast(json_extract((a.data),'$.tb_pres_screen_x_truckers') as bigint) end as tb_pres_screen_x_truckers,
case when cast(json_extract((a.data),'$.tb_pres_screen_both_truckers') as varchar)='null' then 0 else cast(json_extract((a.data),'$.tb_pres_screen_both_truckers') as bigint) end as tb_pres_screen_both_truckers,
case when cast(json_extract((a.data),'$.tb_pres_screen_s_allied') as varchar) ='null' then 0 else cast(json_extract((a.data),'$.tb_pres_screen_s_allied') as bigint) end as tb_pres_screen_s_allied,
case when cast(json_extract((a.data),'$.tb_pres_screen_x_allied') as varchar)='null' then 0 else cast(json_extract((a.data),'$.tb_pres_screen_x_allied') as bigint) end as tb_pres_screen_x_allied,
case when cast(json_extract((a.data),'$.tb_pres_screen_both_allied') as varchar)='null' then 0 else cast(json_extract((a.data),'$.tb_pres_screen_both_allied') as bigint) end as tb_pres_screen_both_allied
case when cast(json_extract((a.data),'$.hypertension_truckers') as varchar)='null' then 0 else cast(json_extract((a.data),'$.hypertension_truckers') as bigint) end as hypertension_truckers
case when cast(json_extract((a.data),'$.hypertension_allied') as varchar)='null' then 0 else cast(json_extract((a.data),'$.hypertension_allied') as bigint) end as hypertension_allied
case when cast(json_extract((a.data),'$.at_risk_hypertension_truckers') as varchar)='null' then 0 else cast(json_extract((a.data),'$.at_risk_hypertension_truckers') as bigint) end as at_risk_hypertension_truckers
case when cast(json_extract((a.data),'$.at_risk_hypertension_allied') as varchar)='null' then 0 else cast(json_extract((a.data),'$.at_risk_hypertension_allied') as bigint) end as at_risk_hypertension_allied

from profileinstance_optimized a  where a.profileId= '63887'