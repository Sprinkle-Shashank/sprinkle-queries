drop table if exists profile_54963;

create table if not exists profile_54963 with (format='ORC') as
select projectid,_id,
cast(json_extract(json_parse(a.data),'$.fy') as varchar) as fy,
cast(json_extract(json_parse(a.data),'$.subcat_output') as double) as subcat_output,
cast(json_extract(json_parse(a.data),'$.deviation_check') as varchar) as deviation_check,
cast(json_extract(json_parse(a.data),'$.focus_area') as varchar) as focus_area,
cast(json_extract(json_parse(a.data),'$.month') as varchar) as month,
cast(json_extract(json_parse(a.data),'$.flag_deviation_delay') as varchar) as flag_deviation_delay,
cast(json_extract(json_parse(a.data),'$.sub_cat_out_plan') as double) as sub_cat_out_plan,
cast(json_extract(json_parse(a.data),'$.subcat') as varchar) as subcat,
cast(json_extract(json_parse(a.data),'$.act_cat') as varchar) as act_cat


from profileinstance_optimized a  where a.profileId= '54963' and a.active = 'true'