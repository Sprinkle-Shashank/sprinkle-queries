 SELECT projectid, _id,fy_timerange,category_of_waste,other_waste,waste_generated,waste_recovered_disposed,recovery_operation,recovery_onsite_offsite,disposal_operation,disposal_onsite_offsite,additional_cost,revenue,category_of_waste_text,
 t.name as category_of_waste ,nvl(tt2.name,tt1.name) as haz_nonhaz,
 case 
	when tt2.name is null then t.name
	else tt1.name
	end as waste_type2
from profile_79216
left join ds_mysql_prod_tagelement t
on t.id=category_of_waste
left join ds_mysql_prod_tagelement tt1
on tt1.id=t.parent
left join ds_mysql_prod_tagelement tt2
on tt2.id=tt1.parent
