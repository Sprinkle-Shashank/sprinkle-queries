drop table if exists sus_56999;
create table sus_56999 as
with temp as (select 
	st.xprojectid,
	p.name,
	st.financialperiod,
	t.name,
	cast(timestamp 'epoch' + CAST(t.start AS BIGINT)/1000 * interval '1 second' as varchar) as startdate,
	timestamp 'epoch' + CAST(t.end AS BIGINT)/1000 * interval '1 second' as enddate,
	st.xquestionid,
	q.questiontype,
	q.keyword,
	CAST(q.questiontext as varchar) as kitty_122_hjj,
			  st.datanum,
case when q.keyword='corporate_hours_worked' then st.datanum END as corporate_hours_worked,
case when q.keyword='near_miss_hazard_identification' then st.datanum END as near_miss_hazard_identification,
case when q.keyword='biomedical_disposal' then st.datanum END as biomedical_disposal,
case when q.keyword='hazwaste_landfill' then st.datanum END as hazwaste_landfill,
case when q.keyword='water_usage_utility_provider' then st.datanum END as water_usage_utility_provider,
case when q.keyword='electricity_usage' then st.datanum END as electricity_usage,
case when q.keyword='government_inspections' then st.datanum END as government_inspections,
case when q.keyword='paper' then st.datanum END as paper,
case when q.keyword='nonhaz_landfill' then st.datanum END as nonhaz_landfill,
case when q.keyword='nonhaz_reg_landfill' then st.datanum END as nonhaz_reg_landfill,
case when q.keyword='first_aid_nurse' then st.datanum END as first_aid_nurse,
case when q.keyword='water_usage_new_water_reclaimed' then st.datanum END as water_usage_new_water_reclaimed,
case when q.keyword='hazwaste_treatment' then st.datanum END as hazwaste_treatment,
case when q.keyword='government_violations' then st.datanum END as government_violations,
case when q.keyword='biomedical_cost' then st.datanum END as biomedical_cost,
case when q.keyword='cardoard' then st.datanum END as cardoard,
case when q.keyword='nonhaz_incinerated' then st.datanum END as nonhaz_incinerated,
case when q.keyword='electricity_cost' then st.datanum END as electricity_cost,
case when q.keyword='nonhaz_reg_treatment' then st.datanum END as nonhaz_reg_treatment,
case when q.keyword='recordable_injuries' then st.datanum END as recordable_injuries,
case when q.keyword='hazwaste_incinerated' then st.datanum END as hazwaste_incinerated,
case when q.keyword='water_usage_reclaimed_storm' then st.datanum END as water_usage_reclaimed_storm,
case when q.keyword='ehs_outreach_events' then st.datanum END as ehs_outreach_events,
case when q.keyword='pallets' then st.datanum END as pallets,
case when q.keyword='nonhaz_other' then st.datanum END as nonhaz_other,
case when q.keyword='natural_gas_usage' then st.datanum END as natural_gas_usage,
case when q.keyword='nonhaz_reg_waste' then st.datanum END as nonhaz_reg_waste,
case when q.keyword='lost_time_injuries' then st.datanum END as lost_time_injuries,
case when q.keyword='hazwaste_fuels' then st.datanum END as hazwaste_fuels,
case when q.keyword='water_usage_well_water' then st.datanum END as water_usage_well_water,
case when q.keyword='ehs_community_awards' then st.datanum END as ehs_community_awards,
case when q.keyword='total_nonhaz' then st.datanum END as total_nonhaz,
case when q.keyword='natural_gas_cost' then st.datanum END as natural_gas_cost,
case when q.keyword='cafe_grease' then st.datanum END as cafe_grease,
case when q.keyword='nonhaz_reg_fuels' then st.datanum END as nonhaz_reg_fuels,
case when q.keyword='hours_worked_employees' then st.datanum END as hours_worked_employees,
case when q.keyword='hazwaste_other' then st.datanum END as hazwaste_other,
case when q.keyword='ehs_spills_fires_incidents' then st.datanum END as ehs_spills_fires_incidents,
case when q.keyword='nonhaz_cost' then st.datanum END as nonhaz_cost,
case when q.keyword='propane_usage' then st.datanum END as propane_usage,
case when q.keyword='water_usage_onsite_recycled' then st.datanum END as water_usage_onsite_recycled,
case when q.keyword='plastic' then st.datanum END as plastic,
case when q.keyword='nonhaz_reg_other' then st.datanum END as nonhaz_reg_other,
case when q.keyword='hours_worked_temp' then st.datanum END as hours_worked_temp,
case when q.keyword='total_hazwaste' then st.datanum END as total_hazwaste,
case when q.keyword='total_water_usage' then st.datanum END as total_water_usage,
case when q.keyword='diesel_fuel_usage' then st.datanum END as diesel_fuel_usage,
case when q.keyword='metals' then st.datanum END as metals,
case when q.keyword='nonhaz_reg_total' then st.datanum END as nonhaz_reg_total,
case when q.keyword='total_hours_worked' then st.datanum END as total_hours_worked,
case when q.keyword='total_hazwaste_cost' then st.datanum END as total_hazwaste_cost,
case when q.keyword='water_cost' then st.datanum END as water_cost,
case when q.keyword='diesel_fuel_cost' then st.datanum END as diesel_fuel_cost,
case when q.keyword='electronics' then st.datanum END as electronics,
case when q.keyword='nonhaz_reg_cost' then st.datanum END as nonhaz_reg_cost,
case when q.keyword='total_campus_hours_worked' then st.datanum END as total_campus_hours_worked,
case when q.keyword='gasoline_usage' then st.datanum END as gasoline_usage,
case when q.keyword='incinerated_for_fuel' then st.datanum END as incinerated_for_fuel,
case when q.keyword='recordable_injury_rate' then st.datanum END as recordable_injury_rate,
case when q.keyword='propane_cost' then st.datanum END as propane_cost,
case when q.keyword='landscape_organic_waste' then st.datanum END as landscape_organic_waste,
case when q.keyword='lost_time_injury_rate' then st.datanum END as lost_time_injury_rate,
case when q.keyword='gasoline_cost' then st.datanum END as gasoline_cost,
case when q.keyword='recycled_other' then st.datanum END as recycled_other,
case when q.keyword='electricity_solar' then st.datanum END as electricity_solar,
case when q.keyword='total_nonhaz_recycled' then st.datanum END as total_nonhaz_recycled,
case when q.keyword='nonhaz_recycle_cost' then st.datanum END as nonhaz_recycle_cost,
st.measureunit
from ds_mongo_prod_sustainabilityTask st
left join ds_mysql_prod_question q on st.xquestionid = q.id
left join ds_mysql_prod_project p on st.xprojectid = p.id
left join ds_mysql_prod_tagelement t on st.financialperiod = t.id
where xprofileId= '56999'
and status = 'APPROVED')

select * from temp