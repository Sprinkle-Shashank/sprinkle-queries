drop table if exists profile_27396;

create table if not exists profile_27396 with (format='ORC') as
select projectid,_id,
cast(json_extract(json_parse(a.data),'$.ngo_partner') as varchar) as ngo_partner,
cast(json_extract(json_parse(a.data),'$.fy') as varchar) as fy,
cast(json_extract(json_parse(a.data),'$.project_manager') as varchar) as project_manager,
cast(json_extract(json_parse(a.data),'$.project_duration') as varchar) as project_duration,
cast(json_extract(json_parse(a.data),'$.focus_area') as varchar) as focus_area,
cast(json_extract(json_parse(a.data),'$.name') as varchar) as name,
cast(json_extract(json_parse(a.data),'$.state[0]') as varchar) as state,
cast(json_extract(json_parse(a.data),'$.intervention_type') as varchar) as intervention_type

from profileinstance_optimized a  where a.profileId= '27396' and a.active = 'true'