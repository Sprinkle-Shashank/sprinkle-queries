drop table if exists sus_80610;
 create table sus_80610 as
				select st.xprojectid, p.name, st.financialperiod, t.name as finPeriod,
				concat(concat(substring(cast(timestamp 'epoch' + CAST(t.start AS BIGINT)/1000 * interval '1 second' as varchar), 1, 10),'T'), concat(split_part(cast(timestamp 'epoch' + CAST(t.start AS BIGINT)/1000 * interval '1 second' as varchar), ' ',2),'.000Z')) as startdate,
				concat(concat(substring(cast(timestamp 'epoch' + CAST(t.end AS BIGINT)/1000 * interval '1 second' as varchar), 1, 10),'T'), concat(split_part(cast(timestamp 'epoch' + CAST(t.end AS BIGINT)/1000 * interval '1 second' as varchar), ' ',2),'.000Z')) as enddate,
				concat(concat(startdate,'|'),enddate) as fy_timerange,
				-- concat(concat(t.start,'|'),t.end) as fy_timerange,
				st.xquestionid,
				q.questiontype,
				q.keyword,
				q.questiontext,
				cast(st.datanum as float),
				cast(st.dataNumBase as float),
				st.datatext,
				st.datatagref as dataselect,
				st.datatable,
				st.dataTableBase,
				st.measureunit,
				st.measureunitBase,
				st.tableSettings
				from ds_mongo_sustainabilityTask st
				left join ds_mysql_prod_question q on st.xquestionid = q.id
				left join ds_mysql_prod_project p on st.xprojectid = p.id
				left join ds_mysql_prod_tagelement t on st.financialperiod = t.id
				where xprofileId='80610' and status = 'APPROVED' and st.active='t'
				and keyword in ('name','fy_timerange','emission_source','litre_to_kg','kg_to_gg','calorific_value','emission_factor')
				
				/*
drop table if exists profile_80610;
 create table profile_80610 as
 SELECT projectid, _id,
 CAST(data.name as VARCHAR),
 CAST(data.fy_timerange as SUPER),
 CAST(data.emission_source as INT),
 CAST(data.litre_to_kg as FLOAT),
 CAST(data.kg_to_gg as FLOAT),
 CAST(data.calorific_value as FLOAT),
 CAST(data.emission_factor as FLOAT)
from ds_mongo_profileinstance where profileId='80610' and active = 't' and securitycontextid is not null */